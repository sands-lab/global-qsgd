Run training...
train.py:37: UserWarning: APEX AMP is unavailable
  warnings.warn('APEX AMP is unavailable')
train.py:37: UserWarning: APEX AMP is unavailable
  warnings.warn('APEX AMP is unavailable')
train.py:37: UserWarning: APEX AMP is unavailable
  warnings.warn('APEX AMP is unavailable')
train.py:37: UserWarning: APEX AMP is unavailable
  warnings.warn('APEX AMP is unavailable')
0: thread affinity: {0, 4, 8, 12, 16, 20, 24, 28, 32, 36, 40, 44, 48, 52, 56, 60, 64, 68, 72, 76, 80, 84, 88, 92, 96, 100, 104, 108, 112, 116, 120, 124}
1: thread affinity: {1, 5, 9, 13, 17, 21, 25, 29, 33, 37, 41, 45, 49, 53, 57, 61, 65, 69, 73, 77, 81, 85, 89, 93, 97, 101, 105, 109, 113, 117, 121, 125}
3: thread affinity: {3, 7, 11, 15, 19, 23, 27, 31, 35, 39, 43, 47, 51, 55, 59, 63, 67, 71, 75, 79, 83, 87, 91, 95, 99, 103, 107, 111, 115, 119, 123, 127}
2: thread affinity: {2, 6, 10, 14, 18, 22, 26, 30, 34, 38, 42, 46, 50, 54, 58, 62, 66, 70, 74, 78, 82, 86, 90, 94, 98, 102, 106, 110, 114, 118, 122, 126}
Experiment dir : TF32/DP32_666
Namespace(adaptive=True, adjust_freq=1000, affinity='socket_unique_interleaved', amp='apex', apex_amp_opt_level='O2', append_dataset=False, append_time=False, attn_type=0, batch_chunk=2, batch_size=256, clamp_len=-1, clip=0.25, clip_nonemb=False, cuda=True, d_embed=512, d_head=64, d_inner=2048, d_model=512, data='./wikitext-103/', dataset='wt103', debug=False, decay_rate=0.5, div_val=1, dllog_file='train_log.json', dropatt=0.0, dropout=0.1, emb_init='normal', emb_init_range=0.01, eta_min=0.001, eval_batch_size=16, eval_interval=500, eval_max_steps=-1, eval_tgt_len=192, ext_len=0, fp16=False, gpu0_bsz=-1, init='normal', init_range=0.1, init_std=0.02, local_batch_size=None, local_rank=0, log_all_ranks=False, log_interval=10, lr=0.01, lr_min=0.0, max_step=40000, max_step_scheduler=None, mem_len=192, method='lgreco', mom=0.0, multi_gpu='ddp', n_head=8, n_layer=16, no_env=False, no_eval=False, no_test=False, not_tied=False, optim='jitlamb', patience=0, powersgd_rank=32, pre_lnorm=False, proj_init_std=0.01, restart='', roll=True, same_length=False, sample_softmax=-1, save_all=False, scheduler='cosine', seed=666, swap_mem=False, target_perplexity=None, target_throughput=None, tgt_len=192, tied=True, txtlog_file='train_log.log', varlen=False, vocab='word', warmup_step=1000, weight_decay=0.0, work_dir='TF32/DP32_666')
world size: 4
Collecting environment information...
PyTorch version: 1.13.1+cu116
Is debug build: False
CUDA used to build PyTorch: 11.6
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.31

Python version: 3.8.10 (default, Nov 22 2023, 10:22:35)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.15.0-97-generic-x86_64-with-glibc2.29
Is CUDA available: True
CUDA runtime version: 11.6.124
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A100-SXM4-80GB
GPU 1: NVIDIA A100-SXM4-80GB
GPU 2: NVIDIA A100-SXM4-80GB
GPU 3: NVIDIA A100-SXM4-80GB

Nvidia driver version: 535.161.07
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] numpy==1.24.1
[pip3] torch==1.13.1+cu116
[pip3] torchaudio==0.13.1+cu116
[pip3] torchvision==0.14.1+cu116
[conda] Could not collect
Loading cached dataset...
Model Parameters:  191950298
LGreco Hook
PowerSGD config: matrix_approximation_rank = 32; start_powerSGD_iter = 1000; min_compression_rate = 2; orthogonalization_epsilon = 0; use_error_feedback = True; warm_start = True; random_seed = 0; compression_stats_logging_frequency = 10000
Model Parameters:  ====================================================================================================
191950298
LGreco Hook
    - work_dir : TF32/DP32_666
    - append_dataset : False
Model Parameters: Model Parameters:     - append_time : False
  191950298191950298

LGreco HookPowerSGD config: matrix_approximation_rank = 32; start_powerSGD_iter = 1000; min_compression_rate = 2; orthogonalization_epsilon = 0; use_error_feedback = True; warm_start = True; random_seed = 0; compression_stats_logging_frequency = 10000
LGreco Hook
    - cuda : True

    - fp16 : False
    - restart : 
    - debug : False
    - log_all_ranks : False
PowerSGD config: matrix_approximation_rank = 32; start_powerSGD_iter = 1000; min_compression_rate = 2; orthogonalization_epsilon = 0; use_error_feedback = True; warm_start = True; random_seed = 0; compression_stats_logging_frequency = 10000
    - dllog_file : train_log.json
PowerSGD config: matrix_approximation_rank = 32; start_powerSGD_iter = 1000; min_compression_rate = 2; orthogonalization_epsilon = 0; use_error_feedback = True; warm_start = True; random_seed = 0; compression_stats_logging_frequency = 10000
    - txtlog_file : train_log.log
    - save_all : False
    - no_env : False
    - no_eval : False
    - no_test : False
    - log_interval : 10
    - target_throughput : None
    - target_perplexity : None
    - apex_amp_opt_level : O2
    - amp : apex
    - affinity : socket_unique_interleaved
    - method : lgreco
    - data : ./wikitext-103/
    - dataset : wt103
    - vocab : word
    - n_layer : 16
    - n_head : 8
    - d_head : 64
    - d_embed : 512
    - d_model : 512
    - d_inner : 2048
    - dropout : 0.1
    - dropatt : 0.0
    - pre_lnorm : False
    - attn_type : 0
    - not_tied : False
    - clamp_len : -1
    - adaptive : True
    - div_val : 1
    - sample_softmax : -1
    - init : normal
    - emb_init : normal
    - init_range : 0.1
    - emb_init_range : 0.01
    - init_std : 0.02
    - proj_init_std : 0.01
    - optim : jitlamb
    - lr : 0.01
    - mom : 0.0
    - scheduler : cosine
    - max_step_scheduler : None
    - warmup_step : 1000
    - adjust_freq : 1000
    - decay_rate : 0.5
    - lr_min : 0.0
    - clip : 0.25
    - weight_decay : 0.0
    - clip_nonemb : False
    - patience : 0
    - eta_min : 0.001
    - max_step : 40000
    - batch_size : 256
    - local_batch_size : None
    - batch_chunk : 2
    - roll : True
    - tgt_len : 192
    - ext_len : 0
    - mem_len : 192
    - seed : 666
    - multi_gpu : ddp
    - gpu0_bsz : -1
    - same_length : False
    - varlen : False
    - swap_mem : False
    - eval_tgt_len : 192
    - eval_batch_size : 16
    - eval_max_steps : -1
    - eval_interval : 500
    - local_rank : 0
    - powersgd_rank : 32
    - tied : True
    - n_token : 267735
    - n_all_param : 191950298
    - n_nonemb_param : 54599680
====================================================================================================
#params = 191950298
#non emb params = 54599680
[W reducer.cpp:1298] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
[W reducer.cpp:1298] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
[W reducer.cpp:1298] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
[W reducer.cpp:1298] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
| epoch   1 step       10 | batches     10 / 2101 | lr 1.000e-04 | ms/batch 936.9 | tok/s   52467 | loss  9.80 | ppl  18064.73
| epoch   1 step       20 | batches     20 / 2101 | lr 2.000e-04 | ms/batch 737.1 | tok/s   66682 | loss  9.67 | ppl  15836.78
| epoch   1 step       30 | batches     30 / 2101 | lr 3.000e-04 | ms/batch 738.3 | tok/s   66577 | loss  9.60 | ppl  14825.78
| epoch   1 step       40 | batches     40 / 2101 | lr 4.000e-04 | ms/batch 738.6 | tok/s   66545 | loss  9.55 | ppl  14034.11
| epoch   1 step       50 | batches     50 / 2101 | lr 5.000e-04 | ms/batch 737.8 | tok/s   66622 | loss  9.49 | ppl  13163.23
| epoch   1 step       60 | batches     60 / 2101 | lr 6.000e-04 | ms/batch 737.9 | tok/s   66610 | loss  9.43 | ppl  12464.52
| epoch   1 step       70 | batches     70 / 2101 | lr 7.000e-04 | ms/batch 738.2 | tok/s   66583 | loss  9.36 | ppl  11565.52
| epoch   1 step       80 | batches     80 / 2101 | lr 8.000e-04 | ms/batch 737.1 | tok/s   66684 | loss  9.27 | ppl  10640.95
| epoch   1 step       90 | batches     90 / 2101 | lr 9.000e-04 | ms/batch 737.1 | tok/s   66685 | loss  9.18 | ppl   9747.49
| epoch   1 step      100 | batches    100 / 2101 | lr 1.000e-03 | ms/batch 739.2 | tok/s   66491 | loss  9.10 | ppl   8935.31
| epoch   1 step      110 | batches    110 / 2101 | lr 1.100e-03 | ms/batch 738.9 | tok/s   66518 | loss  9.01 | ppl   8159.55
| epoch   1 step      120 | batches    120 / 2101 | lr 1.200e-03 | ms/batch 738.0 | tok/s   66605 | loss  8.93 | ppl   7526.88
| epoch   1 step      130 | batches    130 / 2101 | lr 1.300e-03 | ms/batch 737.7 | tok/s   66630 | loss  8.83 | ppl   6809.33
| epoch   1 step      140 | batches    140 / 2101 | lr 1.400e-03 | ms/batch 738.1 | tok/s   66593 | loss  8.77 | ppl   6419.68
| epoch   1 step      150 | batches    150 / 2101 | lr 1.500e-03 | ms/batch 737.7 | tok/s   66628 | loss  8.68 | ppl   5860.67
| epoch   1 step      160 | batches    160 / 2101 | lr 1.600e-03 | ms/batch 737.6 | tok/s   66635 | loss  8.60 | ppl   5440.67
| epoch   1 step      170 | batches    170 / 2101 | lr 1.700e-03 | ms/batch 737.0 | tok/s   66692 | loss  8.53 | ppl   5058.86
| epoch   1 step      180 | batches    180 / 2101 | lr 1.800e-03 | ms/batch 737.0 | tok/s   66694 | loss  8.44 | ppl   4632.64
| epoch   1 step      190 | batches    190 / 2101 | lr 1.900e-03 | ms/batch 736.7 | tok/s   66717 | loss  8.34 | ppl   4179.90
| epoch   1 step      200 | batches    200 / 2101 | lr 2.000e-03 | ms/batch 737.3 | tok/s   66668 | loss  8.25 | ppl   3836.39
| epoch   1 step      210 | batches    210 / 2101 | lr 2.100e-03 | ms/batch 736.3 | tok/s   66755 | loss  8.14 | ppl   3427.00
| epoch   1 step      220 | batches    220 / 2101 | lr 2.200e-03 | ms/batch 736.5 | tok/s   66736 | loss  8.05 | ppl   3129.45
| epoch   1 step      230 | batches    230 / 2101 | lr 2.300e-03 | ms/batch 737.3 | tok/s   66665 | loss  7.94 | ppl   2819.14
| epoch   1 step      240 | batches    240 / 2101 | lr 2.400e-03 | ms/batch 736.1 | tok/s   66772 | loss  7.84 | ppl   2533.26
| epoch   1 step      250 | batches    250 / 2101 | lr 2.500e-03 | ms/batch 737.4 | tok/s   66656 | loss  7.76 | ppl   2346.25
| epoch   1 step      260 | batches    260 / 2101 | lr 2.600e-03 | ms/batch 738.2 | tok/s   66585 | loss  7.69 | ppl   2195.22
| epoch   1 step      270 | batches    270 / 2101 | lr 2.700e-03 | ms/batch 738.8 | tok/s   66528 | loss  7.61 | ppl   2022.59
| epoch   1 step      280 | batches    280 / 2101 | lr 2.800e-03 | ms/batch 738.5 | tok/s   66557 | loss  7.51 | ppl   1835.21
| epoch   1 step      290 | batches    290 / 2101 | lr 2.900e-03 | ms/batch 738.2 | tok/s   66584 | loss  7.44 | ppl   1698.90
| epoch   1 step      300 | batches    300 / 2101 | lr 3.000e-03 | ms/batch 737.8 | tok/s   66624 | loss  7.37 | ppl   1580.94
| epoch   1 step      310 | batches    310 / 2101 | lr 3.100e-03 | ms/batch 736.1 | tok/s   66771 | loss  7.29 | ppl   1459.39
| epoch   1 step      320 | batches    320 / 2101 | lr 3.200e-03 | ms/batch 736.4 | tok/s   66744 | loss  7.20 | ppl   1338.24
| epoch   1 step      330 | batches    330 / 2101 | lr 3.300e-03 | ms/batch 736.5 | tok/s   66736 | loss  7.11 | ppl   1224.69
| epoch   1 step      340 | batches    340 / 2101 | lr 3.400e-03 | ms/batch 735.6 | tok/s   66822 | loss  7.04 | ppl   1146.71
| epoch   1 step      350 | batches    350 / 2101 | lr 3.500e-03 | ms/batch 736.3 | tok/s   66760 | loss  6.99 | ppl   1082.99
| epoch   1 step      360 | batches    360 / 2101 | lr 3.600e-03 | ms/batch 736.7 | tok/s   66716 | loss  6.92 | ppl   1014.96
| epoch   1 step      370 | batches    370 / 2101 | lr 3.700e-03 | ms/batch 736.6 | tok/s   66724 | loss  6.87 | ppl    959.49
| epoch   1 step      380 | batches    380 / 2101 | lr 3.800e-03 | ms/batch 735.7 | tok/s   66806 | loss  6.79 | ppl    892.49
| epoch   1 step      390 | batches    390 / 2101 | lr 3.900e-03 | ms/batch 737.8 | tok/s   66617 | loss  6.75 | ppl    851.81
| epoch   1 step      400 | batches    400 / 2101 | lr 4.000e-03 | ms/batch 737.9 | tok/s   66609 | loss  6.69 | ppl    805.46
| epoch   1 step      410 | batches    410 / 2101 | lr 4.100e-03 | ms/batch 737.0 | tok/s   66694 | loss  6.61 | ppl    745.28
| epoch   1 step      420 | batches    420 / 2101 | lr 4.200e-03 | ms/batch 735.7 | tok/s   66810 | loss  6.59 | ppl    731.03
| epoch   1 step      430 | batches    430 / 2101 | lr 4.300e-03 | ms/batch 737.0 | tok/s   66695 | loss  6.55 | ppl    698.49
| epoch   1 step      440 | batches    440 / 2101 | lr 4.400e-03 | ms/batch 736.8 | tok/s   66712 | loss  6.50 | ppl    667.66
| epoch   1 step      450 | batches    450 / 2101 | lr 4.500e-03 | ms/batch 736.0 | tok/s   66780 | loss  6.45 | ppl    635.59
| epoch   1 step      460 | batches    460 / 2101 | lr 4.600e-03 | ms/batch 736.2 | tok/s   66764 | loss  6.44 | ppl    626.07
| epoch   1 step      470 | batches    470 / 2101 | lr 4.700e-03 | ms/batch 736.0 | tok/s   66785 | loss  6.39 | ppl    594.88
| epoch   1 step      480 | batches    480 / 2101 | lr 4.800e-03 | ms/batch 735.7 | tok/s   66807 | loss  6.36 | ppl    577.35
| epoch   1 step      490 | batches    490 / 2101 | lr 4.900e-03 | ms/batch 737.2 | tok/s   66676 | loss  6.33 | ppl    563.44
| epoch   1 step      500 | batches    500 / 2101 | lr 5.000e-03 | ms/batch 736.7 | tok/s   66718 | loss  6.29 | ppl    538.82
----------------------------------------------------------------------------------------------------
| Eval   1 at step      500 | time:  1.24s | valid loss  6.20 | valid ppl   492.051
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/DP32_666/checkpoint_last.pt
Saving checkpoint to TF32/DP32_666/checkpoint_best.pt
| epoch   1 step      510 | batches    510 / 2101 | lr 5.100e-03 | ms/batch 736.4 | tok/s   66745 | loss  6.27 | ppl    529.11
| epoch   1 step      520 | batches    520 / 2101 | lr 5.200e-03 | ms/batch 736.7 | tok/s   66715 | loss  6.26 | ppl    524.94
| epoch   1 step      530 | batches    530 / 2101 | lr 5.300e-03 | ms/batch 736.6 | tok/s   66732 | loss  6.21 | ppl    496.91
| epoch   1 step      540 | batches    540 / 2101 | lr 5.400e-03 | ms/batch 736.6 | tok/s   66725 | loss  6.21 | ppl    498.24
| epoch   1 step      550 | batches    550 / 2101 | lr 5.500e-03 | ms/batch 736.6 | tok/s   66725 | loss  6.19 | ppl    485.47
| epoch   1 step      560 | batches    560 / 2101 | lr 5.600e-03 | ms/batch 736.7 | tok/s   66724 | loss  6.18 | ppl    482.72
| epoch   1 step      570 | batches    570 / 2101 | lr 5.700e-03 | ms/batch 737.0 | tok/s   66695 | loss  6.14 | ppl    463.39
| epoch   1 step      580 | batches    580 / 2101 | lr 5.800e-03 | ms/batch 736.6 | tok/s   66726 | loss  6.11 | ppl    449.17
| epoch   1 step      590 | batches    590 / 2101 | lr 5.900e-03 | ms/batch 736.8 | tok/s   66706 | loss  6.06 | ppl    430.11
| epoch   1 step      600 | batches    600 / 2101 | lr 6.000e-03 | ms/batch 737.8 | tok/s   66617 | loss  6.08 | ppl    435.92
| epoch   1 step      610 | batches    610 / 2101 | lr 6.100e-03 | ms/batch 736.5 | tok/s   66737 | loss  6.04 | ppl    419.22
| epoch   1 step      620 | batches    620 / 2101 | lr 6.200e-03 | ms/batch 737.6 | tok/s   66640 | loss  6.02 | ppl    411.19
| epoch   1 step      630 | batches    630 / 2101 | lr 6.300e-03 | ms/batch 736.5 | tok/s   66737 | loss  5.98 | ppl    393.72
| epoch   1 step      640 | batches    640 / 2101 | lr 6.400e-03 | ms/batch 736.4 | tok/s   66742 | loss  5.94 | ppl    380.07
| epoch   1 step      650 | batches    650 / 2101 | lr 6.500e-03 | ms/batch 738.0 | tok/s   66605 | loss  5.97 | ppl    391.87
| epoch   1 step      660 | batches    660 / 2101 | lr 6.600e-03 | ms/batch 737.4 | tok/s   66653 | loss  5.93 | ppl    374.42
| epoch   1 step      670 | batches    670 / 2101 | lr 6.700e-03 | ms/batch 737.4 | tok/s   66657 | loss  5.91 | ppl    369.16
| epoch   1 step      680 | batches    680 / 2101 | lr 6.800e-03 | ms/batch 737.3 | tok/s   66662 | loss  5.86 | ppl    351.65
| epoch   1 step      690 | batches    690 / 2101 | lr 6.900e-03 | ms/batch 735.4 | tok/s   66834 | loss  5.83 | ppl    338.77
| epoch   1 step      700 | batches    700 / 2101 | lr 7.000e-03 | ms/batch 735.2 | tok/s   66853 | loss  5.84 | ppl    344.32
| epoch   1 step      710 | batches    710 / 2101 | lr 7.100e-03 | ms/batch 737.4 | tok/s   66656 | loss  5.82 | ppl    335.76
| epoch   1 step      720 | batches    720 / 2101 | lr 7.200e-03 | ms/batch 736.9 | tok/s   66701 | loss  5.81 | ppl    332.34
| epoch   1 step      730 | batches    730 / 2101 | lr 7.300e-03 | ms/batch 737.1 | tok/s   66686 | loss  5.79 | ppl    327.80
| epoch   1 step      740 | batches    740 / 2101 | lr 7.400e-03 | ms/batch 736.3 | tok/s   66758 | loss  5.76 | ppl    318.05
| epoch   1 step      750 | batches    750 / 2101 | lr 7.500e-03 | ms/batch 735.6 | tok/s   66819 | loss  5.74 | ppl    310.07
| epoch   1 step      760 | batches    760 / 2101 | lr 7.600e-03 | ms/batch 735.3 | tok/s   66851 | loss  5.73 | ppl    307.70
| epoch   1 step      770 | batches    770 / 2101 | lr 7.700e-03 | ms/batch 736.6 | tok/s   66730 | loss  5.70 | ppl    300.20
| epoch   1 step      780 | batches    780 / 2101 | lr 7.800e-03 | ms/batch 737.1 | tok/s   66687 | loss  5.69 | ppl    295.07
| epoch   1 step      790 | batches    790 / 2101 | lr 7.900e-03 | ms/batch 737.7 | tok/s   66630 | loss  5.66 | ppl    287.73
| epoch   1 step      800 | batches    800 / 2101 | lr 8.000e-03 | ms/batch 738.2 | tok/s   66580 | loss  5.67 | ppl    290.39
| epoch   1 step      810 | batches    810 / 2101 | lr 8.100e-03 | ms/batch 735.4 | tok/s   66834 | loss  5.62 | ppl    277.13
| epoch   1 step      820 | batches    820 / 2101 | lr 8.200e-03 | ms/batch 736.8 | tok/s   66714 | loss  5.62 | ppl    275.91
| epoch   1 step      830 | batches    830 / 2101 | lr 8.300e-03 | ms/batch 737.0 | tok/s   66695 | loss  5.65 | ppl    283.15
| epoch   1 step      840 | batches    840 / 2101 | lr 8.400e-03 | ms/batch 737.1 | tok/s   66679 | loss  5.62 | ppl    275.91
| epoch   1 step      850 | batches    850 / 2101 | lr 8.500e-03 | ms/batch 737.3 | tok/s   66669 | loss  5.55 | ppl    256.79
| epoch   1 step      860 | batches    860 / 2101 | lr 8.600e-03 | ms/batch 738.0 | tok/s   66597 | loss  5.60 | ppl    271.32
| epoch   1 step      870 | batches    870 / 2101 | lr 8.700e-03 | ms/batch 737.5 | tok/s   66650 | loss  5.55 | ppl    257.66
| epoch   1 step      880 | batches    880 / 2101 | lr 8.800e-03 | ms/batch 738.4 | tok/s   66569 | loss  5.53 | ppl    253.06
| epoch   1 step      890 | batches    890 / 2101 | lr 8.900e-03 | ms/batch 738.6 | tok/s   66546 | loss  5.54 | ppl    253.48
| epoch   1 step      900 | batches    900 / 2101 | lr 9.000e-03 | ms/batch 736.5 | tok/s   66742 | loss  5.50 | ppl    244.85
| epoch   1 step      910 | batches    910 / 2101 | lr 9.100e-03 | ms/batch 737.1 | tok/s   66684 | loss  5.50 | ppl    243.56
| epoch   1 step      920 | batches    920 / 2101 | lr 9.200e-03 | ms/batch 736.6 | tok/s   66730 | loss  5.46 | ppl    235.63
| epoch   1 step      930 | batches    930 / 2101 | lr 9.300e-03 | ms/batch 736.6 | tok/s   66731 | loss  5.46 | ppl    235.08
| epoch   1 step      940 | batches    940 / 2101 | lr 9.400e-03 | ms/batch 736.2 | tok/s   66767 | loss  5.47 | ppl    237.73
| epoch   1 step      950 | batches    950 / 2101 | lr 9.500e-03 | ms/batch 736.0 | tok/s   66785 | loss  5.45 | ppl    231.77
| epoch   1 step      960 | batches    960 / 2101 | lr 9.600e-03 | ms/batch 737.3 | tok/s   66666 | loss  5.44 | ppl    231.12
| epoch   1 step      970 | batches    970 / 2101 | lr 9.700e-03 | ms/batch 736.8 | tok/s   66708 | loss  5.39 | ppl    219.60
| epoch   1 step      980 | batches    980 / 2101 | lr 9.800e-03 | ms/batch 737.1 | tok/s   66679 | loss  5.42 | ppl    225.21
| epoch   1 step      990 | batches    990 / 2101 | lr 9.900e-03 | ms/batch 736.5 | tok/s   66741 | loss  5.40 | ppl    221.77
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
/usr/local/lib/python3.8/dist-packages/torch/optim/lr_scheduler.py:163: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
/usr/local/lib/python3.8/dist-packages/torch/optim/lr_scheduler.py:163: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
/usr/local/lib/python3.8/dist-packages/torch/optim/lr_scheduler.py:163: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
/usr/local/lib/python3.8/dist-packages/torch/optim/lr_scheduler.py:163: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
| epoch   1 step     1000 | batches   1000 / 2101 | lr 1.000e-02 | ms/batch 736.3 | tok/s   66757 | loss  5.35 | ppl    210.67
----------------------------------------------------------------------------------------------------
| Eval   2 at step     1000 | time:  1.24s | valid loss  5.18 | valid ppl   176.969
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/DP32_666/checkpoint_last.pt
Saving checkpoint to TF32/DP32_666/checkpoint_best.pt
A zero tensor of length 270810 that represents local error is created.
Allocating contiguous memory of length 0 for Ps, and of length 0 for Qs, respectively.
A zero tensor of length 270810 that represents local error is created.
Allocating contiguous memory of length 0 for Ps, and of length 0 for Qs, respectively.
A zero tensor of length 270810 that represents local error is created.
A zero tensor of length 270810 that represents local error is created.
Allocating contiguous memory of length 0 for Ps, and of length 0 for Qs, respectively.
Allocating contiguous memory of length 0 for Ps, and of length 0 for Qs, respectively.
Ns: []
Ms: []
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Ns: [1536, 512, 512, 2048, 512, 1536, 512, 512, 2048, 512]
Ms: [512, 512, 512, 512, 2048, 512, 512, 512, 512, 2048]
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Ns: [1536, 512, 512, 2048, 512, 1536, 512, 512, 2048, 512]
Ms: [512, 512, 512, 512, 2048, 512, 512, 512, 512, 2048]
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Ns: [1536, 512, 512, 2048, 512, 1536, 512, 512, 2048, 512]
Ms: [512, 512, 512, 512, 2048, 512, 512, 512, 512, 2048]
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Ns: [1536, 512, 512, 2048, 512, 1536, 512, 512, 2048, 512]
Ms: [512, 512, 512, 512, 2048, 512, 512, 512, 512, 2048]
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Ns: [1536, 512, 512, 2048, 512, 1536, 512, 512, 2048, 512]
Ms: [512, 512, 512, 512, 2048, 512, 512, 512, 512, 2048]
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Ns: [1536, 512, 512, 2048, 512, 1536, 512, 512, 2048, 512]
Ms: [512, 512, 512, 512, 2048, 512, 512, 512, 512, 2048]
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Ns: [1536, 512, 512, 2048, 512, 1536, 512, 512, 2048, 512]
Ms: [512, 512, 512, 512, 2048, 512, 512, 512, 512, 2048]
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
A zero tensor of length 6823424 that represents local error is created.
A zero tensor of length 6823424 that represents local error is created.
A zero tensor of length 6823424 that represents local error is created.
A zero tensor of length 6823424 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Ns: [1536, 512, 512, 2048, 512, 1536, 512, 512, 2048, 512]
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Ms: [512, 512, 512, 512, 2048, 512, 512, 512, 512, 2048]
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
A zero tensor of length 137081344 that represents local error is created.
A zero tensor of length 137081344 that represents local error is created.
A zero tensor of length 137081344 that represents local error is created.
Compression stats: iter 1000, total before compression 191950298, total after compression 13646522, rate 14.065876858587119
Compression stats: iter 1000, total before compression 191950298, total after compression 13646522, rate 14.065876858587119
A zero tensor of length 137081344 that represents local error is created.
Allocating contiguous memory of length 8567520 for Ps, and of length 16384 for Qs, respectively.
Allocating contiguous memory of length 8567520 for Ps, and of length 16384 for Qs, respectively.
Compression stats: iter 1000, total before compression 191950298, total after compression 13646522, rate 14.065876858587119
Compression stats: iter 1000, total before compression 191950298, total after compression 13646522, rate 14.065876858587119
Allocating contiguous memory of length 8567520 for Ps, and of length 16384 for Qs, respectively.
Allocating contiguous memory of length 8567520 for Ps, and of length 16384 for Qs, respectively.
Ns: [267735]
Ms: [512]
| epoch   1 step     1010 | batches   1010 / 2101 | lr 1.000e-02 | ms/batch 780.9 | tok/s   62940 | loss  5.34 | ppl    208.19
| epoch   1 step     1020 | batches   1020 / 2101 | lr 1.000e-02 | ms/batch 763.1 | tok/s   64412 | loss  5.35 | ppl    211.04
| epoch   1 step     1030 | batches   1030 / 2101 | lr 1.000e-02 | ms/batch 762.3 | tok/s   64480 | loss  5.35 | ppl    210.46
| epoch   1 step     1040 | batches   1040 / 2101 | lr 1.000e-02 | ms/batch 764.5 | tok/s   64297 | loss  5.33 | ppl    206.38
| epoch   1 step     1050 | batches   1050 / 2101 | lr 1.000e-02 | ms/batch 763.8 | tok/s   64353 | loss  5.27 | ppl    195.34
| epoch   1 step     1060 | batches   1060 / 2101 | lr 1.000e-02 | ms/batch 763.9 | tok/s   64340 | loss  5.30 | ppl    200.61
| epoch   1 step     1070 | batches   1070 / 2101 | lr 1.000e-02 | ms/batch 763.3 | tok/s   64391 | loss  5.32 | ppl    203.96
| epoch   1 step     1080 | batches   1080 / 2101 | lr 1.000e-02 | ms/batch 762.7 | tok/s   64441 | loss  5.27 | ppl    195.36
| epoch   1 step     1090 | batches   1090 / 2101 | lr 1.000e-02 | ms/batch 762.5 | tok/s   64465 | loss  5.26 | ppl    193.17
| epoch   1 step     1100 | batches   1100 / 2101 | lr 1.000e-02 | ms/batch 763.4 | tok/s   64382 | loss  5.26 | ppl    192.50
| epoch   1 step     1110 | batches   1110 / 2101 | lr 1.000e-02 | ms/batch 762.7 | tok/s   64443 | loss  5.21 | ppl    183.46
| epoch   1 step     1120 | batches   1120 / 2101 | lr 1.000e-02 | ms/batch 763.1 | tok/s   64410 | loss  5.26 | ppl    191.56
| epoch   1 step     1130 | batches   1130 / 2101 | lr 1.000e-02 | ms/batch 764.0 | tok/s   64336 | loss  5.24 | ppl    188.79
| epoch   1 step     1140 | batches   1140 / 2101 | lr 1.000e-02 | ms/batch 763.6 | tok/s   64369 | loss  5.18 | ppl    178.51
| epoch   1 step     1150 | batches   1150 / 2101 | lr 1.000e-02 | ms/batch 763.6 | tok/s   64368 | loss  5.22 | ppl    184.81
| epoch   1 step     1160 | batches   1160 / 2101 | lr 1.000e-02 | ms/batch 764.3 | tok/s   64306 | loss  5.18 | ppl    177.54
| epoch   1 step     1170 | batches   1170 / 2101 | lr 1.000e-02 | ms/batch 764.6 | tok/s   64283 | loss  5.19 | ppl    179.18
| epoch   1 step     1180 | batches   1180 / 2101 | lr 1.000e-02 | ms/batch 762.9 | tok/s   64425 | loss  5.17 | ppl    176.62
| epoch   1 step     1190 | batches   1190 / 2101 | lr 9.999e-03 | ms/batch 763.6 | tok/s   64368 | loss  5.20 | ppl    181.52
| epoch   1 step     1200 | batches   1200 / 2101 | lr 9.999e-03 | ms/batch 763.5 | tok/s   64377 | loss  5.18 | ppl    177.72
| epoch   1 step     1210 | batches   1210 / 2101 | lr 9.999e-03 | ms/batch 764.9 | tok/s   64262 | loss  5.18 | ppl    177.47
| epoch   1 step     1220 | batches   1220 / 2101 | lr 9.999e-03 | ms/batch 764.2 | tok/s   64321 | loss  5.17 | ppl    175.14
| epoch   1 step     1230 | batches   1230 / 2101 | lr 9.999e-03 | ms/batch 763.0 | tok/s   64424 | loss  5.14 | ppl    170.43
| epoch   1 step     1240 | batches   1240 / 2101 | lr 9.999e-03 | ms/batch 763.0 | tok/s   64423 | loss  5.09 | ppl    162.01
| epoch   1 step     1250 | batches   1250 / 2101 | lr 9.999e-03 | ms/batch 763.7 | tok/s   64365 | loss  5.05 | ppl    156.56
| epoch   1 step     1260 | batches   1260 / 2101 | lr 9.999e-03 | ms/batch 764.2 | tok/s   64321 | loss  5.04 | ppl    154.94
| epoch   1 step     1270 | batches   1270 / 2101 | lr 9.999e-03 | ms/batch 763.2 | tok/s   64401 | loss  5.03 | ppl    153.11
| epoch   1 step     1280 | batches   1280 / 2101 | lr 9.999e-03 | ms/batch 764.2 | tok/s   64321 | loss  5.06 | ppl    157.53
| epoch   1 step     1290 | batches   1290 / 2101 | lr 9.999e-03 | ms/batch 764.1 | tok/s   64328 | loss  5.06 | ppl    157.63
| epoch   1 step     1300 | batches   1300 / 2101 | lr 9.999e-03 | ms/batch 764.0 | tok/s   64333 | loss  5.07 | ppl    158.41
| epoch   1 step     1310 | batches   1310 / 2101 | lr 9.999e-03 | ms/batch 764.3 | tok/s   64309 | loss  5.05 | ppl    156.37
| epoch   1 step     1320 | batches   1320 / 2101 | lr 9.999e-03 | ms/batch 763.5 | tok/s   64381 | loss  5.02 | ppl    151.70
| epoch   1 step     1330 | batches   1330 / 2101 | lr 9.998e-03 | ms/batch 762.2 | tok/s   64489 | loss  5.00 | ppl    148.97
| epoch   1 step     1340 | batches   1340 / 2101 | lr 9.998e-03 | ms/batch 764.0 | tok/s   64332 | loss  5.00 | ppl    148.13
| epoch   1 step     1350 | batches   1350 / 2101 | lr 9.998e-03 | ms/batch 764.2 | tok/s   64321 | loss  5.02 | ppl    151.75
| epoch   1 step     1360 | batches   1360 / 2101 | lr 9.998e-03 | ms/batch 764.4 | tok/s   64303 | loss  5.03 | ppl    153.50
| epoch   1 step     1370 | batches   1370 / 2101 | lr 9.998e-03 | ms/batch 763.3 | tok/s   64397 | loss  5.04 | ppl    154.81
| epoch   1 step     1380 | batches   1380 / 2101 | lr 9.998e-03 | ms/batch 762.8 | tok/s   64433 | loss  5.00 | ppl    148.03
| epoch   1 step     1390 | batches   1390 / 2101 | lr 9.998e-03 | ms/batch 763.1 | tok/s   64415 | loss  4.96 | ppl    141.99
| epoch   1 step     1400 | batches   1400 / 2101 | lr 9.998e-03 | ms/batch 763.5 | tok/s   64374 | loss  4.98 | ppl    146.17
| epoch   1 step     1410 | batches   1410 / 2101 | lr 9.998e-03 | ms/batch 764.1 | tok/s   64323 | loss  4.96 | ppl    142.95
| epoch   1 step     1420 | batches   1420 / 2101 | lr 9.997e-03 | ms/batch 763.3 | tok/s   64397 | loss  4.99 | ppl    147.45
| epoch   1 step     1430 | batches   1430 / 2101 | lr 9.997e-03 | ms/batch 764.3 | tok/s   64308 | loss  5.00 | ppl    148.76
| epoch   1 step     1440 | batches   1440 / 2101 | lr 9.997e-03 | ms/batch 765.3 | tok/s   64223 | loss  4.99 | ppl    147.34
| epoch   1 step     1450 | batches   1450 / 2101 | lr 9.997e-03 | ms/batch 763.9 | tok/s   64343 | loss  4.97 | ppl    143.42
| epoch   1 step     1460 | batches   1460 / 2101 | lr 9.997e-03 | ms/batch 764.3 | tok/s   64309 | loss  4.98 | ppl    145.22
| epoch   1 step     1470 | batches   1470 / 2101 | lr 9.997e-03 | ms/batch 763.8 | tok/s   64349 | loss  4.95 | ppl    141.39
| epoch   1 step     1480 | batches   1480 / 2101 | lr 9.997e-03 | ms/batch 763.1 | tok/s   64415 | loss  4.93 | ppl    137.86
| epoch   1 step     1490 | batches   1490 / 2101 | lr 9.996e-03 | ms/batch 763.9 | tok/s   64346 | loss  4.91 | ppl    136.16
| epoch   1 step     1500 | batches   1500 / 2101 | lr 9.996e-03 | ms/batch 765.2 | tok/s   64236 | loss  4.93 | ppl    138.51
----------------------------------------------------------------------------------------------------
| Eval   3 at step     1500 | time:  1.24s | valid loss  4.69 | valid ppl   109.168
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/DP32_666/checkpoint_last.pt
Saving checkpoint to TF32/DP32_666/checkpoint_best.pt
| epoch   1 step     1510 | batches   1510 / 2101 | lr 9.996e-03 | ms/batch 764.7 | tok/s   64275 | loss  4.93 | ppl    138.50
| epoch   1 step     1520 | batches   1520 / 2101 | lr 9.996e-03 | ms/batch 764.0 | tok/s   64336 | loss  4.89 | ppl    132.50
| epoch   1 step     1530 | batches   1530 / 2101 | lr 9.996e-03 | ms/batch 763.5 | tok/s   64380 | loss  4.89 | ppl    132.84
| epoch   1 step     1540 | batches   1540 / 2101 | lr 9.996e-03 | ms/batch 764.0 | tok/s   64339 | loss  4.91 | ppl    135.39
| epoch   1 step     1550 | batches   1550 / 2101 | lr 9.996e-03 | ms/batch 764.0 | tok/s   64338 | loss  4.85 | ppl    127.99
| epoch   1 step     1560 | batches   1560 / 2101 | lr 9.995e-03 | ms/batch 764.1 | tok/s   64331 | loss  4.87 | ppl    130.28
| epoch   1 step     1570 | batches   1570 / 2101 | lr 9.995e-03 | ms/batch 764.3 | tok/s   64314 | loss  4.87 | ppl    130.76
| epoch   1 step     1580 | batches   1580 / 2101 | lr 9.995e-03 | ms/batch 764.1 | tok/s   64326 | loss  4.85 | ppl    128.19
| epoch   1 step     1590 | batches   1590 / 2101 | lr 9.995e-03 | ms/batch 763.4 | tok/s   64387 | loss  4.85 | ppl    127.93
| epoch   1 step     1600 | batches   1600 / 2101 | lr 9.995e-03 | ms/batch 761.6 | tok/s   64536 | loss  4.83 | ppl    125.38
| epoch   1 step     1610 | batches   1610 / 2101 | lr 9.995e-03 | ms/batch 763.5 | tok/s   64378 | loss  4.83 | ppl    125.05
| epoch   1 step     1620 | batches   1620 / 2101 | lr 9.994e-03 | ms/batch 762.7 | tok/s   64446 | loss  4.81 | ppl    123.18
| epoch   1 step     1630 | batches   1630 / 2101 | lr 9.994e-03 | ms/batch 765.2 | tok/s   64231 | loss  4.84 | ppl    126.37
| epoch   1 step     1640 | batches   1640 / 2101 | lr 9.994e-03 | ms/batch 763.1 | tok/s   64409 | loss  4.82 | ppl    123.76
| epoch   1 step     1650 | batches   1650 / 2101 | lr 9.994e-03 | ms/batch 764.9 | tok/s   64256 | loss  4.83 | ppl    125.10
| epoch   1 step     1660 | batches   1660 / 2101 | lr 9.994e-03 | ms/batch 765.2 | tok/s   64237 | loss  4.83 | ppl    125.43
| epoch   1 step     1670 | batches   1670 / 2101 | lr 9.993e-03 | ms/batch 761.7 | tok/s   64526 | loss  4.82 | ppl    124.48
| epoch   1 step     1680 | batches   1680 / 2101 | lr 9.993e-03 | ms/batch 762.0 | tok/s   64503 | loss  4.80 | ppl    121.27
| epoch   1 step     1690 | batches   1690 / 2101 | lr 9.993e-03 | ms/batch 762.3 | tok/s   64479 | loss  4.81 | ppl    122.15
| epoch   1 step     1700 | batches   1700 / 2101 | lr 9.993e-03 | ms/batch 762.8 | tok/s   64434 | loss  4.86 | ppl    128.81
| epoch   1 step     1710 | batches   1710 / 2101 | lr 9.993e-03 | ms/batch 762.5 | tok/s   64464 | loss  4.84 | ppl    126.18
| epoch   1 step     1720 | batches   1720 / 2101 | lr 9.992e-03 | ms/batch 763.1 | tok/s   64414 | loss  4.83 | ppl    125.27
| epoch   1 step     1730 | batches   1730 / 2101 | lr 9.992e-03 | ms/batch 760.9 | tok/s   64595 | loss  4.78 | ppl    118.79
| epoch   1 step     1740 | batches   1740 / 2101 | lr 9.992e-03 | ms/batch 759.8 | tok/s   64691 | loss  4.78 | ppl    118.52
| epoch   1 step     1750 | batches   1750 / 2101 | lr 9.992e-03 | ms/batch 760.1 | tok/s   64663 | loss  4.76 | ppl    116.25
| epoch   1 step     1760 | batches   1760 / 2101 | lr 9.992e-03 | ms/batch 761.3 | tok/s   64560 | loss  4.79 | ppl    120.51
| epoch   1 step     1770 | batches   1770 / 2101 | lr 9.991e-03 | ms/batch 761.0 | tok/s   64587 | loss  4.76 | ppl    117.24
| epoch   1 step     1780 | batches   1780 / 2101 | lr 9.991e-03 | ms/batch 759.8 | tok/s   64688 | loss  4.75 | ppl    115.31
| epoch   1 step     1790 | batches   1790 / 2101 | lr 9.991e-03 | ms/batch 761.6 | tok/s   64538 | loss  4.73 | ppl    112.86
| epoch   1 step     1800 | batches   1800 / 2101 | lr 9.991e-03 | ms/batch 761.0 | tok/s   64586 | loss  4.70 | ppl    109.56
| epoch   1 step     1810 | batches   1810 / 2101 | lr 9.990e-03 | ms/batch 761.2 | tok/s   64573 | loss  4.75 | ppl    115.97
| epoch   1 step     1820 | batches   1820 / 2101 | lr 9.990e-03 | ms/batch 761.0 | tok/s   64591 | loss  4.77 | ppl    118.45
| epoch   1 step     1830 | batches   1830 / 2101 | lr 9.990e-03 | ms/batch 761.3 | tok/s   64562 | loss  4.76 | ppl    116.82
| epoch   1 step     1840 | batches   1840 / 2101 | lr 9.990e-03 | ms/batch 761.7 | tok/s   64531 | loss  4.79 | ppl    119.83
| epoch   1 step     1850 | batches   1850 / 2101 | lr 9.989e-03 | ms/batch 762.1 | tok/s   64492 | loss  4.77 | ppl    117.53
| epoch   1 step     1860 | batches   1860 / 2101 | lr 9.989e-03 | ms/batch 762.3 | tok/s   64481 | loss  4.76 | ppl    117.08
| epoch   1 step     1870 | batches   1870 / 2101 | lr 9.989e-03 | ms/batch 761.4 | tok/s   64559 | loss  4.73 | ppl    113.20
| epoch   1 step     1880 | batches   1880 / 2101 | lr 9.989e-03 | ms/batch 761.8 | tok/s   64521 | loss  4.71 | ppl    111.11
| epoch   1 step     1890 | batches   1890 / 2101 | lr 9.988e-03 | ms/batch 762.3 | tok/s   64477 | loss  4.73 | ppl    113.58
| epoch   1 step     1900 | batches   1900 / 2101 | lr 9.988e-03 | ms/batch 762.8 | tok/s   64434 | loss  4.73 | ppl    113.38
| epoch   1 step     1910 | batches   1910 / 2101 | lr 9.988e-03 | ms/batch 761.4 | tok/s   64555 | loss  4.69 | ppl    108.88
| epoch   1 step     1920 | batches   1920 / 2101 | lr 9.988e-03 | ms/batch 761.7 | tok/s   64533 | loss  4.68 | ppl    107.91
| epoch   1 step     1930 | batches   1930 / 2101 | lr 9.987e-03 | ms/batch 761.7 | tok/s   64530 | loss  4.71 | ppl    110.95
| epoch   1 step     1940 | batches   1940 / 2101 | lr 9.987e-03 | ms/batch 760.9 | tok/s   64595 | loss  4.69 | ppl    109.38
| epoch   1 step     1950 | batches   1950 / 2101 | lr 9.987e-03 | ms/batch 760.8 | tok/s   64605 | loss  4.67 | ppl    107.19
| epoch   1 step     1960 | batches   1960 / 2101 | lr 9.987e-03 | ms/batch 760.2 | tok/s   64653 | loss  4.66 | ppl    105.92
| epoch   1 step     1970 | batches   1970 / 2101 | lr 9.986e-03 | ms/batch 761.7 | tok/s   64525 | loss  4.72 | ppl    111.79
| epoch   1 step     1980 | batches   1980 / 2101 | lr 9.986e-03 | ms/batch 761.3 | tok/s   64562 | loss  4.72 | ppl    112.01
| epoch   1 step     1990 | batches   1990 / 2101 | lr 9.986e-03 | ms/batch 761.2 | tok/s   64569 | loss  4.65 | ppl    104.75
| epoch   1 step     2000 | batches   2000 / 2101 | lr 9.985e-03 | ms/batch 762.5 | tok/s   64461 | loss  4.65 | ppl    104.66
----------------------------------------------------------------------------------------------------
| Eval   4 at step     2000 | time:  1.24s | valid loss  4.43 | valid ppl    84.174
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/DP32_666/checkpoint_last.pt
Saving checkpoint to TF32/DP32_666/checkpoint_best.pt
optimal compression parameters = [[], [88, 128, 15, 65, 54, 79, 128, 11, 64, 69], [86, 115, 13, 67, 33, 119, 120, 39, 53, 26], [72, 98, 10, 35, 15, 62, 69, 9, 35, 19], [63, 83, 8, 27, 13, 46, 53, 9, 32, 19], [16, 20, 8, 15, 11, 35, 42, 10, 20, 15], [33, 42, 9, 16, 12, 32, 44, 10, 17, 12], [36, 61, 9, 17, 11, 44, 51, 8, 19, 11], [30, 47, 8, 13, 12, 36, 55, 10, 14, 15], [8]]
| epoch   1 step     2010 | batches   2010 / 2101 | lr 9.985e-03 | ms/batch 7505.3 | tok/s    6549 | loss  4.63 | ppl    102.48
| epoch   1 step     2020 | batches   2020 / 2101 | lr 9.985e-03 | ms/batch 761.5 | tok/s   64550 | loss  4.63 | ppl    102.13
| epoch   1 step     2030 | batches   2030 / 2101 | lr 9.985e-03 | ms/batch 762.6 | tok/s   64450 | loss  4.64 | ppl    103.47
| epoch   1 step     2040 | batches   2040 / 2101 | lr 9.984e-03 | ms/batch 761.6 | tok/s   64537 | loss  4.68 | ppl    107.25
| epoch   1 step     2050 | batches   2050 / 2101 | lr 9.984e-03 | ms/batch 761.5 | tok/s   64544 | loss  4.67 | ppl    106.87
| epoch   1 step     2060 | batches   2060 / 2101 | lr 9.984e-03 | ms/batch 761.7 | tok/s   64530 | loss  4.65 | ppl    104.09
| epoch   1 step     2070 | batches   2070 / 2101 | lr 9.983e-03 | ms/batch 760.7 | tok/s   64618 | loss  4.63 | ppl    102.86
| epoch   1 step     2080 | batches   2080 / 2101 | lr 9.983e-03 | ms/batch 761.3 | tok/s   64565 | loss  4.63 | ppl    102.40
| epoch   1 step     2090 | batches   2090 / 2101 | lr 9.983e-03 | ms/batch 762.9 | tok/s   64425 | loss  4.67 | ppl    106.65
| epoch   1 step     2100 | batches   2100 / 2101 | lr 9.982e-03 | ms/batch 762.1 | tok/s   64499 | loss  4.62 | ppl    101.56
| epoch   2 step     2110 | batches      9 / 2101 | lr 9.982e-03 | ms/batch 762.9 | tok/s   64433 | loss  4.68 | ppl    107.94
| epoch   2 step     2120 | batches     19 / 2101 | lr 9.982e-03 | ms/batch 762.8 | tok/s   64434 | loss  4.62 | ppl    101.62
| epoch   2 step     2130 | batches     29 / 2101 | lr 9.981e-03 | ms/batch 760.2 | tok/s   64653 | loss  4.57 | ppl     96.62
| epoch   2 step     2140 | batches     39 / 2101 | lr 9.981e-03 | ms/batch 761.0 | tok/s   64589 | loss  4.58 | ppl     97.11
| epoch   2 step     2150 | batches     49 / 2101 | lr 9.981e-03 | ms/batch 760.6 | tok/s   64627 | loss  4.54 | ppl     93.64
| epoch   2 step     2160 | batches     59 / 2101 | lr 9.980e-03 | ms/batch 760.4 | tok/s   64644 | loss  4.57 | ppl     96.54
| epoch   2 step     2170 | batches     69 / 2101 | lr 9.980e-03 | ms/batch 760.9 | tok/s   64596 | loss  4.54 | ppl     93.60
| epoch   2 step     2180 | batches     79 / 2101 | lr 9.980e-03 | ms/batch 760.2 | tok/s   64653 | loss  4.52 | ppl     91.90
| epoch   2 step     2190 | batches     89 / 2101 | lr 9.979e-03 | ms/batch 760.9 | tok/s   64602 | loss  4.53 | ppl     92.86
| epoch   2 step     2200 | batches     99 / 2101 | lr 9.979e-03 | ms/batch 761.2 | tok/s   64576 | loss  4.54 | ppl     93.65
| epoch   2 step     2210 | batches    109 / 2101 | lr 9.979e-03 | ms/batch 761.6 | tok/s   64539 | loss  4.53 | ppl     92.66
| epoch   2 step     2220 | batches    119 / 2101 | lr 9.978e-03 | ms/batch 760.5 | tok/s   64630 | loss  4.51 | ppl     90.77
| epoch   2 step     2230 | batches    129 / 2101 | lr 9.978e-03 | ms/batch 760.8 | tok/s   64604 | loss  4.51 | ppl     90.85
| epoch   2 step     2240 | batches    139 / 2101 | lr 9.978e-03 | ms/batch 760.8 | tok/s   64602 | loss  4.53 | ppl     92.85
| epoch   2 step     2250 | batches    149 / 2101 | lr 9.977e-03 | ms/batch 762.9 | tok/s   64432 | loss  4.57 | ppl     96.68
| epoch   2 step     2260 | batches    159 / 2101 | lr 9.977e-03 | ms/batch 762.3 | tok/s   64479 | loss  4.50 | ppl     90.27
| epoch   2 step     2270 | batches    169 / 2101 | lr 9.976e-03 | ms/batch 760.1 | tok/s   64666 | loss  4.46 | ppl     86.25
| epoch   2 step     2280 | batches    179 / 2101 | lr 9.976e-03 | ms/batch 759.6 | tok/s   64711 | loss  4.47 | ppl     87.63
| epoch   2 step     2290 | batches    189 / 2101 | lr 9.976e-03 | ms/batch 760.0 | tok/s   64673 | loss  4.47 | ppl     87.60
| epoch   2 step     2300 | batches    199 / 2101 | lr 9.975e-03 | ms/batch 760.3 | tok/s   64644 | loss  4.51 | ppl     91.03
| epoch   2 step     2310 | batches    209 / 2101 | lr 9.975e-03 | ms/batch 762.0 | tok/s   64508 | loss  4.50 | ppl     90.02
| epoch   2 step     2320 | batches    219 / 2101 | lr 9.975e-03 | ms/batch 760.8 | tok/s   64605 | loss  4.46 | ppl     86.77
| epoch   2 step     2330 | batches    229 / 2101 | lr 9.974e-03 | ms/batch 761.4 | tok/s   64556 | loss  4.48 | ppl     88.27
| epoch   2 step     2340 | batches    239 / 2101 | lr 9.974e-03 | ms/batch 762.4 | tok/s   64473 | loss  4.49 | ppl     89.55
| epoch   2 step     2350 | batches    249 / 2101 | lr 9.973e-03 | ms/batch 760.2 | tok/s   64656 | loss  4.48 | ppl     88.11
| epoch   2 step     2360 | batches    259 / 2101 | lr 9.973e-03 | ms/batch 760.8 | tok/s   64607 | loss  4.50 | ppl     90.33
| epoch   2 step     2370 | batches    269 / 2101 | lr 9.973e-03 | ms/batch 760.6 | tok/s   64619 | loss  4.47 | ppl     86.93
| epoch   2 step     2380 | batches    279 / 2101 | lr 9.972e-03 | ms/batch 761.1 | tok/s   64580 | loss  4.50 | ppl     89.74
| epoch   2 step     2390 | batches    289 / 2101 | lr 9.972e-03 | ms/batch 760.6 | tok/s   64621 | loss  4.46 | ppl     86.28
| epoch   2 step     2400 | batches    299 / 2101 | lr 9.971e-03 | ms/batch 760.7 | tok/s   64618 | loss  4.46 | ppl     86.90
| epoch   2 step     2410 | batches    309 / 2101 | lr 9.971e-03 | ms/batch 760.5 | tok/s   64627 | loss  4.46 | ppl     86.69
| epoch   2 step     2420 | batches    319 / 2101 | lr 9.971e-03 | ms/batch 760.0 | tok/s   64677 | loss  4.47 | ppl     86.96
| epoch   2 step     2430 | batches    329 / 2101 | lr 9.970e-03 | ms/batch 761.2 | tok/s   64568 | loss  4.44 | ppl     84.85
| epoch   2 step     2440 | batches    339 / 2101 | lr 9.970e-03 | ms/batch 761.0 | tok/s   64590 | loss  4.47 | ppl     87.67
| epoch   2 step     2450 | batches    349 / 2101 | lr 9.969e-03 | ms/batch 760.2 | tok/s   64653 | loss  4.46 | ppl     86.32
| epoch   2 step     2460 | batches    359 / 2101 | lr 9.969e-03 | ms/batch 760.4 | tok/s   64643 | loss  4.45 | ppl     85.21
| epoch   2 step     2470 | batches    369 / 2101 | lr 9.968e-03 | ms/batch 761.2 | tok/s   64570 | loss  4.43 | ppl     84.29
| epoch   2 step     2480 | batches    379 / 2101 | lr 9.968e-03 | ms/batch 760.5 | tok/s   64628 | loss  4.45 | ppl     85.97
| epoch   2 step     2490 | batches    389 / 2101 | lr 9.968e-03 | ms/batch 760.6 | tok/s   64620 | loss  4.47 | ppl     87.24
| epoch   2 step     2500 | batches    399 / 2101 | lr 9.967e-03 | ms/batch 761.9 | tok/s   64517 | loss  4.46 | ppl     86.84
----------------------------------------------------------------------------------------------------
| Eval   5 at step     2500 | time:  1.24s | valid loss  4.23 | valid ppl    68.748
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/DP32_666/checkpoint_last.pt
Saving checkpoint to TF32/DP32_666/checkpoint_best.pt
| epoch   2 step     2510 | batches    409 / 2101 | lr 9.967e-03 | ms/batch 762.4 | tok/s   64473 | loss  4.43 | ppl     83.98
| epoch   2 step     2520 | batches    419 / 2101 | lr 9.966e-03 | ms/batch 761.8 | tok/s   64524 | loss  4.42 | ppl     82.78
| epoch   2 step     2530 | batches    429 / 2101 | lr 9.966e-03 | ms/batch 761.2 | tok/s   64572 | loss  4.41 | ppl     82.12
| epoch   2 step     2540 | batches    439 / 2101 | lr 9.965e-03 | ms/batch 760.8 | tok/s   64604 | loss  4.46 | ppl     86.17
| epoch   2 step     2550 | batches    449 / 2101 | lr 9.965e-03 | ms/batch 761.2 | tok/s   64571 | loss  4.43 | ppl     83.95
| epoch   2 step     2560 | batches    459 / 2101 | lr 9.965e-03 | ms/batch 761.4 | tok/s   64559 | loss  4.43 | ppl     83.53
| epoch   2 step     2570 | batches    469 / 2101 | lr 9.964e-03 | ms/batch 761.6 | tok/s   64538 | loss  4.43 | ppl     83.80
| epoch   2 step     2580 | batches    479 / 2101 | lr 9.964e-03 | ms/batch 762.2 | tok/s   64487 | loss  4.45 | ppl     86.00
| epoch   2 step     2590 | batches    489 / 2101 | lr 9.963e-03 | ms/batch 761.8 | tok/s   64521 | loss  4.44 | ppl     84.43
| epoch   2 step     2600 | batches    499 / 2101 | lr 9.963e-03 | ms/batch 760.8 | tok/s   64604 | loss  4.41 | ppl     82.52
| epoch   2 step     2610 | batches    509 / 2101 | lr 9.962e-03 | ms/batch 762.1 | tok/s   64498 | loss  4.40 | ppl     81.11
| epoch   2 step     2620 | batches    519 / 2101 | lr 9.962e-03 | ms/batch 761.8 | tok/s   64522 | loss  4.43 | ppl     84.22
| epoch   2 step     2630 | batches    529 / 2101 | lr 9.961e-03 | ms/batch 766.2 | tok/s   64147 | loss  4.43 | ppl     84.07
| epoch   2 step     2640 | batches    539 / 2101 | lr 9.961e-03 | ms/batch 761.6 | tok/s   64541 | loss  4.43 | ppl     84.27
| epoch   2 step     2650 | batches    549 / 2101 | lr 9.960e-03 | ms/batch 760.8 | tok/s   64603 | loss  4.40 | ppl     81.84
| epoch   2 step     2660 | batches    559 / 2101 | lr 9.960e-03 | ms/batch 761.0 | tok/s   64592 | loss  4.40 | ppl     81.34
| epoch   2 step     2670 | batches    569 / 2101 | lr 9.959e-03 | ms/batch 762.0 | tok/s   64505 | loss  4.44 | ppl     84.79
| epoch   2 step     2680 | batches    579 / 2101 | lr 9.959e-03 | ms/batch 762.9 | tok/s   64427 | loss  4.39 | ppl     80.56
| epoch   2 step     2690 | batches    589 / 2101 | lr 9.958e-03 | ms/batch 762.6 | tok/s   64456 | loss  4.40 | ppl     81.68
| epoch   2 step     2700 | batches    599 / 2101 | lr 9.958e-03 | ms/batch 761.6 | tok/s   64539 | loss  4.39 | ppl     80.33
| epoch   2 step     2710 | batches    609 / 2101 | lr 9.957e-03 | ms/batch 761.0 | tok/s   64592 | loss  4.39 | ppl     80.66
| epoch   2 step     2720 | batches    619 / 2101 | lr 9.957e-03 | ms/batch 761.8 | tok/s   64522 | loss  4.39 | ppl     80.85
| epoch   2 step     2730 | batches    629 / 2101 | lr 9.956e-03 | ms/batch 760.9 | tok/s   64598 | loss  4.37 | ppl     79.20
| epoch   2 step     2740 | batches    639 / 2101 | lr 9.956e-03 | ms/batch 761.7 | tok/s   64531 | loss  4.36 | ppl     78.22
| epoch   2 step     2750 | batches    649 / 2101 | lr 9.955e-03 | ms/batch 763.2 | tok/s   64402 | loss  4.37 | ppl     79.29
| epoch   2 step     2760 | batches    659 / 2101 | lr 9.955e-03 | ms/batch 763.0 | tok/s   64420 | loss  4.38 | ppl     79.98
| epoch   2 step     2770 | batches    669 / 2101 | lr 9.954e-03 | ms/batch 761.3 | tok/s   64560 | loss  4.41 | ppl     82.55
| epoch   2 step     2780 | batches    679 / 2101 | lr 9.954e-03 | ms/batch 761.8 | tok/s   64517 | loss  4.39 | ppl     80.70
| epoch   2 step     2790 | batches    689 / 2101 | lr 9.953e-03 | ms/batch 761.9 | tok/s   64512 | loss  4.38 | ppl     79.64
| epoch   2 step     2800 | batches    699 / 2101 | lr 9.953e-03 | ms/batch 762.3 | tok/s   64477 | loss  4.34 | ppl     76.64
| epoch   2 step     2810 | batches    709 / 2101 | lr 9.952e-03 | ms/batch 761.2 | tok/s   64573 | loss  4.35 | ppl     77.69
| epoch   2 step     2820 | batches    719 / 2101 | lr 9.952e-03 | ms/batch 761.1 | tok/s   64579 | loss  4.35 | ppl     77.86
| epoch   2 step     2830 | batches    729 / 2101 | lr 9.951e-03 | ms/batch 761.8 | tok/s   64521 | loss  4.38 | ppl     79.60
| epoch   2 step     2840 | batches    739 / 2101 | lr 9.951e-03 | ms/batch 761.4 | tok/s   64552 | loss  4.38 | ppl     80.13
| epoch   2 step     2850 | batches    749 / 2101 | lr 9.950e-03 | ms/batch 762.0 | tok/s   64507 | loss  4.37 | ppl     79.07
| epoch   2 step     2860 | batches    759 / 2101 | lr 9.950e-03 | ms/batch 761.9 | tok/s   64509 | loss  4.36 | ppl     78.10
| epoch   2 step     2870 | batches    769 / 2101 | lr 9.949e-03 | ms/batch 762.0 | tok/s   64508 | loss  4.35 | ppl     77.44
| epoch   2 step     2880 | batches    779 / 2101 | lr 9.948e-03 | ms/batch 762.8 | tok/s   64434 | loss  4.40 | ppl     81.19
| epoch   2 step     2890 | batches    789 / 2101 | lr 9.948e-03 | ms/batch 762.4 | tok/s   64466 | loss  4.38 | ppl     79.64
| epoch   2 step     2900 | batches    799 / 2101 | lr 9.947e-03 | ms/batch 762.6 | tok/s   64454 | loss  4.39 | ppl     80.79
| epoch   2 step     2910 | batches    809 / 2101 | lr 9.947e-03 | ms/batch 762.5 | tok/s   64464 | loss  4.43 | ppl     83.54
| epoch   2 step     2920 | batches    819 / 2101 | lr 9.946e-03 | ms/batch 762.1 | tok/s   64495 | loss  4.39 | ppl     80.41
| epoch   2 step     2930 | batches    829 / 2101 | lr 9.946e-03 | ms/batch 761.9 | tok/s   64510 | loss  4.37 | ppl     78.85
| epoch   2 step     2940 | batches    839 / 2101 | lr 9.945e-03 | ms/batch 761.0 | tok/s   64593 | loss  4.36 | ppl     78.38
| epoch   2 step     2950 | batches    849 / 2101 | lr 9.945e-03 | ms/batch 760.7 | tok/s   64614 | loss  4.33 | ppl     75.77
| epoch   2 step     2960 | batches    859 / 2101 | lr 9.944e-03 | ms/batch 761.1 | tok/s   64578 | loss  4.33 | ppl     76.04
| epoch   2 step     2970 | batches    869 / 2101 | lr 9.943e-03 | ms/batch 761.2 | tok/s   64573 | loss  4.31 | ppl     74.73
| epoch   2 step     2980 | batches    879 / 2101 | lr 9.943e-03 | ms/batch 761.0 | tok/s   64588 | loss  4.33 | ppl     75.89
| epoch   2 step     2990 | batches    889 / 2101 | lr 9.942e-03 | ms/batch 762.6 | tok/s   64453 | loss  4.36 | ppl     78.12
| epoch   2 step     3000 | batches    899 / 2101 | lr 9.942e-03 | ms/batch 763.2 | tok/s   64403 | loss  4.36 | ppl     78.25
----------------------------------------------------------------------------------------------------
| Eval   6 at step     3000 | time:  1.24s | valid loss  4.10 | valid ppl    60.519
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/DP32_666/checkpoint_last.pt
Saving checkpoint to TF32/DP32_666/checkpoint_best.pt
optimal compression parameters = [[], [101, 127, 17, 58, 48, 89, 127, 11, 65, 64], [92, 120, 12, 54, 29, 124, 127, 49, 63, 34], [79, 98, 8, 42, 24, 67, 76, 11, 45, 21], [67, 89, 8, 35, 16, 52, 57, 9, 38, 15], [19, 21, 8, 22, 14, 42, 42, 10, 20, 10], [31, 39, 8, 12, 8, 35, 41, 8, 15, 8], [33, 51, 9, 16, 10, 39, 49, 10, 16, 8], [30, 43, 10, 10, 11, 33, 49, 8, 14, 8], [8]]
| epoch   2 step     3010 | batches    909 / 2101 | lr 9.941e-03 | ms/batch 7504.8 | tok/s    6549 | loss  4.32 | ppl     75.41
| epoch   2 step     3020 | batches    919 / 2101 | lr 9.941e-03 | ms/batch 764.8 | tok/s   64267 | loss  4.35 | ppl     77.26
| epoch   2 step     3030 | batches    929 / 2101 | lr 9.940e-03 | ms/batch 763.2 | tok/s   64405 | loss  4.31 | ppl     74.43
| epoch   2 step     3040 | batches    939 / 2101 | lr 9.939e-03 | ms/batch 763.0 | tok/s   64421 | loss  4.30 | ppl     73.56
| epoch   2 step     3050 | batches    949 / 2101 | lr 9.939e-03 | ms/batch 763.7 | tok/s   64364 | loss  4.30 | ppl     73.46
| epoch   2 step     3060 | batches    959 / 2101 | lr 9.938e-03 | ms/batch 762.2 | tok/s   64487 | loss  4.27 | ppl     71.40
| epoch   2 step     3070 | batches    969 / 2101 | lr 9.938e-03 | ms/batch 761.3 | tok/s   64561 | loss  4.27 | ppl     71.23
| epoch   2 step     3080 | batches    979 / 2101 | lr 9.937e-03 | ms/batch 762.5 | tok/s   64466 | loss  4.29 | ppl     73.22
| epoch   2 step     3090 | batches    989 / 2101 | lr 9.936e-03 | ms/batch 763.6 | tok/s   64366 | loss  4.29 | ppl     72.81
| epoch   2 step     3100 | batches    999 / 2101 | lr 9.936e-03 | ms/batch 761.6 | tok/s   64539 | loss  4.27 | ppl     71.38
| epoch   2 step     3110 | batches   1009 / 2101 | lr 9.935e-03 | ms/batch 762.1 | tok/s   64494 | loss  4.28 | ppl     72.52
| epoch   2 step     3120 | batches   1019 / 2101 | lr 9.935e-03 | ms/batch 762.1 | tok/s   64495 | loss  4.27 | ppl     71.75
| epoch   2 step     3130 | batches   1029 / 2101 | lr 9.934e-03 | ms/batch 761.3 | tok/s   64568 | loss  4.27 | ppl     71.80
| epoch   2 step     3140 | batches   1039 / 2101 | lr 9.933e-03 | ms/batch 761.4 | tok/s   64552 | loss  4.28 | ppl     72.17
| epoch   2 step     3150 | batches   1049 / 2101 | lr 9.933e-03 | ms/batch 761.1 | tok/s   64579 | loss  4.29 | ppl     72.92
| epoch   2 step     3160 | batches   1059 / 2101 | lr 9.932e-03 | ms/batch 761.8 | tok/s   64520 | loss  4.31 | ppl     74.34
| epoch   2 step     3170 | batches   1069 / 2101 | lr 9.931e-03 | ms/batch 761.4 | tok/s   64553 | loss  4.28 | ppl     72.28
| epoch   2 step     3180 | batches   1079 / 2101 | lr 9.931e-03 | ms/batch 763.3 | tok/s   64393 | loss  4.29 | ppl     73.02
| epoch   2 step     3190 | batches   1089 / 2101 | lr 9.930e-03 | ms/batch 761.4 | tok/s   64551 | loss  4.30 | ppl     74.00
| epoch   2 step     3200 | batches   1099 / 2101 | lr 9.930e-03 | ms/batch 761.5 | tok/s   64551 | loss  4.29 | ppl     72.65
| epoch   2 step     3210 | batches   1109 / 2101 | lr 9.929e-03 | ms/batch 762.8 | tok/s   64433 | loss  4.34 | ppl     77.03
| epoch   2 step     3220 | batches   1119 / 2101 | lr 9.928e-03 | ms/batch 762.0 | tok/s   64506 | loss  4.32 | ppl     75.04
| epoch   2 step     3230 | batches   1129 / 2101 | lr 9.928e-03 | ms/batch 761.2 | tok/s   64569 | loss  4.32 | ppl     74.99
| epoch   2 step     3240 | batches   1139 / 2101 | lr 9.927e-03 | ms/batch 761.7 | tok/s   64530 | loss  4.32 | ppl     74.95
| epoch   2 step     3250 | batches   1149 / 2101 | lr 9.926e-03 | ms/batch 760.8 | tok/s   64605 | loss  4.29 | ppl     72.98
| epoch   2 step     3260 | batches   1159 / 2101 | lr 9.926e-03 | ms/batch 761.2 | tok/s   64576 | loss  4.27 | ppl     71.35
| epoch   2 step     3270 | batches   1169 / 2101 | lr 9.925e-03 | ms/batch 762.9 | tok/s   64426 | loss  4.27 | ppl     71.87
| epoch   2 step     3280 | batches   1179 / 2101 | lr 9.924e-03 | ms/batch 761.7 | tok/s   64531 | loss  4.27 | ppl     71.33
| epoch   2 step     3290 | batches   1189 / 2101 | lr 9.924e-03 | ms/batch 762.5 | tok/s   64464 | loss  4.29 | ppl     72.67
| epoch   2 step     3300 | batches   1199 / 2101 | lr 9.923e-03 | ms/batch 761.8 | tok/s   64519 | loss  4.30 | ppl     73.45
| epoch   2 step     3310 | batches   1209 / 2101 | lr 9.922e-03 | ms/batch 761.6 | tok/s   64539 | loss  4.28 | ppl     72.36
| epoch   2 step     3320 | batches   1219 / 2101 | lr 9.922e-03 | ms/batch 760.9 | tok/s   64597 | loss  4.30 | ppl     73.82
| epoch   2 step     3330 | batches   1229 / 2101 | lr 9.921e-03 | ms/batch 760.0 | tok/s   64674 | loss  4.29 | ppl     72.68
| epoch   2 step     3340 | batches   1239 / 2101 | lr 9.920e-03 | ms/batch 761.5 | tok/s   64545 | loss  4.28 | ppl     71.92
| epoch   2 step     3350 | batches   1249 / 2101 | lr 9.920e-03 | ms/batch 761.3 | tok/s   64559 | loss  4.28 | ppl     72.12
| epoch   2 step     3360 | batches   1259 / 2101 | lr 9.919e-03 | ms/batch 761.5 | tok/s   64549 | loss  4.32 | ppl     74.84
| epoch   2 step     3370 | batches   1269 / 2101 | lr 9.918e-03 | ms/batch 763.6 | tok/s   64369 | loss  4.29 | ppl     73.31
| epoch   2 step     3380 | batches   1279 / 2101 | lr 9.918e-03 | ms/batch 762.3 | tok/s   64482 | loss  4.30 | ppl     73.42
| epoch   2 step     3390 | batches   1289 / 2101 | lr 9.917e-03 | ms/batch 762.1 | tok/s   64492 | loss  4.31 | ppl     74.62
| epoch   2 step     3400 | batches   1299 / 2101 | lr 9.916e-03 | ms/batch 761.3 | tok/s   64563 | loss  4.28 | ppl     72.49
| epoch   2 step     3410 | batches   1309 / 2101 | lr 9.915e-03 | ms/batch 761.8 | tok/s   64517 | loss  4.27 | ppl     71.45
| epoch   2 step     3420 | batches   1319 / 2101 | lr 9.915e-03 | ms/batch 762.9 | tok/s   64428 | loss  4.24 | ppl     69.67
| epoch   2 step     3430 | batches   1329 / 2101 | lr 9.914e-03 | ms/batch 762.1 | tok/s   64498 | loss  4.27 | ppl     71.75
| epoch   2 step     3440 | batches   1339 / 2101 | lr 9.913e-03 | ms/batch 761.1 | tok/s   64580 | loss  4.25 | ppl     70.41
| epoch   2 step     3450 | batches   1349 / 2101 | lr 9.913e-03 | ms/batch 762.9 | tok/s   64430 | loss  4.27 | ppl     71.44
| epoch   2 step     3460 | batches   1359 / 2101 | lr 9.912e-03 | ms/batch 761.9 | tok/s   64509 | loss  4.23 | ppl     69.05
| epoch   2 step     3470 | batches   1369 / 2101 | lr 9.911e-03 | ms/batch 761.9 | tok/s   64516 | loss  4.25 | ppl     70.07
| epoch   2 step     3480 | batches   1379 / 2101 | lr 9.911e-03 | ms/batch 761.6 | tok/s   64540 | loss  4.25 | ppl     69.96
| epoch   2 step     3490 | batches   1389 / 2101 | lr 9.910e-03 | ms/batch 763.2 | tok/s   64399 | loss  4.24 | ppl     69.66
| epoch   2 step     3500 | batches   1399 / 2101 | lr 9.909e-03 | ms/batch 762.5 | tok/s   64461 | loss  4.26 | ppl     70.66
----------------------------------------------------------------------------------------------------
| Eval   7 at step     3500 | time:  1.24s | valid loss  4.00 | valid ppl    54.864
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/DP32_666/checkpoint_last.pt
Saving checkpoint to TF32/DP32_666/checkpoint_best.pt
| epoch   2 step     3510 | batches   1409 / 2101 | lr 9.908e-03 | ms/batch 763.6 | tok/s   64368 | loss  4.23 | ppl     68.92
| epoch   2 step     3520 | batches   1419 / 2101 | lr 9.908e-03 | ms/batch 763.2 | tok/s   64401 | loss  4.21 | ppl     67.54
| epoch   2 step     3530 | batches   1429 / 2101 | lr 9.907e-03 | ms/batch 763.0 | tok/s   64423 | loss  4.25 | ppl     70.03
| epoch   2 step     3540 | batches   1439 / 2101 | lr 9.906e-03 | ms/batch 761.8 | tok/s   64521 | loss  4.25 | ppl     69.84
| epoch   2 step     3550 | batches   1449 / 2101 | lr 9.905e-03 | ms/batch 761.4 | tok/s   64553 | loss  4.26 | ppl     70.98
| epoch   2 step     3560 | batches   1459 / 2101 | lr 9.905e-03 | ms/batch 761.5 | tok/s   64548 | loss  4.21 | ppl     67.42
| epoch   2 step     3570 | batches   1469 / 2101 | lr 9.904e-03 | ms/batch 760.4 | tok/s   64636 | loss  4.16 | ppl     63.81
| epoch   2 step     3580 | batches   1479 / 2101 | lr 9.903e-03 | ms/batch 760.8 | tok/s   64606 | loss  4.20 | ppl     66.84
| epoch   2 step     3590 | batches   1489 / 2101 | lr 9.902e-03 | ms/batch 762.5 | tok/s   64463 | loss  4.26 | ppl     71.04
| epoch   2 step     3600 | batches   1499 / 2101 | lr 9.902e-03 | ms/batch 761.9 | tok/s   64517 | loss  4.25 | ppl     70.02
| epoch   2 step     3610 | batches   1509 / 2101 | lr 9.901e-03 | ms/batch 762.1 | tok/s   64500 | loss  4.21 | ppl     67.37
| epoch   2 step     3620 | batches   1519 / 2101 | lr 9.900e-03 | ms/batch 762.2 | tok/s   64486 | loss  4.23 | ppl     68.83
| epoch   2 step     3630 | batches   1529 / 2101 | lr 9.899e-03 | ms/batch 762.1 | tok/s   64493 | loss  4.23 | ppl     69.05
| epoch   2 step     3640 | batches   1539 / 2101 | lr 9.899e-03 | ms/batch 761.8 | tok/s   64520 | loss  4.20 | ppl     66.86
| epoch   2 step     3650 | batches   1549 / 2101 | lr 9.898e-03 | ms/batch 761.7 | tok/s   64531 | loss  4.21 | ppl     67.57
| epoch   2 step     3660 | batches   1559 / 2101 | lr 9.897e-03 | ms/batch 760.9 | tok/s   64596 | loss  4.18 | ppl     65.66
| epoch   2 step     3670 | batches   1569 / 2101 | lr 9.896e-03 | ms/batch 761.5 | tok/s   64546 | loss  4.22 | ppl     67.97
| epoch   2 step     3680 | batches   1579 / 2101 | lr 9.896e-03 | ms/batch 760.5 | tok/s   64635 | loss  4.22 | ppl     67.85
| epoch   2 step     3690 | batches   1589 / 2101 | lr 9.895e-03 | ms/batch 761.3 | tok/s   64560 | loss  4.25 | ppl     69.93
| epoch   2 step     3700 | batches   1599 / 2101 | lr 9.894e-03 | ms/batch 760.9 | tok/s   64602 | loss  4.23 | ppl     68.80
| epoch   2 step     3710 | batches   1609 / 2101 | lr 9.893e-03 | ms/batch 762.5 | tok/s   64461 | loss  4.26 | ppl     70.52
| epoch   2 step     3720 | batches   1619 / 2101 | lr 9.892e-03 | ms/batch 762.4 | tok/s   64473 | loss  4.22 | ppl     67.86
| epoch   2 step     3730 | batches   1629 / 2101 | lr 9.892e-03 | ms/batch 761.1 | tok/s   64583 | loss  4.20 | ppl     66.46
| epoch   2 step     3740 | batches   1639 / 2101 | lr 9.891e-03 | ms/batch 761.4 | tok/s   64558 | loss  4.17 | ppl     64.94
| epoch   2 step     3750 | batches   1649 / 2101 | lr 9.890e-03 | ms/batch 761.0 | tok/s   64589 | loss  4.19 | ppl     66.01
| epoch   2 step     3760 | batches   1659 / 2101 | lr 9.889e-03 | ms/batch 762.2 | tok/s   64487 | loss  4.20 | ppl     66.81
| epoch   2 step     3770 | batches   1669 / 2101 | lr 9.888e-03 | ms/batch 761.8 | tok/s   64521 | loss  4.15 | ppl     63.34
| epoch   2 step     3780 | batches   1679 / 2101 | lr 9.888e-03 | ms/batch 763.0 | tok/s   64419 | loss  4.20 | ppl     66.67
| epoch   2 step     3790 | batches   1689 / 2101 | lr 9.887e-03 | ms/batch 762.2 | tok/s   64488 | loss  4.16 | ppl     64.02
| epoch   2 step     3800 | batches   1699 / 2101 | lr 9.886e-03 | ms/batch 761.8 | tok/s   64520 | loss  4.18 | ppl     65.65
| epoch   2 step     3810 | batches   1709 / 2101 | lr 9.885e-03 | ms/batch 763.7 | tok/s   64357 | loss  4.18 | ppl     65.62
| epoch   2 step     3820 | batches   1719 / 2101 | lr 9.884e-03 | ms/batch 763.3 | tok/s   64393 | loss  4.17 | ppl     64.97
| epoch   2 step     3830 | batches   1729 / 2101 | lr 9.884e-03 | ms/batch 762.4 | tok/s   64470 | loss  4.19 | ppl     65.93
| epoch   2 step     3840 | batches   1739 / 2101 | lr 9.883e-03 | ms/batch 762.7 | tok/s   64445 | loss  4.15 | ppl     63.34
| epoch   2 step     3850 | batches   1749 / 2101 | lr 9.882e-03 | ms/batch 762.0 | tok/s   64505 | loss  4.17 | ppl     64.72
| epoch   2 step     3860 | batches   1759 / 2101 | lr 9.881e-03 | ms/batch 761.6 | tok/s   64541 | loss  4.17 | ppl     64.97
| epoch   2 step     3870 | batches   1769 / 2101 | lr 9.880e-03 | ms/batch 761.5 | tok/s   64550 | loss  4.21 | ppl     67.35
| epoch   2 step     3880 | batches   1779 / 2101 | lr 9.879e-03 | ms/batch 761.4 | tok/s   64558 | loss  4.17 | ppl     64.68
| epoch   2 step     3890 | batches   1789 / 2101 | lr 9.879e-03 | ms/batch 760.8 | tok/s   64606 | loss  4.12 | ppl     61.67
| epoch   2 step     3900 | batches   1799 / 2101 | lr 9.878e-03 | ms/batch 761.6 | tok/s   64538 | loss  4.17 | ppl     64.49
| epoch   2 step     3910 | batches   1809 / 2101 | lr 9.877e-03 | ms/batch 761.8 | tok/s   64523 | loss  4.18 | ppl     65.53
| epoch   2 step     3920 | batches   1819 / 2101 | lr 9.876e-03 | ms/batch 761.0 | tok/s   64590 | loss  4.15 | ppl     63.74
| epoch   2 step     3930 | batches   1829 / 2101 | lr 9.875e-03 | ms/batch 761.9 | tok/s   64516 | loss  4.18 | ppl     65.48
| epoch   2 step     3940 | batches   1839 / 2101 | lr 9.874e-03 | ms/batch 762.2 | tok/s   64488 | loss  4.15 | ppl     63.52
| epoch   2 step     3950 | batches   1849 / 2101 | lr 9.874e-03 | ms/batch 761.0 | tok/s   64590 | loss  4.20 | ppl     66.78
| epoch   2 step     3960 | batches   1859 / 2101 | lr 9.873e-03 | ms/batch 762.4 | tok/s   64470 | loss  4.17 | ppl     64.59
| epoch   2 step     3970 | batches   1869 / 2101 | lr 9.872e-03 | ms/batch 762.2 | tok/s   64491 | loss  4.17 | ppl     64.57
| epoch   2 step     3980 | batches   1879 / 2101 | lr 9.871e-03 | ms/batch 762.1 | tok/s   64493 | loss  4.21 | ppl     67.55
| epoch   2 step     3990 | batches   1889 / 2101 | lr 9.870e-03 | ms/batch 762.2 | tok/s   64486 | loss  4.16 | ppl     63.91
| epoch   2 step     4000 | batches   1899 / 2101 | lr 9.869e-03 | ms/batch 763.6 | tok/s   64369 | loss  4.16 | ppl     64.27
----------------------------------------------------------------------------------------------------
| Eval   8 at step     4000 | time:  1.24s | valid loss  3.91 | valid ppl    50.011
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/DP32_666/checkpoint_last.pt
Saving checkpoint to TF32/DP32_666/checkpoint_best.pt
optimal compression parameters = [[], [100, 128, 18, 60, 46, 93, 125, 9, 58, 60], [83, 119, 13, 48, 26, 126, 124, 52, 52, 33], [79, 105, 9, 32, 17, 72, 74, 12, 41, 15], [68, 88, 8, 30, 16, 52, 60, 10, 29, 21], [14, 18, 9, 23, 14, 47, 49, 10, 17, 18], [31, 39, 8, 19, 13, 30, 46, 8, 19, 12], [35, 55, 10, 22, 14, 42, 66, 10, 22, 12], [28, 50, 8, 13, 14, 30, 46, 10, 15, 8], [8]]
| epoch   2 step     4010 | batches   1909 / 2101 | lr 9.868e-03 | ms/batch 7504.1 | tok/s    6550 | loss  4.20 | ppl     66.76
| epoch   2 step     4020 | batches   1919 / 2101 | lr 9.867e-03 | ms/batch 762.6 | tok/s   64455 | loss  4.17 | ppl     64.91
| epoch   2 step     4030 | batches   1929 / 2101 | lr 9.867e-03 | ms/batch 763.7 | tok/s   64358 | loss  4.20 | ppl     66.43
| epoch   2 step     4040 | batches   1939 / 2101 | lr 9.866e-03 | ms/batch 763.2 | tok/s   64399 | loss  4.21 | ppl     67.40
| epoch   2 step     4050 | batches   1949 / 2101 | lr 9.865e-03 | ms/batch 763.1 | tok/s   64410 | loss  4.23 | ppl     68.64
| epoch   2 step     4060 | batches   1959 / 2101 | lr 9.864e-03 | ms/batch 762.9 | tok/s   64424 | loss  4.21 | ppl     67.26
| epoch   2 step     4070 | batches   1969 / 2101 | lr 9.863e-03 | ms/batch 763.6 | tok/s   64369 | loss  4.21 | ppl     67.36
| epoch   2 step     4080 | batches   1979 / 2101 | lr 9.862e-03 | ms/batch 764.3 | tok/s   64310 | loss  4.22 | ppl     68.22
| epoch   2 step     4090 | batches   1989 / 2101 | lr 9.861e-03 | ms/batch 763.3 | tok/s   64395 | loss  4.17 | ppl     65.02
| epoch   2 step     4100 | batches   1999 / 2101 | lr 9.860e-03 | ms/batch 763.1 | tok/s   64407 | loss  4.19 | ppl     65.83
| epoch   2 step     4110 | batches   2009 / 2101 | lr 9.860e-03 | ms/batch 763.8 | tok/s   64348 | loss  4.20 | ppl     66.63
| epoch   2 step     4120 | batches   2019 / 2101 | lr 9.859e-03 | ms/batch 764.7 | tok/s   64273 | loss  4.22 | ppl     68.24
| epoch   2 step     4130 | batches   2029 / 2101 | lr 9.858e-03 | ms/batch 763.3 | tok/s   64397 | loss  4.21 | ppl     67.69
| epoch   2 step     4140 | batches   2039 / 2101 | lr 9.857e-03 | ms/batch 763.4 | tok/s   64382 | loss  4.17 | ppl     64.73
| epoch   2 step     4150 | batches   2049 / 2101 | lr 9.856e-03 | ms/batch 762.7 | tok/s   64445 | loss  4.16 | ppl     64.35
| epoch   2 step     4160 | batches   2059 / 2101 | lr 9.855e-03 | ms/batch 763.6 | tok/s   64366 | loss  4.15 | ppl     63.73
| epoch   2 step     4170 | batches   2069 / 2101 | lr 9.854e-03 | ms/batch 762.8 | tok/s   64435 | loss  4.14 | ppl     62.73
| epoch   2 step     4180 | batches   2079 / 2101 | lr 9.853e-03 | ms/batch 762.8 | tok/s   64436 | loss  4.12 | ppl     61.52
| epoch   2 step     4190 | batches   2089 / 2101 | lr 9.852e-03 | ms/batch 762.8 | tok/s   64439 | loss  4.14 | ppl     62.79
| epoch   2 step     4200 | batches   2099 / 2101 | lr 9.851e-03 | ms/batch 762.6 | tok/s   64452 | loss  4.14 | ppl     62.80
| epoch   3 step     4210 | batches      8 / 2101 | lr 9.850e-03 | ms/batch 763.8 | tok/s   64382 | loss  4.14 | ppl     62.92
| epoch   3 step     4220 | batches     18 / 2101 | lr 9.849e-03 | ms/batch 762.2 | tok/s   64486 | loss  4.08 | ppl     59.30
| epoch   3 step     4230 | batches     28 / 2101 | lr 9.849e-03 | ms/batch 762.8 | tok/s   64435 | loss  4.10 | ppl     60.12
| epoch   3 step     4240 | batches     38 / 2101 | lr 9.848e-03 | ms/batch 762.4 | tok/s   64468 | loss  4.09 | ppl     59.82
| epoch   3 step     4250 | batches     48 / 2101 | lr 9.847e-03 | ms/batch 761.5 | tok/s   64549 | loss  4.06 | ppl     58.12
| epoch   3 step     4260 | batches     58 / 2101 | lr 9.846e-03 | ms/batch 760.5 | tok/s   64628 | loss  4.07 | ppl     58.63
| epoch   3 step     4270 | batches     68 / 2101 | lr 9.845e-03 | ms/batch 761.9 | tok/s   64514 | loss  4.07 | ppl     58.71
| epoch   3 step     4280 | batches     78 / 2101 | lr 9.844e-03 | ms/batch 760.8 | tok/s   64604 | loss  4.06 | ppl     58.11
| epoch   3 step     4290 | batches     88 / 2101 | lr 9.843e-03 | ms/batch 761.5 | tok/s   64543 | loss  4.08 | ppl     58.97
| epoch   3 step     4300 | batches     98 / 2101 | lr 9.842e-03 | ms/batch 761.7 | tok/s   64531 | loss  4.11 | ppl     61.02
| epoch   3 step     4310 | batches    108 / 2101 | lr 9.841e-03 | ms/batch 761.2 | tok/s   64576 | loss  4.05 | ppl     57.65
| epoch   3 step     4320 | batches    118 / 2101 | lr 9.840e-03 | ms/batch 761.5 | tok/s   64543 | loss  4.06 | ppl     58.07
| epoch   3 step     4330 | batches    128 / 2101 | lr 9.839e-03 | ms/batch 762.1 | tok/s   64500 | loss  4.05 | ppl     57.24
| epoch   3 step     4340 | batches    138 / 2101 | lr 9.838e-03 | ms/batch 762.9 | tok/s   64430 | loss  4.04 | ppl     57.01
| epoch   3 step     4350 | batches    148 / 2101 | lr 9.837e-03 | ms/batch 762.1 | tok/s   64496 | loss  4.03 | ppl     56.00
| epoch   3 step     4360 | batches    158 / 2101 | lr 9.836e-03 | ms/batch 761.9 | tok/s   64516 | loss  4.04 | ppl     57.08
| epoch   3 step     4370 | batches    168 / 2101 | lr 9.835e-03 | ms/batch 762.9 | tok/s   64428 | loss  4.07 | ppl     58.29
| epoch   3 step     4380 | batches    178 / 2101 | lr 9.834e-03 | ms/batch 760.8 | tok/s   64608 | loss  4.06 | ppl     58.00
| epoch   3 step     4390 | batches    188 / 2101 | lr 9.833e-03 | ms/batch 761.0 | tok/s   64588 | loss  4.06 | ppl     58.08
| epoch   3 step     4400 | batches    198 / 2101 | lr 9.832e-03 | ms/batch 761.2 | tok/s   64574 | loss  4.05 | ppl     57.20
| epoch   3 step     4410 | batches    208 / 2101 | lr 9.831e-03 | ms/batch 762.7 | tok/s   64446 | loss  4.08 | ppl     59.32
| epoch   3 step     4420 | batches    218 / 2101 | lr 9.830e-03 | ms/batch 762.9 | tok/s   64426 | loss  4.12 | ppl     61.48
| epoch   3 step     4430 | batches    228 / 2101 | lr 9.829e-03 | ms/batch 763.7 | tok/s   64360 | loss  4.11 | ppl     60.87
| epoch   3 step     4440 | batches    238 / 2101 | lr 9.828e-03 | ms/batch 764.1 | tok/s   64328 | loss  4.08 | ppl     59.25
| epoch   3 step     4450 | batches    248 / 2101 | lr 9.827e-03 | ms/batch 761.8 | tok/s   64522 | loss  4.04 | ppl     57.11
| epoch   3 step     4460 | batches    258 / 2101 | lr 9.826e-03 | ms/batch 761.8 | tok/s   64524 | loss  4.06 | ppl     57.79
| epoch   3 step     4470 | batches    268 / 2101 | lr 9.825e-03 | ms/batch 762.8 | tok/s   64440 | loss  4.07 | ppl     58.39
| epoch   3 step     4480 | batches    278 / 2101 | lr 9.824e-03 | ms/batch 763.0 | tok/s   64420 | loss  4.05 | ppl     57.48
| epoch   3 step     4490 | batches    288 / 2101 | lr 9.823e-03 | ms/batch 762.3 | tok/s   64480 | loss  4.08 | ppl     59.29
| epoch   3 step     4500 | batches    298 / 2101 | lr 9.822e-03 | ms/batch 762.9 | tok/s   64430 | loss  4.06 | ppl     57.87
----------------------------------------------------------------------------------------------------
| Eval   9 at step     4500 | time:  1.24s | valid loss  3.86 | valid ppl    47.577
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/DP32_666/checkpoint_last.pt
Saving checkpoint to TF32/DP32_666/checkpoint_best.pt
| epoch   3 step     4510 | batches    308 / 2101 | lr 9.821e-03 | ms/batch 763.6 | tok/s   64370 | loss  4.06 | ppl     57.85
| epoch   3 step     4520 | batches    318 / 2101 | lr 9.820e-03 | ms/batch 763.2 | tok/s   64407 | loss  4.05 | ppl     57.33
| epoch   3 step     4530 | batches    328 / 2101 | lr 9.819e-03 | ms/batch 762.1 | tok/s   64498 | loss  4.05 | ppl     57.12
| epoch   3 step     4540 | batches    338 / 2101 | lr 9.818e-03 | ms/batch 761.9 | tok/s   64515 | loss  4.05 | ppl     57.37
| epoch   3 step     4550 | batches    348 / 2101 | lr 9.817e-03 | ms/batch 763.2 | tok/s   64402 | loss  4.06 | ppl     57.85
| epoch   3 step     4560 | batches    358 / 2101 | lr 9.816e-03 | ms/batch 762.1 | tok/s   64492 | loss  4.06 | ppl     57.74
| epoch   3 step     4570 | batches    368 / 2101 | lr 9.815e-03 | ms/batch 762.9 | tok/s   64424 | loss  4.09 | ppl     59.57
| epoch   3 step     4580 | batches    378 / 2101 | lr 9.814e-03 | ms/batch 762.3 | tok/s   64478 | loss  4.08 | ppl     58.93
| epoch   3 step     4590 | batches    388 / 2101 | lr 9.813e-03 | ms/batch 762.9 | tok/s   64425 | loss  4.06 | ppl     58.15
| epoch   3 step     4600 | batches    398 / 2101 | lr 9.812e-03 | ms/batch 761.3 | tok/s   64560 | loss  4.07 | ppl     58.30
| epoch   3 step     4610 | batches    408 / 2101 | lr 9.811e-03 | ms/batch 761.3 | tok/s   64564 | loss  4.04 | ppl     57.08
| epoch   3 step     4620 | batches    418 / 2101 | lr 9.810e-03 | ms/batch 760.7 | tok/s   64613 | loss  4.04 | ppl     56.72
| epoch   3 step     4630 | batches    428 / 2101 | lr 9.809e-03 | ms/batch 762.0 | tok/s   64506 | loss  4.01 | ppl     54.88
| epoch   3 step     4640 | batches    438 / 2101 | lr 9.808e-03 | ms/batch 763.4 | tok/s   64382 | loss  4.07 | ppl     58.41
| epoch   3 step     4650 | batches    448 / 2101 | lr 9.807e-03 | ms/batch 762.6 | tok/s   64452 | loss  4.02 | ppl     55.67
| epoch   3 step     4660 | batches    458 / 2101 | lr 9.806e-03 | ms/batch 761.9 | tok/s   64515 | loss  4.05 | ppl     57.42
| epoch   3 step     4670 | batches    468 / 2101 | lr 9.805e-03 | ms/batch 762.0 | tok/s   64502 | loss  4.04 | ppl     56.95
| epoch   3 step     4680 | batches    478 / 2101 | lr 9.804e-03 | ms/batch 761.9 | tok/s   64515 | loss  4.00 | ppl     54.77
| epoch   3 step     4690 | batches    488 / 2101 | lr 9.803e-03 | ms/batch 762.1 | tok/s   64493 | loss  4.00 | ppl     54.37
| epoch   3 step     4700 | batches    498 / 2101 | lr 9.802e-03 | ms/batch 763.3 | tok/s   64391 | loss  4.08 | ppl     59.37
| epoch   3 step     4710 | batches    508 / 2101 | lr 9.801e-03 | ms/batch 761.4 | tok/s   64552 | loss  4.07 | ppl     58.65
| epoch   3 step     4720 | batches    518 / 2101 | lr 9.799e-03 | ms/batch 762.1 | tok/s   64497 | loss  4.01 | ppl     55.19
| epoch   3 step     4730 | batches    528 / 2101 | lr 9.798e-03 | ms/batch 762.1 | tok/s   64493 | loss  4.03 | ppl     56.53
| epoch   3 step     4740 | batches    538 / 2101 | lr 9.797e-03 | ms/batch 762.2 | tok/s   64490 | loss  4.05 | ppl     57.33
| epoch   3 step     4750 | batches    548 / 2101 | lr 9.796e-03 | ms/batch 762.6 | tok/s   64457 | loss  3.98 | ppl     53.77
| epoch   3 step     4760 | batches    558 / 2101 | lr 9.795e-03 | ms/batch 762.6 | tok/s   64457 | loss  4.00 | ppl     54.80
| epoch   3 step     4770 | batches    568 / 2101 | lr 9.794e-03 | ms/batch 762.3 | tok/s   64480 | loss  4.04 | ppl     56.87
| epoch   3 step     4780 | batches    578 / 2101 | lr 9.793e-03 | ms/batch 761.1 | tok/s   64583 | loss  4.04 | ppl     56.97
| epoch   3 step     4790 | batches    588 / 2101 | lr 9.792e-03 | ms/batch 762.2 | tok/s   64485 | loss  4.08 | ppl     59.23
| epoch   3 step     4800 | batches    598 / 2101 | lr 9.791e-03 | ms/batch 762.3 | tok/s   64479 | loss  4.01 | ppl     55.13
| epoch   3 step     4810 | batches    608 / 2101 | lr 9.790e-03 | ms/batch 762.8 | tok/s   64437 | loss  4.04 | ppl     57.03
| epoch   3 step     4820 | batches    618 / 2101 | lr 9.789e-03 | ms/batch 761.9 | tok/s   64510 | loss  4.01 | ppl     55.09
| epoch   3 step     4830 | batches    628 / 2101 | lr 9.788e-03 | ms/batch 761.8 | tok/s   64521 | loss  4.05 | ppl     57.23
| epoch   3 step     4840 | batches    638 / 2101 | lr 9.786e-03 | ms/batch 760.8 | tok/s   64606 | loss  4.05 | ppl     57.56
| epoch   3 step     4850 | batches    648 / 2101 | lr 9.785e-03 | ms/batch 761.9 | tok/s   64516 | loss  4.02 | ppl     55.50
| epoch   3 step     4860 | batches    658 / 2101 | lr 9.784e-03 | ms/batch 761.4 | tok/s   64552 | loss  4.02 | ppl     55.71
| epoch   3 step     4870 | batches    668 / 2101 | lr 9.783e-03 | ms/batch 760.1 | tok/s   64662 | loss  3.97 | ppl     53.07
| epoch   3 step     4880 | batches    678 / 2101 | lr 9.782e-03 | ms/batch 760.9 | tok/s   64598 | loss  3.97 | ppl     52.80
| epoch   3 step     4890 | batches    688 / 2101 | lr 9.781e-03 | ms/batch 761.6 | tok/s   64539 | loss  4.00 | ppl     54.60
| epoch   3 step     4900 | batches    698 / 2101 | lr 9.780e-03 | ms/batch 763.3 | tok/s   64393 | loss  4.02 | ppl     55.70
| epoch   3 step     4910 | batches    708 / 2101 | lr 9.779e-03 | ms/batch 762.1 | tok/s   64498 | loss  4.03 | ppl     56.08
| epoch   3 step     4920 | batches    718 / 2101 | lr 9.778e-03 | ms/batch 763.4 | tok/s   64387 | loss  4.00 | ppl     54.86
| epoch   3 step     4930 | batches    728 / 2101 | lr 9.776e-03 | ms/batch 762.1 | tok/s   64492 | loss  4.01 | ppl     55.32
| epoch   3 step     4940 | batches    738 / 2101 | lr 9.775e-03 | ms/batch 763.2 | tok/s   64401 | loss  4.04 | ppl     57.04
| epoch   3 step     4950 | batches    748 / 2101 | lr 9.774e-03 | ms/batch 761.8 | tok/s   64525 | loss  4.01 | ppl     55.13
| epoch   3 step     4960 | batches    758 / 2101 | lr 9.773e-03 | ms/batch 761.7 | tok/s   64533 | loss  4.04 | ppl     56.61
| epoch   3 step     4970 | batches    768 / 2101 | lr 9.772e-03 | ms/batch 761.3 | tok/s   64560 | loss  4.03 | ppl     56.32
| epoch   3 step     4980 | batches    778 / 2101 | lr 9.771e-03 | ms/batch 762.7 | tok/s   64447 | loss  4.04 | ppl     56.84
| epoch   3 step     4990 | batches    788 / 2101 | lr 9.770e-03 | ms/batch 762.2 | tok/s   64489 | loss  4.00 | ppl     54.40
| epoch   3 step     5000 | batches    798 / 2101 | lr 9.768e-03 | ms/batch 764.6 | tok/s   64282 | loss  4.05 | ppl     57.58
----------------------------------------------------------------------------------------------------
| Eval  10 at step     5000 | time:  1.24s | valid loss  3.80 | valid ppl    44.637
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/DP32_666/checkpoint_last.pt
Saving checkpoint to TF32/DP32_666/checkpoint_best.pt
optimal compression parameters = [[], [115, 127, 19, 59, 40, 103, 127, 11, 64, 53], [98, 124, 10, 49, 19, 128, 128, 50, 52, 33], [77, 105, 10, 35, 19, 80, 85, 12, 36, 20], [67, 88, 10, 20, 14, 50, 52, 9, 29, 18], [13, 13, 10, 18, 12, 48, 51, 10, 21, 13], [34, 32, 8, 16, 10, 33, 36, 8, 11, 13], [36, 53, 9, 17, 12, 45, 57, 8, 21, 8], [27, 47, 8, 18, 15, 32, 42, 9, 21, 10], [8]]
| epoch   3 step     5010 | batches    808 / 2101 | lr 9.767e-03 | ms/batch 7505.1 | tok/s    6549 | loss  4.01 | ppl     55.31
| epoch   3 step     5020 | batches    818 / 2101 | lr 9.766e-03 | ms/batch 762.3 | tok/s   64476 | loss  4.00 | ppl     54.82
| epoch   3 step     5030 | batches    828 / 2101 | lr 9.765e-03 | ms/batch 762.3 | tok/s   64476 | loss  4.02 | ppl     55.87
| epoch   3 step     5040 | batches    838 / 2101 | lr 9.764e-03 | ms/batch 763.7 | tok/s   64356 | loss  4.06 | ppl     57.69
| epoch   3 step     5050 | batches    848 / 2101 | lr 9.763e-03 | ms/batch 763.1 | tok/s   64415 | loss  4.05 | ppl     57.34
| epoch   3 step     5060 | batches    858 / 2101 | lr 9.761e-03 | ms/batch 762.7 | tok/s   64447 | loss  4.04 | ppl     56.67
| epoch   3 step     5070 | batches    868 / 2101 | lr 9.760e-03 | ms/batch 763.1 | tok/s   64413 | loss  3.99 | ppl     54.26
| epoch   3 step     5080 | batches    878 / 2101 | lr 9.759e-03 | ms/batch 762.1 | tok/s   64492 | loss  3.97 | ppl     52.73
| epoch   3 step     5090 | batches    888 / 2101 | lr 9.758e-03 | ms/batch 761.6 | tok/s   64542 | loss  4.01 | ppl     54.92
| epoch   3 step     5100 | batches    898 / 2101 | lr 9.757e-03 | ms/batch 761.7 | tok/s   64529 | loss  3.97 | ppl     52.98
| epoch   3 step     5110 | batches    908 / 2101 | lr 9.756e-03 | ms/batch 761.7 | tok/s   64526 | loss  3.97 | ppl     53.07
| epoch   3 step     5120 | batches    918 / 2101 | lr 9.754e-03 | ms/batch 761.9 | tok/s   64509 | loss  3.99 | ppl     54.02
| epoch   3 step     5130 | batches    928 / 2101 | lr 9.753e-03 | ms/batch 761.7 | tok/s   64528 | loss  3.96 | ppl     52.51
| epoch   3 step     5140 | batches    938 / 2101 | lr 9.752e-03 | ms/batch 761.4 | tok/s   64553 | loss  3.95 | ppl     52.05
| epoch   3 step     5150 | batches    948 / 2101 | lr 9.751e-03 | ms/batch 761.6 | tok/s   64539 | loss  3.96 | ppl     52.40
| epoch   3 step     5160 | batches    958 / 2101 | lr 9.750e-03 | ms/batch 762.5 | tok/s   64459 | loss  4.02 | ppl     55.43
| epoch   3 step     5170 | batches    968 / 2101 | lr 9.749e-03 | ms/batch 762.7 | tok/s   64445 | loss  4.00 | ppl     54.82
| epoch   3 step     5180 | batches    978 / 2101 | lr 9.747e-03 | ms/batch 762.5 | tok/s   64462 | loss  4.03 | ppl     56.19
| epoch   3 step     5190 | batches    988 / 2101 | lr 9.746e-03 | ms/batch 762.0 | tok/s   64506 | loss  4.00 | ppl     54.52
| epoch   3 step     5200 | batches    998 / 2101 | lr 9.745e-03 | ms/batch 762.6 | tok/s   64450 | loss  3.99 | ppl     54.04
| epoch   3 step     5210 | batches   1008 / 2101 | lr 9.744e-03 | ms/batch 760.7 | tok/s   64615 | loss  3.98 | ppl     53.55
| epoch   3 step     5220 | batches   1018 / 2101 | lr 9.742e-03 | ms/batch 761.5 | tok/s   64544 | loss  3.99 | ppl     54.03
| epoch   3 step     5230 | batches   1028 / 2101 | lr 9.741e-03 | ms/batch 761.6 | tok/s   64541 | loss  4.00 | ppl     54.62
| epoch   3 step     5240 | batches   1038 / 2101 | lr 9.740e-03 | ms/batch 761.4 | tok/s   64557 | loss  3.96 | ppl     52.20
| epoch   3 step     5250 | batches   1048 / 2101 | lr 9.739e-03 | ms/batch 761.8 | tok/s   64520 | loss  3.95 | ppl     51.92
| epoch   3 step     5260 | batches   1058 / 2101 | lr 9.738e-03 | ms/batch 760.8 | tok/s   64603 | loss  3.97 | ppl     52.83
| epoch   3 step     5270 | batches   1068 / 2101 | lr 9.736e-03 | ms/batch 761.0 | tok/s   64587 | loss  3.95 | ppl     51.73
| epoch   3 step     5280 | batches   1078 / 2101 | lr 9.735e-03 | ms/batch 761.3 | tok/s   64567 | loss  3.99 | ppl     54.05
| epoch   3 step     5290 | batches   1088 / 2101 | lr 9.734e-03 | ms/batch 760.8 | tok/s   64603 | loss  3.99 | ppl     53.88
| epoch   3 step     5300 | batches   1098 / 2101 | lr 9.733e-03 | ms/batch 761.3 | tok/s   64562 | loss  3.97 | ppl     52.88
| epoch   3 step     5310 | batches   1108 / 2101 | lr 9.732e-03 | ms/batch 760.7 | tok/s   64616 | loss  3.95 | ppl     52.04
| epoch   3 step     5320 | batches   1118 / 2101 | lr 9.730e-03 | ms/batch 763.1 | tok/s   64407 | loss  3.95 | ppl     51.70
| epoch   3 step     5330 | batches   1128 / 2101 | lr 9.729e-03 | ms/batch 762.4 | tok/s   64470 | loss  3.95 | ppl     52.04
| epoch   3 step     5340 | batches   1138 / 2101 | lr 9.728e-03 | ms/batch 762.1 | tok/s   64497 | loss  3.99 | ppl     54.14
| epoch   3 step     5350 | batches   1148 / 2101 | lr 9.727e-03 | ms/batch 761.5 | tok/s   64550 | loss  4.01 | ppl     55.15
| epoch   3 step     5360 | batches   1158 / 2101 | lr 9.725e-03 | ms/batch 762.1 | tok/s   64496 | loss  4.00 | ppl     54.52
| epoch   3 step     5370 | batches   1168 / 2101 | lr 9.724e-03 | ms/batch 761.7 | tok/s   64530 | loss  3.97 | ppl     52.87
| epoch   3 step     5380 | batches   1178 / 2101 | lr 9.723e-03 | ms/batch 762.5 | tok/s   64461 | loss  4.04 | ppl     57.11
| epoch   3 step     5390 | batches   1188 / 2101 | lr 9.722e-03 | ms/batch 763.4 | tok/s   64385 | loss  4.01 | ppl     55.08
| epoch   3 step     5400 | batches   1198 / 2101 | lr 9.720e-03 | ms/batch 763.1 | tok/s   64412 | loss  4.00 | ppl     54.64
| epoch   3 step     5410 | batches   1208 / 2101 | lr 9.719e-03 | ms/batch 762.3 | tok/s   64476 | loss  3.97 | ppl     52.75
| epoch   3 step     5420 | batches   1218 / 2101 | lr 9.718e-03 | ms/batch 762.3 | tok/s   64481 | loss  3.99 | ppl     54.17
| epoch   3 step     5430 | batches   1228 / 2101 | lr 9.717e-03 | ms/batch 763.0 | tok/s   64420 | loss  3.99 | ppl     54.06
| epoch   3 step     5440 | batches   1238 / 2101 | lr 9.715e-03 | ms/batch 763.2 | tok/s   64404 | loss  4.00 | ppl     54.36
| epoch   3 step     5450 | batches   1248 / 2101 | lr 9.714e-03 | ms/batch 762.2 | tok/s   64491 | loss  4.05 | ppl     57.16
| epoch   3 step     5460 | batches   1258 / 2101 | lr 9.713e-03 | ms/batch 761.9 | tok/s   64510 | loss  4.00 | ppl     54.73
| epoch   3 step     5470 | batches   1268 / 2101 | lr 9.711e-03 | ms/batch 762.4 | tok/s   64468 | loss  4.00 | ppl     54.51
| epoch   3 step     5480 | batches   1278 / 2101 | lr 9.710e-03 | ms/batch 762.0 | tok/s   64504 | loss  4.00 | ppl     54.83
| epoch   3 step     5490 | batches   1288 / 2101 | lr 9.709e-03 | ms/batch 761.9 | tok/s   64511 | loss  3.94 | ppl     51.64
| epoch   3 step     5500 | batches   1298 / 2101 | lr 9.708e-03 | ms/batch 761.9 | tok/s   64509 | loss  3.97 | ppl     52.87
----------------------------------------------------------------------------------------------------
| Eval  11 at step     5500 | time:  1.24s | valid loss  3.75 | valid ppl    42.691
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/DP32_666/checkpoint_last.pt
Saving checkpoint to TF32/DP32_666/checkpoint_best.pt
| epoch   3 step     5510 | batches   1308 / 2101 | lr 9.706e-03 | ms/batch 762.1 | tok/s   64500 | loss  3.97 | ppl     53.23
| epoch   3 step     5520 | batches   1318 / 2101 | lr 9.705e-03 | ms/batch 761.9 | tok/s   64510 | loss  3.98 | ppl     53.38
| epoch   3 step     5530 | batches   1328 / 2101 | lr 9.704e-03 | ms/batch 760.6 | tok/s   64623 | loss  3.96 | ppl     52.25
| epoch   3 step     5540 | batches   1338 / 2101 | lr 9.702e-03 | ms/batch 761.9 | tok/s   64511 | loss  3.99 | ppl     54.31
| epoch   3 step     5550 | batches   1348 / 2101 | lr 9.701e-03 | ms/batch 762.1 | tok/s   64498 | loss  3.95 | ppl     51.87
| epoch   3 step     5560 | batches   1358 / 2101 | lr 9.700e-03 | ms/batch 762.4 | tok/s   64471 | loss  3.99 | ppl     54.05
| epoch   3 step     5570 | batches   1368 / 2101 | lr 9.699e-03 | ms/batch 760.4 | tok/s   64641 | loss  3.97 | ppl     52.90
| epoch   3 step     5580 | batches   1378 / 2101 | lr 9.697e-03 | ms/batch 761.5 | tok/s   64543 | loss  3.98 | ppl     53.31
| epoch   3 step     5590 | batches   1388 / 2101 | lr 9.696e-03 | ms/batch 763.2 | tok/s   64400 | loss  4.02 | ppl     55.64
| epoch   3 step     5600 | batches   1398 / 2101 | lr 9.695e-03 | ms/batch 762.0 | tok/s   64503 | loss  3.98 | ppl     53.73
| epoch   3 step     5610 | batches   1408 / 2101 | lr 9.693e-03 | ms/batch 762.2 | tok/s   64487 | loss  3.97 | ppl     53.08
| epoch   3 step     5620 | batches   1418 / 2101 | lr 9.692e-03 | ms/batch 761.9 | tok/s   64516 | loss  3.97 | ppl     52.81
| epoch   3 step     5630 | batches   1428 / 2101 | lr 9.691e-03 | ms/batch 762.4 | tok/s   64472 | loss  3.98 | ppl     53.38
| epoch   3 step     5640 | batches   1438 / 2101 | lr 9.689e-03 | ms/batch 761.0 | tok/s   64586 | loss  3.98 | ppl     53.55
| epoch   3 step     5650 | batches   1448 / 2101 | lr 9.688e-03 | ms/batch 762.1 | tok/s   64499 | loss  4.02 | ppl     55.63
| epoch   3 step     5660 | batches   1458 / 2101 | lr 9.687e-03 | ms/batch 761.2 | tok/s   64572 | loss  3.96 | ppl     52.60
| epoch   3 step     5670 | batches   1468 / 2101 | lr 9.685e-03 | ms/batch 760.9 | tok/s   64596 | loss  3.93 | ppl     50.87
| epoch   3 step     5680 | batches   1478 / 2101 | lr 9.684e-03 | ms/batch 761.2 | tok/s   64570 | loss  3.94 | ppl     51.41
| epoch   3 step     5690 | batches   1488 / 2101 | lr 9.683e-03 | ms/batch 762.3 | tok/s   64478 | loss  3.97 | ppl     52.79
| epoch   3 step     5700 | batches   1498 / 2101 | lr 9.681e-03 | ms/batch 762.2 | tok/s   64489 | loss  3.95 | ppl     52.04
| epoch   3 step     5710 | batches   1508 / 2101 | lr 9.680e-03 | ms/batch 761.1 | tok/s   64581 | loss  3.94 | ppl     51.19
| epoch   3 step     5720 | batches   1518 / 2101 | lr 9.679e-03 | ms/batch 760.9 | tok/s   64595 | loss  3.93 | ppl     50.82
| epoch   3 step     5730 | batches   1528 / 2101 | lr 9.677e-03 | ms/batch 760.5 | tok/s   64634 | loss  3.89 | ppl     48.98
| epoch   3 step     5740 | batches   1538 / 2101 | lr 9.676e-03 | ms/batch 760.9 | tok/s   64599 | loss  3.91 | ppl     49.69
| epoch   3 step     5750 | batches   1548 / 2101 | lr 9.675e-03 | ms/batch 761.5 | tok/s   64550 | loss  3.93 | ppl     51.07
| epoch   3 step     5760 | batches   1558 / 2101 | lr 9.673e-03 | ms/batch 761.4 | tok/s   64552 | loss  3.96 | ppl     52.68
| epoch   3 step     5770 | batches   1568 / 2101 | lr 9.672e-03 | ms/batch 762.2 | tok/s   64483 | loss  3.99 | ppl     53.89
| epoch   3 step     5780 | batches   1578 / 2101 | lr 9.671e-03 | ms/batch 762.1 | tok/s   64495 | loss  3.96 | ppl     52.32
| epoch   3 step     5790 | batches   1588 / 2101 | lr 9.669e-03 | ms/batch 761.6 | tok/s   64538 | loss  3.95 | ppl     51.97
| epoch   3 step     5800 | batches   1598 / 2101 | lr 9.668e-03 | ms/batch 762.0 | tok/s   64506 | loss  4.01 | ppl     54.98
| epoch   3 step     5810 | batches   1608 / 2101 | lr 9.666e-03 | ms/batch 762.6 | tok/s   64450 | loss  3.99 | ppl     54.19
| epoch   3 step     5820 | batches   1618 / 2101 | lr 9.665e-03 | ms/batch 763.1 | tok/s   64412 | loss  3.99 | ppl     54.31
| epoch   3 step     5830 | batches   1628 / 2101 | lr 9.664e-03 | ms/batch 761.8 | tok/s   64519 | loss  4.00 | ppl     54.71
| epoch   3 step     5840 | batches   1638 / 2101 | lr 9.662e-03 | ms/batch 761.2 | tok/s   64571 | loss  3.97 | ppl     53.19
| epoch   3 step     5850 | batches   1648 / 2101 | lr 9.661e-03 | ms/batch 761.4 | tok/s   64558 | loss  3.94 | ppl     51.20
| epoch   3 step     5860 | batches   1658 / 2101 | lr 9.660e-03 | ms/batch 761.9 | tok/s   64515 | loss  3.92 | ppl     50.47
| epoch   3 step     5870 | batches   1668 / 2101 | lr 9.658e-03 | ms/batch 762.4 | tok/s   64471 | loss  3.93 | ppl     50.92
| epoch   3 step     5880 | batches   1678 / 2101 | lr 9.657e-03 | ms/batch 762.4 | tok/s   64474 | loss  3.94 | ppl     51.61
| epoch   3 step     5890 | batches   1688 / 2101 | lr 9.655e-03 | ms/batch 762.2 | tok/s   64489 | loss  3.97 | ppl     52.79
| epoch   3 step     5900 | batches   1698 / 2101 | lr 9.654e-03 | ms/batch 761.8 | tok/s   64525 | loss  3.98 | ppl     53.75
| epoch   3 step     5910 | batches   1708 / 2101 | lr 9.653e-03 | ms/batch 762.7 | tok/s   64449 | loss  3.96 | ppl     52.62
| epoch   3 step     5920 | batches   1718 / 2101 | lr 9.651e-03 | ms/batch 761.1 | tok/s   64578 | loss  3.96 | ppl     52.60
| epoch   3 step     5930 | batches   1728 / 2101 | lr 9.650e-03 | ms/batch 761.2 | tok/s   64575 | loss  3.98 | ppl     53.46
| epoch   3 step     5940 | batches   1738 / 2101 | lr 9.648e-03 | ms/batch 761.3 | tok/s   64567 | loss  4.00 | ppl     54.41
| epoch   3 step     5950 | batches   1748 / 2101 | lr 9.647e-03 | ms/batch 761.0 | tok/s   64589 | loss  3.99 | ppl     54.03
| epoch   3 step     5960 | batches   1758 / 2101 | lr 9.646e-03 | ms/batch 760.9 | tok/s   64594 | loss  3.96 | ppl     52.45
| epoch   3 step     5970 | batches   1768 / 2101 | lr 9.644e-03 | ms/batch 762.2 | tok/s   64484 | loss  3.92 | ppl     50.45
| epoch   3 step     5980 | batches   1778 / 2101 | lr 9.643e-03 | ms/batch 761.2 | tok/s   64570 | loss  3.97 | ppl     52.74
| epoch   3 step     5990 | batches   1788 / 2101 | lr 9.641e-03 | ms/batch 761.1 | tok/s   64583 | loss  3.91 | ppl     50.14
| epoch   3 step     6000 | batches   1798 / 2101 | lr 9.640e-03 | ms/batch 763.3 | tok/s   64398 | loss  3.90 | ppl     49.36
----------------------------------------------------------------------------------------------------
| Eval  12 at step     6000 | time:  1.24s | valid loss  3.72 | valid ppl    41.246
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/DP32_666/checkpoint_last.pt
Saving checkpoint to TF32/DP32_666/checkpoint_best.pt
optimal compression parameters = [[], [115, 126, 20, 61, 45, 105, 124, 11, 63, 60], [101, 121, 10, 42, 24, 125, 127, 50, 48, 32], [83, 107, 10, 28, 18, 86, 90, 14, 29, 21], [70, 98, 10, 19, 15, 59, 60, 9, 18, 17], [15, 11, 8, 16, 12, 50, 52, 11, 20, 9], [34, 36, 8, 17, 12, 37, 40, 8, 12, 9], [40, 59, 9, 12, 11, 43, 61, 8, 16, 11], [28, 52, 9, 16, 15, 35, 50, 8, 19, 11], [8]]
| epoch   3 step     6010 | batches   1808 / 2101 | lr 9.638e-03 | ms/batch 7520.2 | tok/s    6536 | loss  3.91 | ppl     50.13
| epoch   3 step     6020 | batches   1818 / 2101 | lr 9.637e-03 | ms/batch 763.0 | tok/s   64417 | loss  3.92 | ppl     50.51
| epoch   3 step     6030 | batches   1828 / 2101 | lr 9.636e-03 | ms/batch 762.5 | tok/s   64465 | loss  3.96 | ppl     52.40
| epoch   3 step     6040 | batches   1838 / 2101 | lr 9.634e-03 | ms/batch 762.6 | tok/s   64454 | loss  3.94 | ppl     51.18
| epoch   3 step     6050 | batches   1848 / 2101 | lr 9.633e-03 | ms/batch 762.5 | tok/s   64460 | loss  3.92 | ppl     50.39
| epoch   3 step     6060 | batches   1858 / 2101 | lr 9.631e-03 | ms/batch 762.9 | tok/s   64429 | loss  3.90 | ppl     49.26
| epoch   3 step     6070 | batches   1868 / 2101 | lr 9.630e-03 | ms/batch 763.9 | tok/s   64340 | loss  3.92 | ppl     50.32
| epoch   3 step     6080 | batches   1878 / 2101 | lr 9.628e-03 | ms/batch 763.2 | tok/s   64404 | loss  3.93 | ppl     51.10
| epoch   3 step     6090 | batches   1888 / 2101 | lr 9.627e-03 | ms/batch 762.5 | tok/s   64458 | loss  3.93 | ppl     50.80
| epoch   3 step     6100 | batches   1898 / 2101 | lr 9.626e-03 | ms/batch 763.4 | tok/s   64384 | loss  3.98 | ppl     53.27
| epoch   3 step     6110 | batches   1908 / 2101 | lr 9.624e-03 | ms/batch 764.5 | tok/s   64294 | loss  3.98 | ppl     53.68
| epoch   3 step     6120 | batches   1918 / 2101 | lr 9.623e-03 | ms/batch 762.1 | tok/s   64491 | loss  3.93 | ppl     51.09
| epoch   3 step     6130 | batches   1928 / 2101 | lr 9.621e-03 | ms/batch 762.7 | tok/s   64446 | loss  3.95 | ppl     51.92
| epoch   3 step     6140 | batches   1938 / 2101 | lr 9.620e-03 | ms/batch 762.4 | tok/s   64470 | loss  3.95 | ppl     51.86
| epoch   3 step     6150 | batches   1948 / 2101 | lr 9.618e-03 | ms/batch 762.0 | tok/s   64507 | loss  3.96 | ppl     52.55
| epoch   3 step     6160 | batches   1958 / 2101 | lr 9.617e-03 | ms/batch 762.8 | tok/s   64439 | loss  3.97 | ppl     52.73
| epoch   3 step     6170 | batches   1968 / 2101 | lr 9.615e-03 | ms/batch 763.7 | tok/s   64361 | loss  3.95 | ppl     52.13
| epoch   3 step     6180 | batches   1978 / 2101 | lr 9.614e-03 | ms/batch 763.0 | tok/s   64421 | loss  3.89 | ppl     49.05
| epoch   3 step     6190 | batches   1988 / 2101 | lr 9.612e-03 | ms/batch 763.0 | tok/s   64420 | loss  3.89 | ppl     48.87
| epoch   3 step     6200 | batches   1998 / 2101 | lr 9.611e-03 | ms/batch 762.5 | tok/s   64461 | loss  3.88 | ppl     48.62
| epoch   3 step     6210 | batches   2008 / 2101 | lr 9.609e-03 | ms/batch 761.8 | tok/s   64520 | loss  3.92 | ppl     50.36
| epoch   3 step     6220 | batches   2018 / 2101 | lr 9.608e-03 | ms/batch 762.2 | tok/s   64490 | loss  3.96 | ppl     52.62
| epoch   3 step     6230 | batches   2028 / 2101 | lr 9.607e-03 | ms/batch 763.1 | tok/s   64409 | loss  3.94 | ppl     51.20
| epoch   3 step     6240 | batches   2038 / 2101 | lr 9.605e-03 | ms/batch 763.8 | tok/s   64354 | loss  3.93 | ppl     50.68
| epoch   3 step     6250 | batches   2048 / 2101 | lr 9.604e-03 | ms/batch 762.4 | tok/s   64469 | loss  3.94 | ppl     51.21
| epoch   3 step     6260 | batches   2058 / 2101 | lr 9.602e-03 | ms/batch 762.3 | tok/s   64475 | loss  3.93 | ppl     51.12
| epoch   3 step     6270 | batches   2068 / 2101 | lr 9.601e-03 | ms/batch 761.4 | tok/s   64555 | loss  3.96 | ppl     52.54
| epoch   3 step     6280 | batches   2078 / 2101 | lr 9.599e-03 | ms/batch 761.8 | tok/s   64517 | loss  3.93 | ppl     51.09
| epoch   3 step     6290 | batches   2088 / 2101 | lr 9.598e-03 | ms/batch 763.3 | tok/s   64396 | loss  3.90 | ppl     49.56
| epoch   3 step     6300 | batches   2098 / 2101 | lr 9.596e-03 | ms/batch 761.8 | tok/s   64522 | loss  3.88 | ppl     48.32
| epoch   4 step     6310 | batches      7 / 2101 | lr 9.595e-03 | ms/batch 763.7 | tok/s   64372 | loss  3.95 | ppl     52.02
| epoch   4 step     6320 | batches     17 / 2101 | lr 9.593e-03 | ms/batch 761.8 | tok/s   64524 | loss  3.89 | ppl     48.88
| epoch   4 step     6330 | batches     27 / 2101 | lr 9.592e-03 | ms/batch 762.2 | tok/s   64490 | loss  3.86 | ppl     47.36
| epoch   4 step     6340 | batches     37 / 2101 | lr 9.590e-03 | ms/batch 761.7 | tok/s   64529 | loss  3.84 | ppl     46.57
| epoch   4 step     6350 | batches     47 / 2101 | lr 9.589e-03 | ms/batch 762.4 | tok/s   64470 | loss  3.81 | ppl     45.02
| epoch   4 step     6360 | batches     57 / 2101 | lr 9.587e-03 | ms/batch 761.6 | tok/s   64537 | loss  3.81 | ppl     44.99
| epoch   4 step     6370 | batches     67 / 2101 | lr 9.586e-03 | ms/batch 762.2 | tok/s   64491 | loss  3.81 | ppl     45.08
| epoch   4 step     6380 | batches     77 / 2101 | lr 9.584e-03 | ms/batch 763.6 | tok/s   64373 | loss  3.84 | ppl     46.73
| epoch   4 step     6390 | batches     87 / 2101 | lr 9.582e-03 | ms/batch 762.9 | tok/s   64429 | loss  3.85 | ppl     46.86
| epoch   4 step     6400 | batches     97 / 2101 | lr 9.581e-03 | ms/batch 762.4 | tok/s   64469 | loss  3.84 | ppl     46.52
| epoch   4 step     6410 | batches    107 / 2101 | lr 9.579e-03 | ms/batch 763.0 | tok/s   64417 | loss  3.82 | ppl     45.66
| epoch   4 step     6420 | batches    117 / 2101 | lr 9.578e-03 | ms/batch 764.5 | tok/s   64295 | loss  3.86 | ppl     47.29
| epoch   4 step     6430 | batches    127 / 2101 | lr 9.576e-03 | ms/batch 763.4 | tok/s   64389 | loss  3.87 | ppl     47.92
| epoch   4 step     6440 | batches    137 / 2101 | lr 9.575e-03 | ms/batch 763.6 | tok/s   64372 | loss  3.85 | ppl     47.10
| epoch   4 step     6450 | batches    147 / 2101 | lr 9.573e-03 | ms/batch 763.6 | tok/s   64371 | loss  3.81 | ppl     45.05
| epoch   4 step     6460 | batches    157 / 2101 | lr 9.572e-03 | ms/batch 763.2 | tok/s   64401 | loss  3.86 | ppl     47.27
| epoch   4 step     6470 | batches    167 / 2101 | lr 9.570e-03 | ms/batch 762.1 | tok/s   64494 | loss  3.86 | ppl     47.43
| epoch   4 step     6480 | batches    177 / 2101 | lr 9.569e-03 | ms/batch 761.8 | tok/s   64523 | loss  3.90 | ppl     49.31
| epoch   4 step     6490 | batches    187 / 2101 | lr 9.567e-03 | ms/batch 761.5 | tok/s   64546 | loss  3.89 | ppl     49.02
| epoch   4 step     6500 | batches    197 / 2101 | lr 9.566e-03 | ms/batch 762.2 | tok/s   64489 | loss  3.83 | ppl     46.27
----------------------------------------------------------------------------------------------------
| Eval  13 at step     6500 | time:  1.24s | valid loss  3.68 | valid ppl    39.600
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/DP32_666/checkpoint_last.pt
Saving checkpoint to TF32/DP32_666/checkpoint_best.pt
| epoch   4 step     6510 | batches    207 / 2101 | lr 9.564e-03 | ms/batch 763.5 | tok/s   64376 | loss  3.84 | ppl     46.33
| epoch   4 step     6520 | batches    217 / 2101 | lr 9.562e-03 | ms/batch 763.9 | tok/s   64347 | loss  3.86 | ppl     47.56
| epoch   4 step     6530 | batches    227 / 2101 | lr 9.561e-03 | ms/batch 762.8 | tok/s   64440 | loss  3.85 | ppl     46.90
| epoch   4 step     6540 | batches    237 / 2101 | lr 9.559e-03 | ms/batch 763.3 | tok/s   64396 | loss  3.87 | ppl     48.02
| epoch   4 step     6550 | batches    247 / 2101 | lr 9.558e-03 | ms/batch 762.0 | tok/s   64507 | loss  3.87 | ppl     48.00
| epoch   4 step     6560 | batches    257 / 2101 | lr 9.556e-03 | ms/batch 761.5 | tok/s   64547 | loss  3.84 | ppl     46.71
| epoch   4 step     6570 | batches    267 / 2101 | lr 9.555e-03 | ms/batch 762.5 | tok/s   64463 | loss  3.84 | ppl     46.31
| epoch   4 step     6580 | batches    277 / 2101 | lr 9.553e-03 | ms/batch 761.0 | tok/s   64586 | loss  3.86 | ppl     47.33
| epoch   4 step     6590 | batches    287 / 2101 | lr 9.551e-03 | ms/batch 762.0 | tok/s   64506 | loss  3.85 | ppl     46.83
| epoch   4 step     6600 | batches    297 / 2101 | lr 9.550e-03 | ms/batch 763.4 | tok/s   64390 | loss  3.84 | ppl     46.45
| epoch   4 step     6610 | batches    307 / 2101 | lr 9.548e-03 | ms/batch 763.1 | tok/s   64407 | loss  3.84 | ppl     46.57
| epoch   4 step     6620 | batches    317 / 2101 | lr 9.547e-03 | ms/batch 763.0 | tok/s   64423 | loss  3.84 | ppl     46.44
| epoch   4 step     6630 | batches    327 / 2101 | lr 9.545e-03 | ms/batch 761.8 | tok/s   64518 | loss  3.83 | ppl     45.97
| epoch   4 step     6640 | batches    337 / 2101 | lr 9.544e-03 | ms/batch 761.3 | tok/s   64566 | loss  3.89 | ppl     49.10
| epoch   4 step     6650 | batches    347 / 2101 | lr 9.542e-03 | ms/batch 762.1 | tok/s   64492 | loss  3.89 | ppl     48.76
| epoch   4 step     6660 | batches    357 / 2101 | lr 9.540e-03 | ms/batch 761.3 | tok/s   64567 | loss  3.89 | ppl     48.81
| epoch   4 step     6670 | batches    367 / 2101 | lr 9.539e-03 | ms/batch 761.1 | tok/s   64581 | loss  3.86 | ppl     47.67
| epoch   4 step     6680 | batches    377 / 2101 | lr 9.537e-03 | ms/batch 762.6 | tok/s   64451 | loss  3.87 | ppl     48.01
| epoch   4 step     6690 | batches    387 / 2101 | lr 9.536e-03 | ms/batch 763.8 | tok/s   64355 | loss  3.84 | ppl     46.56
| epoch   4 step     6700 | batches    397 / 2101 | lr 9.534e-03 | ms/batch 762.2 | tok/s   64485 | loss  3.79 | ppl     44.16
| epoch   4 step     6710 | batches    407 / 2101 | lr 9.532e-03 | ms/batch 763.4 | tok/s   64387 | loss  3.80 | ppl     44.73
| epoch   4 step     6720 | batches    417 / 2101 | lr 9.531e-03 | ms/batch 762.0 | tok/s   64506 | loss  3.85 | ppl     46.88
| epoch   4 step     6730 | batches    427 / 2101 | lr 9.529e-03 | ms/batch 762.1 | tok/s   64498 | loss  3.83 | ppl     46.18
| epoch   4 step     6740 | batches    437 / 2101 | lr 9.527e-03 | ms/batch 763.7 | tok/s   64358 | loss  3.85 | ppl     47.19
| epoch   4 step     6750 | batches    447 / 2101 | lr 9.526e-03 | ms/batch 763.0 | tok/s   64416 | loss  3.87 | ppl     47.92
| epoch   4 step     6760 | batches    457 / 2101 | lr 9.524e-03 | ms/batch 763.6 | tok/s   64372 | loss  3.85 | ppl     46.83
| epoch   4 step     6770 | batches    467 / 2101 | lr 9.523e-03 | ms/batch 762.8 | tok/s   64441 | loss  3.85 | ppl     47.09
| epoch   4 step     6780 | batches    477 / 2101 | lr 9.521e-03 | ms/batch 762.8 | tok/s   64438 | loss  3.86 | ppl     47.50
| epoch   4 step     6790 | batches    487 / 2101 | lr 9.519e-03 | ms/batch 763.1 | tok/s   64413 | loss  3.86 | ppl     47.67
| epoch   4 step     6800 | batches    497 / 2101 | lr 9.518e-03 | ms/batch 762.8 | tok/s   64433 | loss  3.88 | ppl     48.59
| epoch   4 step     6810 | batches    507 / 2101 | lr 9.516e-03 | ms/batch 762.5 | tok/s   64459 | loss  3.85 | ppl     46.88
| epoch   4 step     6820 | batches    517 / 2101 | lr 9.514e-03 | ms/batch 761.8 | tok/s   64519 | loss  3.87 | ppl     47.90
| epoch   4 step     6830 | batches    527 / 2101 | lr 9.513e-03 | ms/batch 763.5 | tok/s   64374 | loss  3.81 | ppl     45.30
| epoch   4 step     6840 | batches    537 / 2101 | lr 9.511e-03 | ms/batch 763.8 | tok/s   64354 | loss  3.84 | ppl     46.70
| epoch   4 step     6850 | batches    547 / 2101 | lr 9.510e-03 | ms/batch 763.1 | tok/s   64411 | loss  3.80 | ppl     44.73
| epoch   4 step     6860 | batches    557 / 2101 | lr 9.508e-03 | ms/batch 761.9 | tok/s   64511 | loss  3.81 | ppl     45.36
| epoch   4 step     6870 | batches    567 / 2101 | lr 9.506e-03 | ms/batch 762.3 | tok/s   64475 | loss  3.83 | ppl     45.95
| epoch   4 step     6880 | batches    577 / 2101 | lr 9.505e-03 | ms/batch 763.0 | tok/s   64423 | loss  3.84 | ppl     46.65
| epoch   4 step     6890 | batches    587 / 2101 | lr 9.503e-03 | ms/batch 763.2 | tok/s   64400 | loss  3.87 | ppl     47.74
| epoch   4 step     6900 | batches    597 / 2101 | lr 9.501e-03 | ms/batch 761.3 | tok/s   64564 | loss  3.85 | ppl     46.96
| epoch   4 step     6910 | batches    607 / 2101 | lr 9.500e-03 | ms/batch 762.1 | tok/s   64498 | loss  3.83 | ppl     46.05
| epoch   4 step     6920 | batches    617 / 2101 | lr 9.498e-03 | ms/batch 760.8 | tok/s   64610 | loss  3.80 | ppl     44.86
| epoch   4 step     6930 | batches    627 / 2101 | lr 9.496e-03 | ms/batch 761.5 | tok/s   64546 | loss  3.78 | ppl     43.98
| epoch   4 step     6940 | batches    637 / 2101 | lr 9.495e-03 | ms/batch 761.3 | tok/s   64563 | loss  3.84 | ppl     46.72
| epoch   4 step     6950 | batches    647 / 2101 | lr 9.493e-03 | ms/batch 762.6 | tok/s   64454 | loss  3.90 | ppl     49.64
| epoch   4 step     6960 | batches    657 / 2101 | lr 9.491e-03 | ms/batch 762.8 | tok/s   64437 | loss  3.88 | ppl     48.31
| epoch   4 step     6970 | batches    667 / 2101 | lr 9.490e-03 | ms/batch 762.9 | tok/s   64424 | loss  3.87 | ppl     47.76
| epoch   4 step     6980 | batches    677 / 2101 | lr 9.488e-03 | ms/batch 763.3 | tok/s   64396 | loss  3.84 | ppl     46.53
| epoch   4 step     6990 | batches    687 / 2101 | lr 9.486e-03 | ms/batch 763.6 | tok/s   64367 | loss  3.87 | ppl     47.91
| epoch   4 step     7000 | batches    697 / 2101 | lr 9.485e-03 | ms/batch 763.9 | tok/s   64348 | loss  3.86 | ppl     47.27
----------------------------------------------------------------------------------------------------
| Eval  14 at step     7000 | time:  1.24s | valid loss  3.65 | valid ppl    38.604
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/DP32_666/checkpoint_last.pt
Saving checkpoint to TF32/DP32_666/checkpoint_best.pt
optimal compression parameters = [[], [119, 127, 20, 58, 39, 112, 128, 13, 62, 60], [112, 126, 10, 45, 25, 128, 125, 46, 51, 32], [85, 115, 10, 30, 14, 87, 98, 15, 35, 20], [75, 94, 9, 23, 14, 54, 61, 9, 24, 15], [14, 9, 8, 17, 10, 51, 52, 10, 15, 11], [32, 42, 9, 9, 10, 36, 43, 8, 10, 9], [42, 55, 8, 10, 10, 49, 56, 8, 16, 10], [34, 57, 9, 12, 12, 36, 44, 8, 16, 8], [8]]
| epoch   4 step     7010 | batches    707 / 2101 | lr 9.483e-03 | ms/batch 7516.0 | tok/s    6540 | loss  3.84 | ppl     46.71
| epoch   4 step     7020 | batches    717 / 2101 | lr 9.481e-03 | ms/batch 762.1 | tok/s   64496 | loss  3.83 | ppl     46.22
| epoch   4 step     7030 | batches    727 / 2101 | lr 9.479e-03 | ms/batch 764.2 | tok/s   64316 | loss  3.87 | ppl     47.87
| epoch   4 step     7040 | batches    737 / 2101 | lr 9.478e-03 | ms/batch 764.0 | tok/s   64336 | loss  3.88 | ppl     48.49
| epoch   4 step     7050 | batches    747 / 2101 | lr 9.476e-03 | ms/batch 765.3 | tok/s   64226 | loss  3.89 | ppl     49.15
| epoch   4 step     7060 | batches    757 / 2101 | lr 9.474e-03 | ms/batch 763.6 | tok/s   64368 | loss  3.85 | ppl     46.93
| epoch   4 step     7070 | batches    767 / 2101 | lr 9.473e-03 | ms/batch 763.7 | tok/s   64364 | loss  3.87 | ppl     48.10
| epoch   4 step     7080 | batches    777 / 2101 | lr 9.471e-03 | ms/batch 762.4 | tok/s   64470 | loss  3.85 | ppl     47.07
| epoch   4 step     7090 | batches    787 / 2101 | lr 9.469e-03 | ms/batch 763.3 | tok/s   64393 | loss  3.83 | ppl     45.89
| epoch   4 step     7100 | batches    797 / 2101 | lr 9.468e-03 | ms/batch 763.5 | tok/s   64375 | loss  3.85 | ppl     47.00
| epoch   4 step     7110 | batches    807 / 2101 | lr 9.466e-03 | ms/batch 763.6 | tok/s   64368 | loss  3.84 | ppl     46.73
| epoch   4 step     7120 | batches    817 / 2101 | lr 9.464e-03 | ms/batch 762.4 | tok/s   64469 | loss  3.85 | ppl     47.07
| epoch   4 step     7130 | batches    827 / 2101 | lr 9.462e-03 | ms/batch 763.3 | tok/s   64394 | loss  3.84 | ppl     46.66
| epoch   4 step     7140 | batches    837 / 2101 | lr 9.461e-03 | ms/batch 761.6 | tok/s   64542 | loss  3.82 | ppl     45.64
| epoch   4 step     7150 | batches    847 / 2101 | lr 9.459e-03 | ms/batch 762.4 | tok/s   64471 | loss  3.84 | ppl     46.40
| epoch   4 step     7160 | batches    857 / 2101 | lr 9.457e-03 | ms/batch 761.6 | tok/s   64536 | loss  3.80 | ppl     44.76
| epoch   4 step     7170 | batches    867 / 2101 | lr 9.456e-03 | ms/batch 762.6 | tok/s   64451 | loss  3.85 | ppl     46.78
| epoch   4 step     7180 | batches    877 / 2101 | lr 9.454e-03 | ms/batch 762.5 | tok/s   64464 | loss  3.81 | ppl     45.25
| epoch   4 step     7190 | batches    887 / 2101 | lr 9.452e-03 | ms/batch 762.5 | tok/s   64460 | loss  3.82 | ppl     45.78
| epoch   4 step     7200 | batches    897 / 2101 | lr 9.450e-03 | ms/batch 763.9 | tok/s   64348 | loss  3.86 | ppl     47.67
| epoch   4 step     7210 | batches    907 / 2101 | lr 9.449e-03 | ms/batch 763.4 | tok/s   64384 | loss  3.84 | ppl     46.73
| epoch   4 step     7220 | batches    917 / 2101 | lr 9.447e-03 | ms/batch 763.3 | tok/s   64392 | loss  3.80 | ppl     44.68
| epoch   4 step     7230 | batches    927 / 2101 | lr 9.445e-03 | ms/batch 764.1 | tok/s   64328 | loss  3.84 | ppl     46.61
| epoch   4 step     7240 | batches    937 / 2101 | lr 9.443e-03 | ms/batch 764.3 | tok/s   64309 | loss  3.84 | ppl     46.51
| epoch   4 step     7250 | batches    947 / 2101 | lr 9.442e-03 | ms/batch 762.2 | tok/s   64488 | loss  3.79 | ppl     44.16
| epoch   4 step     7260 | batches    957 / 2101 | lr 9.440e-03 | ms/batch 762.5 | tok/s   64466 | loss  3.81 | ppl     45.06
| epoch   4 step     7270 | batches    967 / 2101 | lr 9.438e-03 | ms/batch 761.6 | tok/s   64540 | loss  3.82 | ppl     45.39
| epoch   4 step     7280 | batches    977 / 2101 | lr 9.436e-03 | ms/batch 762.7 | tok/s   64446 | loss  3.82 | ppl     45.60
| epoch   4 step     7290 | batches    987 / 2101 | lr 9.435e-03 | ms/batch 761.8 | tok/s   64519 | loss  3.83 | ppl     45.86
| epoch   4 step     7300 | batches    997 / 2101 | lr 9.433e-03 | ms/batch 762.7 | tok/s   64447 | loss  3.85 | ppl     46.83
| epoch   4 step     7310 | batches   1007 / 2101 | lr 9.431e-03 | ms/batch 761.7 | tok/s   64528 | loss  3.86 | ppl     47.58
| epoch   4 step     7320 | batches   1017 / 2101 | lr 9.429e-03 | ms/batch 762.6 | tok/s   64450 | loss  3.82 | ppl     45.48
| epoch   4 step     7330 | batches   1027 / 2101 | lr 9.428e-03 | ms/batch 761.1 | tok/s   64583 | loss  3.80 | ppl     44.88
| epoch   4 step     7340 | batches   1037 / 2101 | lr 9.426e-03 | ms/batch 761.7 | tok/s   64533 | loss  3.85 | ppl     46.82
| epoch   4 step     7350 | batches   1047 / 2101 | lr 9.424e-03 | ms/batch 761.7 | tok/s   64525 | loss  3.88 | ppl     48.42
| epoch   4 step     7360 | batches   1057 / 2101 | lr 9.422e-03 | ms/batch 762.8 | tok/s   64438 | loss  3.88 | ppl     48.20
| epoch   4 step     7370 | batches   1067 / 2101 | lr 9.420e-03 | ms/batch 763.3 | tok/s   64394 | loss  3.85 | ppl     47.14
| epoch   4 step     7380 | batches   1077 / 2101 | lr 9.419e-03 | ms/batch 763.1 | tok/s   64412 | loss  3.83 | ppl     46.16
| epoch   4 step     7390 | batches   1087 / 2101 | lr 9.417e-03 | ms/batch 762.6 | tok/s   64450 | loss  3.85 | ppl     47.07
| epoch   4 step     7400 | batches   1097 / 2101 | lr 9.415e-03 | ms/batch 762.0 | tok/s   64503 | loss  3.85 | ppl     47.11
| epoch   4 step     7410 | batches   1107 / 2101 | lr 9.413e-03 | ms/batch 760.7 | tok/s   64611 | loss  3.77 | ppl     43.50
| epoch   4 step     7420 | batches   1117 / 2101 | lr 9.412e-03 | ms/batch 760.3 | tok/s   64650 | loss  3.77 | ppl     43.30
| epoch   4 step     7430 | batches   1127 / 2101 | lr 9.410e-03 | ms/batch 761.2 | tok/s   64571 | loss  3.81 | ppl     45.19
| epoch   4 step     7440 | batches   1137 / 2101 | lr 9.408e-03 | ms/batch 762.6 | tok/s   64455 | loss  3.82 | ppl     45.39
| epoch   4 step     7450 | batches   1147 / 2101 | lr 9.406e-03 | ms/batch 763.3 | tok/s   64392 | loss  3.83 | ppl     46.23
| epoch   4 step     7460 | batches   1157 / 2101 | lr 9.404e-03 | ms/batch 763.6 | tok/s   64366 | loss  3.81 | ppl     44.94
| epoch   4 step     7470 | batches   1167 / 2101 | lr 9.403e-03 | ms/batch 764.4 | tok/s   64306 | loss  3.82 | ppl     45.44
| epoch   4 step     7480 | batches   1177 / 2101 | lr 9.401e-03 | ms/batch 764.0 | tok/s   64333 | loss  3.83 | ppl     45.95
| epoch   4 step     7490 | batches   1187 / 2101 | lr 9.399e-03 | ms/batch 762.9 | tok/s   64428 | loss  3.82 | ppl     45.60
| epoch   4 step     7500 | batches   1197 / 2101 | lr 9.397e-03 | ms/batch 762.8 | tok/s   64433 | loss  3.82 | ppl     45.61
----------------------------------------------------------------------------------------------------
| Eval  15 at step     7500 | time:  1.24s | valid loss  3.62 | valid ppl    37.443
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/DP32_666/checkpoint_last.pt
Saving checkpoint to TF32/DP32_666/checkpoint_best.pt
| epoch   4 step     7510 | batches   1207 / 2101 | lr 9.395e-03 | ms/batch 763.5 | tok/s   64376 | loss  3.84 | ppl     46.64
| epoch   4 step     7520 | batches   1217 / 2101 | lr 9.393e-03 | ms/batch 763.8 | tok/s   64355 | loss  3.88 | ppl     48.27
| epoch   4 step     7530 | batches   1227 / 2101 | lr 9.392e-03 | ms/batch 764.0 | tok/s   64334 | loss  3.87 | ppl     47.82
| epoch   4 step     7540 | batches   1237 / 2101 | lr 9.390e-03 | ms/batch 763.9 | tok/s   64346 | loss  3.85 | ppl     47.21
| epoch   4 step     7550 | batches   1247 / 2101 | lr 9.388e-03 | ms/batch 762.5 | tok/s   64459 | loss  3.84 | ppl     46.62
| epoch   4 step     7560 | batches   1257 / 2101 | lr 9.386e-03 | ms/batch 762.7 | tok/s   64448 | loss  3.81 | ppl     44.97
| epoch   4 step     7570 | batches   1267 / 2101 | lr 9.384e-03 | ms/batch 762.0 | tok/s   64501 | loss  3.81 | ppl     45.28
| epoch   4 step     7580 | batches   1277 / 2101 | lr 9.383e-03 | ms/batch 762.0 | tok/s   64505 | loss  3.82 | ppl     45.73
| epoch   4 step     7590 | batches   1287 / 2101 | lr 9.381e-03 | ms/batch 763.1 | tok/s   64414 | loss  3.83 | ppl     46.22
| epoch   4 step     7600 | batches   1297 / 2101 | lr 9.379e-03 | ms/batch 762.5 | tok/s   64465 | loss  3.80 | ppl     44.80
| epoch   4 step     7610 | batches   1307 / 2101 | lr 9.377e-03 | ms/batch 761.7 | tok/s   64533 | loss  3.80 | ppl     44.77
| epoch   4 step     7620 | batches   1317 / 2101 | lr 9.375e-03 | ms/batch 762.1 | tok/s   64499 | loss  3.77 | ppl     43.46
| epoch   4 step     7630 | batches   1327 / 2101 | lr 9.373e-03 | ms/batch 761.4 | tok/s   64554 | loss  3.77 | ppl     43.43
| epoch   4 step     7640 | batches   1337 / 2101 | lr 9.371e-03 | ms/batch 762.6 | tok/s   64453 | loss  3.76 | ppl     42.92
| epoch   4 step     7650 | batches   1347 / 2101 | lr 9.370e-03 | ms/batch 762.1 | tok/s   64492 | loss  3.80 | ppl     44.66
| epoch   4 step     7660 | batches   1357 / 2101 | lr 9.368e-03 | ms/batch 762.2 | tok/s   64486 | loss  3.84 | ppl     46.65
| epoch   4 step     7670 | batches   1367 / 2101 | lr 9.366e-03 | ms/batch 763.4 | tok/s   64387 | loss  3.83 | ppl     46.03
| epoch   4 step     7680 | batches   1377 / 2101 | lr 9.364e-03 | ms/batch 762.3 | tok/s   64480 | loss  3.82 | ppl     45.47
| epoch   4 step     7690 | batches   1387 / 2101 | lr 9.362e-03 | ms/batch 762.2 | tok/s   64491 | loss  3.81 | ppl     45.05
| epoch   4 step     7700 | batches   1397 / 2101 | lr 9.360e-03 | ms/batch 762.0 | tok/s   64508 | loss  3.82 | ppl     45.63
| epoch   4 step     7710 | batches   1407 / 2101 | lr 9.358e-03 | ms/batch 762.6 | tok/s   64454 | loss  3.81 | ppl     45.05
| epoch   4 step     7720 | batches   1417 / 2101 | lr 9.357e-03 | ms/batch 764.1 | tok/s   64330 | loss  3.84 | ppl     46.52
| epoch   4 step     7730 | batches   1427 / 2101 | lr 9.355e-03 | ms/batch 762.8 | tok/s   64439 | loss  3.83 | ppl     46.24
| epoch   4 step     7740 | batches   1437 / 2101 | lr 9.353e-03 | ms/batch 762.9 | tok/s   64428 | loss  3.82 | ppl     45.82
| epoch   4 step     7750 | batches   1447 / 2101 | lr 9.351e-03 | ms/batch 763.4 | tok/s   64387 | loss  3.77 | ppl     43.54
| epoch   4 step     7760 | batches   1457 / 2101 | lr 9.349e-03 | ms/batch 764.2 | tok/s   64320 | loss  3.80 | ppl     44.76
| epoch   4 step     7770 | batches   1467 / 2101 | lr 9.347e-03 | ms/batch 763.8 | tok/s   64349 | loss  3.82 | ppl     45.79
| epoch   4 step     7780 | batches   1477 / 2101 | lr 9.345e-03 | ms/batch 761.6 | tok/s   64536 | loss  3.79 | ppl     44.40
| epoch   4 step     7790 | batches   1487 / 2101 | lr 9.343e-03 | ms/batch 761.0 | tok/s   64591 | loss  3.79 | ppl     44.42
| epoch   4 step     7800 | batches   1497 / 2101 | lr 9.342e-03 | ms/batch 762.6 | tok/s   64454 | loss  3.78 | ppl     43.97
| epoch   4 step     7810 | batches   1507 / 2101 | lr 9.340e-03 | ms/batch 762.0 | tok/s   64508 | loss  3.75 | ppl     42.39
| epoch   4 step     7820 | batches   1517 / 2101 | lr 9.338e-03 | ms/batch 762.7 | tok/s   64447 | loss  3.80 | ppl     44.69
| epoch   4 step     7830 | batches   1527 / 2101 | lr 9.336e-03 | ms/batch 762.1 | tok/s   64494 | loss  3.80 | ppl     44.78
| epoch   4 step     7840 | batches   1537 / 2101 | lr 9.334e-03 | ms/batch 762.8 | tok/s   64437 | loss  3.83 | ppl     45.83
| epoch   4 step     7850 | batches   1547 / 2101 | lr 9.332e-03 | ms/batch 762.1 | tok/s   64498 | loss  3.76 | ppl     42.90
| epoch   4 step     7860 | batches   1557 / 2101 | lr 9.330e-03 | ms/batch 762.1 | tok/s   64496 | loss  3.75 | ppl     42.63
| epoch   4 step     7870 | batches   1567 / 2101 | lr 9.328e-03 | ms/batch 762.1 | tok/s   64499 | loss  3.75 | ppl     42.52
| epoch   4 step     7880 | batches   1577 / 2101 | lr 9.326e-03 | ms/batch 762.9 | tok/s   64425 | loss  3.76 | ppl     42.98
| epoch   4 step     7890 | batches   1587 / 2101 | lr 9.325e-03 | ms/batch 762.6 | tok/s   64450 | loss  3.79 | ppl     44.40
| epoch   4 step     7900 | batches   1597 / 2101 | lr 9.323e-03 | ms/batch 762.2 | tok/s   64484 | loss  3.77 | ppl     43.52
| epoch   4 step     7910 | batches   1607 / 2101 | lr 9.321e-03 | ms/batch 762.5 | tok/s   64465 | loss  3.83 | ppl     45.98
| epoch   4 step     7920 | batches   1617 / 2101 | lr 9.319e-03 | ms/batch 763.8 | tok/s   64349 | loss  3.82 | ppl     45.66
| epoch   4 step     7930 | batches   1627 / 2101 | lr 9.317e-03 | ms/batch 762.1 | tok/s   64495 | loss  3.84 | ppl     46.58
| epoch   4 step     7940 | batches   1637 / 2101 | lr 9.315e-03 | ms/batch 763.1 | tok/s   64412 | loss  3.84 | ppl     46.75
| epoch   4 step     7950 | batches   1647 / 2101 | lr 9.313e-03 | ms/batch 763.1 | tok/s   64415 | loss  3.83 | ppl     45.95
| epoch   4 step     7960 | batches   1657 / 2101 | lr 9.311e-03 | ms/batch 763.0 | tok/s   64421 | loss  3.82 | ppl     45.45
| epoch   4 step     7970 | batches   1667 / 2101 | lr 9.309e-03 | ms/batch 763.0 | tok/s   64422 | loss  3.80 | ppl     44.81
| epoch   4 step     7980 | batches   1677 / 2101 | lr 9.307e-03 | ms/batch 761.6 | tok/s   64534 | loss  3.80 | ppl     44.52
| epoch   4 step     7990 | batches   1687 / 2101 | lr 9.305e-03 | ms/batch 761.2 | tok/s   64570 | loss  3.77 | ppl     43.36
| epoch   4 step     8000 | batches   1697 / 2101 | lr 9.303e-03 | ms/batch 763.4 | tok/s   64387 | loss  3.81 | ppl     45.14
----------------------------------------------------------------------------------------------------
| Eval  16 at step     8000 | time:  1.24s | valid loss  3.60 | valid ppl    36.478
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/DP32_666/checkpoint_last.pt
Saving checkpoint to TF32/DP32_666/checkpoint_best.pt
optimal compression parameters = [[], [127, 126, 23, 58, 46, 112, 127, 13, 65, 61], [106, 127, 15, 43, 23, 128, 127, 48, 53, 31], [89, 108, 9, 32, 15, 87, 88, 16, 34, 20], [68, 112, 8, 16, 12, 57, 67, 11, 22, 11], [12, 9, 10, 14, 11, 50, 54, 12, 13, 9], [30, 28, 9, 11, 10, 28, 32, 10, 10, 11], [39, 51, 10, 13, 8, 44, 56, 10, 15, 10], [32, 51, 9, 13, 10, 36, 41, 8, 14, 11], [8]]
| epoch   4 step     8010 | batches   1707 / 2101 | lr 9.301e-03 | ms/batch 7505.6 | tok/s    6549 | loss  3.76 | ppl     42.98
| epoch   4 step     8020 | batches   1717 / 2101 | lr 9.299e-03 | ms/batch 760.7 | tok/s   64612 | loss  3.74 | ppl     42.26
| epoch   4 step     8030 | batches   1727 / 2101 | lr 9.298e-03 | ms/batch 762.1 | tok/s   64496 | loss  3.71 | ppl     40.84
| epoch   4 step     8040 | batches   1737 / 2101 | lr 9.296e-03 | ms/batch 762.2 | tok/s   64488 | loss  3.76 | ppl     43.04
| epoch   4 step     8050 | batches   1747 / 2101 | lr 9.294e-03 | ms/batch 762.2 | tok/s   64485 | loss  3.77 | ppl     43.28
| epoch   4 step     8060 | batches   1757 / 2101 | lr 9.292e-03 | ms/batch 762.0 | tok/s   64505 | loss  3.78 | ppl     44.03
| epoch   4 step     8070 | batches   1767 / 2101 | lr 9.290e-03 | ms/batch 762.5 | tok/s   64466 | loss  3.78 | ppl     43.91
| epoch   4 step     8080 | batches   1777 / 2101 | lr 9.288e-03 | ms/batch 764.0 | tok/s   64337 | loss  3.79 | ppl     44.30
| epoch   4 step     8090 | batches   1787 / 2101 | lr 9.286e-03 | ms/batch 762.5 | tok/s   64460 | loss  3.78 | ppl     43.74
| epoch   4 step     8100 | batches   1797 / 2101 | lr 9.284e-03 | ms/batch 761.6 | tok/s   64537 | loss  3.83 | ppl     45.96
| epoch   4 step     8110 | batches   1807 / 2101 | lr 9.282e-03 | ms/batch 761.7 | tok/s   64531 | loss  3.80 | ppl     44.53
| epoch   4 step     8120 | batches   1817 / 2101 | lr 9.280e-03 | ms/batch 762.0 | tok/s   64507 | loss  3.82 | ppl     45.61
| epoch   4 step     8130 | batches   1827 / 2101 | lr 9.278e-03 | ms/batch 762.2 | tok/s   64490 | loss  3.81 | ppl     45.05
| epoch   4 step     8140 | batches   1837 / 2101 | lr 9.276e-03 | ms/batch 761.5 | tok/s   64546 | loss  3.83 | ppl     46.04
| epoch   4 step     8150 | batches   1847 / 2101 | lr 9.274e-03 | ms/batch 761.7 | tok/s   64532 | loss  3.78 | ppl     43.64
| epoch   4 step     8160 | batches   1857 / 2101 | lr 9.272e-03 | ms/batch 763.2 | tok/s   64400 | loss  3.83 | ppl     46.28
| epoch   4 step     8170 | batches   1867 / 2101 | lr 9.270e-03 | ms/batch 763.0 | tok/s   64419 | loss  3.77 | ppl     43.39
| epoch   4 step     8180 | batches   1877 / 2101 | lr 9.268e-03 | ms/batch 763.0 | tok/s   64424 | loss  3.78 | ppl     43.60
| epoch   4 step     8190 | batches   1887 / 2101 | lr 9.266e-03 | ms/batch 761.1 | tok/s   64582 | loss  3.79 | ppl     44.10
| epoch   4 step     8200 | batches   1897 / 2101 | lr 9.264e-03 | ms/batch 762.0 | tok/s   64501 | loss  3.82 | ppl     45.72
| epoch   4 step     8210 | batches   1907 / 2101 | lr 9.262e-03 | ms/batch 762.4 | tok/s   64474 | loss  3.78 | ppl     43.63
| epoch   4 step     8220 | batches   1917 / 2101 | lr 9.260e-03 | ms/batch 762.6 | tok/s   64451 | loss  3.80 | ppl     44.56
| epoch   4 step     8230 | batches   1927 / 2101 | lr 9.258e-03 | ms/batch 762.0 | tok/s   64505 | loss  3.82 | ppl     45.82
| epoch   4 step     8240 | batches   1937 / 2101 | lr 9.256e-03 | ms/batch 763.2 | tok/s   64399 | loss  3.82 | ppl     45.50
| epoch   4 step     8250 | batches   1947 / 2101 | lr 9.254e-03 | ms/batch 763.1 | tok/s   64412 | loss  3.88 | ppl     48.31
| epoch   4 step     8260 | batches   1957 / 2101 | lr 9.252e-03 | ms/batch 762.9 | tok/s   64424 | loss  3.81 | ppl     45.33
| epoch   4 step     8270 | batches   1967 / 2101 | lr 9.250e-03 | ms/batch 762.3 | tok/s   64480 | loss  3.83 | ppl     46.05
| epoch   4 step     8280 | batches   1977 / 2101 | lr 9.248e-03 | ms/batch 762.6 | tok/s   64451 | loss  3.84 | ppl     46.38
| epoch   4 step     8290 | batches   1987 / 2101 | lr 9.246e-03 | ms/batch 761.9 | tok/s   64516 | loss  3.86 | ppl     47.47
| epoch   4 step     8300 | batches   1997 / 2101 | lr 9.244e-03 | ms/batch 762.9 | tok/s   64427 | loss  3.81 | ppl     45.20
| epoch   4 step     8310 | batches   2007 / 2101 | lr 9.242e-03 | ms/batch 762.6 | tok/s   64453 | loss  3.83 | ppl     45.97
| epoch   4 step     8320 | batches   2017 / 2101 | lr 9.240e-03 | ms/batch 763.0 | tok/s   64417 | loss  3.81 | ppl     45.07
| epoch   4 step     8330 | batches   2027 / 2101 | lr 9.238e-03 | ms/batch 762.6 | tok/s   64452 | loss  3.79 | ppl     44.09
| epoch   4 step     8340 | batches   2037 / 2101 | lr 9.236e-03 | ms/batch 762.1 | tok/s   64492 | loss  3.79 | ppl     44.47
| epoch   4 step     8350 | batches   2047 / 2101 | lr 9.234e-03 | ms/batch 761.5 | tok/s   64547 | loss  3.76 | ppl     42.91
| epoch   4 step     8360 | batches   2057 / 2101 | lr 9.232e-03 | ms/batch 762.0 | tok/s   64502 | loss  3.74 | ppl     42.24
| epoch   4 step     8370 | batches   2067 / 2101 | lr 9.230e-03 | ms/batch 761.8 | tok/s   64520 | loss  3.74 | ppl     42.30
| epoch   4 step     8380 | batches   2077 / 2101 | lr 9.228e-03 | ms/batch 762.4 | tok/s   64470 | loss  3.75 | ppl     42.46
| epoch   4 step     8390 | batches   2087 / 2101 | lr 9.226e-03 | ms/batch 760.9 | tok/s   64600 | loss  3.75 | ppl     42.47
| epoch   4 step     8400 | batches   2097 / 2101 | lr 9.224e-03 | ms/batch 762.5 | tok/s   64459 | loss  3.81 | ppl     45.02
| epoch   5 step     8410 | batches      6 / 2101 | lr 9.222e-03 | ms/batch 763.1 | tok/s   64427 | loss  3.85 | ppl     47.21
| epoch   5 step     8420 | batches     16 / 2101 | lr 9.220e-03 | ms/batch 762.8 | tok/s   64439 | loss  3.73 | ppl     41.63
| epoch   5 step     8430 | batches     26 / 2101 | lr 9.218e-03 | ms/batch 760.8 | tok/s   64608 | loss  3.70 | ppl     40.57
| epoch   5 step     8440 | batches     36 / 2101 | lr 9.216e-03 | ms/batch 762.2 | tok/s   64484 | loss  3.69 | ppl     40.21
| epoch   5 step     8450 | batches     46 / 2101 | lr 9.214e-03 | ms/batch 762.0 | tok/s   64507 | loss  3.67 | ppl     39.16
| epoch   5 step     8460 | batches     56 / 2101 | lr 9.212e-03 | ms/batch 761.3 | tok/s   64559 | loss  3.69 | ppl     39.90
| epoch   5 step     8470 | batches     66 / 2101 | lr 9.210e-03 | ms/batch 762.2 | tok/s   64483 | loss  3.69 | ppl     39.96
| epoch   5 step     8480 | batches     76 / 2101 | lr 9.208e-03 | ms/batch 760.7 | tok/s   64614 | loss  3.73 | ppl     41.78
| epoch   5 step     8490 | batches     86 / 2101 | lr 9.205e-03 | ms/batch 762.8 | tok/s   64439 | loss  3.76 | ppl     42.97
| epoch   5 step     8500 | batches     96 / 2101 | lr 9.203e-03 | ms/batch 762.1 | tok/s   64493 | loss  3.76 | ppl     42.78
----------------------------------------------------------------------------------------------------
| Eval  17 at step     8500 | time:  1.24s | valid loss  3.57 | valid ppl    35.690
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/DP32_666/checkpoint_last.pt
Saving checkpoint to TF32/DP32_666/checkpoint_best.pt
| epoch   5 step     8510 | batches    106 / 2101 | lr 9.201e-03 | ms/batch 761.2 | tok/s   64573 | loss  3.69 | ppl     40.04
| epoch   5 step     8520 | batches    116 / 2101 | lr 9.199e-03 | ms/batch 761.2 | tok/s   64575 | loss  3.73 | ppl     41.58
| epoch   5 step     8530 | batches    126 / 2101 | lr 9.197e-03 | ms/batch 762.0 | tok/s   64503 | loss  3.74 | ppl     42.12
| epoch   5 step     8540 | batches    136 / 2101 | lr 9.195e-03 | ms/batch 763.1 | tok/s   64412 | loss  3.72 | ppl     41.47
| epoch   5 step     8550 | batches    146 / 2101 | lr 9.193e-03 | ms/batch 762.6 | tok/s   64451 | loss  3.71 | ppl     40.78
| epoch   5 step     8560 | batches    156 / 2101 | lr 9.191e-03 | ms/batch 763.5 | tok/s   64380 | loss  3.73 | ppl     41.51
| epoch   5 step     8570 | batches    166 / 2101 | lr 9.189e-03 | ms/batch 763.0 | tok/s   64419 | loss  3.71 | ppl     40.90
| epoch   5 step     8580 | batches    176 / 2101 | lr 9.187e-03 | ms/batch 763.0 | tok/s   64419 | loss  3.73 | ppl     41.59
| epoch   5 step     8590 | batches    186 / 2101 | lr 9.185e-03 | ms/batch 762.1 | tok/s   64494 | loss  3.70 | ppl     40.29
| epoch   5 step     8600 | batches    196 / 2101 | lr 9.183e-03 | ms/batch 761.3 | tok/s   64561 | loss  3.66 | ppl     38.84
| epoch   5 step     8610 | batches    206 / 2101 | lr 9.181e-03 | ms/batch 762.0 | tok/s   64502 | loss  3.70 | ppl     40.60
| epoch   5 step     8620 | batches    216 / 2101 | lr 9.179e-03 | ms/batch 763.2 | tok/s   64402 | loss  3.73 | ppl     41.72
| epoch   5 step     8630 | batches    226 / 2101 | lr 9.176e-03 | ms/batch 762.1 | tok/s   64497 | loss  3.76 | ppl     43.04
| epoch   5 step     8640 | batches    236 / 2101 | lr 9.174e-03 | ms/batch 761.6 | tok/s   64539 | loss  3.76 | ppl     42.91
| epoch   5 step     8650 | batches    246 / 2101 | lr 9.172e-03 | ms/batch 762.0 | tok/s   64504 | loss  3.75 | ppl     42.38
| epoch   5 step     8660 | batches    256 / 2101 | lr 9.170e-03 | ms/batch 761.2 | tok/s   64572 | loss  3.76 | ppl     42.77
| epoch   5 step     8670 | batches    266 / 2101 | lr 9.168e-03 | ms/batch 762.4 | tok/s   64472 | loss  3.73 | ppl     41.62
| epoch   5 step     8680 | batches    276 / 2101 | lr 9.166e-03 | ms/batch 762.5 | tok/s   64459 | loss  3.71 | ppl     40.65
| epoch   5 step     8690 | batches    286 / 2101 | lr 9.164e-03 | ms/batch 761.7 | tok/s   64528 | loss  3.70 | ppl     40.38
| epoch   5 step     8700 | batches    296 / 2101 | lr 9.162e-03 | ms/batch 761.3 | tok/s   64563 | loss  3.72 | ppl     41.11
| epoch   5 step     8710 | batches    306 / 2101 | lr 9.160e-03 | ms/batch 760.1 | tok/s   64668 | loss  3.71 | ppl     41.06
| epoch   5 step     8720 | batches    316 / 2101 | lr 9.158e-03 | ms/batch 762.1 | tok/s   64498 | loss  3.73 | ppl     41.81
| epoch   5 step     8730 | batches    326 / 2101 | lr 9.155e-03 | ms/batch 761.0 | tok/s   64591 | loss  3.75 | ppl     42.32
| epoch   5 step     8740 | batches    336 / 2101 | lr 9.153e-03 | ms/batch 762.5 | tok/s   64461 | loss  3.72 | ppl     41.39
| epoch   5 step     8750 | batches    346 / 2101 | lr 9.151e-03 | ms/batch 763.5 | tok/s   64381 | loss  3.70 | ppl     40.57
| epoch   5 step     8760 | batches    356 / 2101 | lr 9.149e-03 | ms/batch 762.2 | tok/s   64484 | loss  3.71 | ppl     40.85
| epoch   5 step     8770 | batches    366 / 2101 | lr 9.147e-03 | ms/batch 761.8 | tok/s   64521 | loss  3.75 | ppl     42.46
| epoch   5 step     8780 | batches    376 / 2101 | lr 9.145e-03 | ms/batch 762.8 | tok/s   64435 | loss  3.73 | ppl     41.86
| epoch   5 step     8790 | batches    386 / 2101 | lr 9.143e-03 | ms/batch 762.6 | tok/s   64455 | loss  3.72 | ppl     41.40
| epoch   5 step     8800 | batches    396 / 2101 | lr 9.141e-03 | ms/batch 762.3 | tok/s   64476 | loss  3.72 | ppl     41.21
| epoch   5 step     8810 | batches    406 / 2101 | lr 9.138e-03 | ms/batch 761.7 | tok/s   64530 | loss  3.69 | ppl     40.15
| epoch   5 step     8820 | batches    416 / 2101 | lr 9.136e-03 | ms/batch 761.6 | tok/s   64535 | loss  3.69 | ppl     40.18
| epoch   5 step     8830 | batches    426 / 2101 | lr 9.134e-03 | ms/batch 762.1 | tok/s   64498 | loss  3.75 | ppl     42.38
| epoch   5 step     8840 | batches    436 / 2101 | lr 9.132e-03 | ms/batch 761.2 | tok/s   64573 | loss  3.73 | ppl     41.60
| epoch   5 step     8850 | batches    446 / 2101 | lr 9.130e-03 | ms/batch 761.2 | tok/s   64569 | loss  3.73 | ppl     41.79
| epoch   5 step     8860 | batches    456 / 2101 | lr 9.128e-03 | ms/batch 762.1 | tok/s   64495 | loss  3.69 | ppl     40.17
| epoch   5 step     8870 | batches    466 / 2101 | lr 9.126e-03 | ms/batch 762.7 | tok/s   64441 | loss  3.71 | ppl     40.77
| epoch   5 step     8880 | batches    476 / 2101 | lr 9.123e-03 | ms/batch 762.7 | tok/s   64447 | loss  3.75 | ppl     42.56
| epoch   5 step     8890 | batches    486 / 2101 | lr 9.121e-03 | ms/batch 763.6 | tok/s   64369 | loss  3.75 | ppl     42.68
| epoch   5 step     8900 | batches    496 / 2101 | lr 9.119e-03 | ms/batch 762.2 | tok/s   64486 | loss  3.71 | ppl     40.86
| epoch   5 step     8910 | batches    506 / 2101 | lr 9.117e-03 | ms/batch 762.3 | tok/s   64480 | loss  3.69 | ppl     40.22
| epoch   5 step     8920 | batches    516 / 2101 | lr 9.115e-03 | ms/batch 762.2 | tok/s   64487 | loss  3.71 | ppl     40.91
| epoch   5 step     8930 | batches    526 / 2101 | lr 9.113e-03 | ms/batch 763.0 | tok/s   64422 | loss  3.74 | ppl     42.05
| epoch   5 step     8940 | batches    536 / 2101 | lr 9.111e-03 | ms/batch 763.2 | tok/s   64405 | loss  3.69 | ppl     40.11
| epoch   5 step     8950 | batches    546 / 2101 | lr 9.108e-03 | ms/batch 762.3 | tok/s   64475 | loss  3.67 | ppl     39.14
| epoch   5 step     8960 | batches    556 / 2101 | lr 9.106e-03 | ms/batch 762.5 | tok/s   64466 | loss  3.72 | ppl     41.31
| epoch   5 step     8970 | batches    566 / 2101 | lr 9.104e-03 | ms/batch 760.9 | tok/s   64597 | loss  3.70 | ppl     40.31
| epoch   5 step     8980 | batches    576 / 2101 | lr 9.102e-03 | ms/batch 761.1 | tok/s   64578 | loss  3.69 | ppl     40.03
| epoch   5 step     8990 | batches    586 / 2101 | lr 9.100e-03 | ms/batch 762.3 | tok/s   64479 | loss  3.68 | ppl     39.46
| epoch   5 step     9000 | batches    596 / 2101 | lr 9.097e-03 | ms/batch 762.9 | tok/s   64427 | loss  3.71 | ppl     40.83
----------------------------------------------------------------------------------------------------
| Eval  18 at step     9000 | time:  1.24s | valid loss  3.55 | valid ppl    34.962
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/DP32_666/checkpoint_last.pt
Saving checkpoint to TF32/DP32_666/checkpoint_best.pt
optimal compression parameters = [[], [128, 128, 24, 57, 45, 114, 127, 10, 70, 53], [113, 124, 12, 40, 23, 128, 124, 50, 53, 31], [93, 118, 9, 27, 16, 96, 95, 14, 31, 19], [75, 104, 8, 16, 9, 53, 56, 8, 18, 13], [15, 9, 9, 15, 12, 54, 57, 11, 16, 14], [29, 30, 8, 10, 9, 31, 32, 10, 10, 10], [38, 49, 9, 14, 8, 42, 51, 8, 12, 9], [27, 53, 10, 13, 9, 35, 46, 10, 11, 9], [8]]
| epoch   5 step     9010 | batches    606 / 2101 | lr 9.095e-03 | ms/batch 7515.0 | tok/s    6541 | loss  3.73 | ppl     41.86
| epoch   5 step     9020 | batches    616 / 2101 | lr 9.093e-03 | ms/batch 762.7 | tok/s   64447 | loss  3.71 | ppl     40.95
| epoch   5 step     9030 | batches    626 / 2101 | lr 9.091e-03 | ms/batch 762.8 | tok/s   64437 | loss  3.76 | ppl     42.95
| epoch   5 step     9040 | batches    636 / 2101 | lr 9.089e-03 | ms/batch 763.4 | tok/s   64383 | loss  3.75 | ppl     42.70
| epoch   5 step     9050 | batches    646 / 2101 | lr 9.087e-03 | ms/batch 765.7 | tok/s   64194 | loss  3.71 | ppl     40.92
| epoch   5 step     9060 | batches    656 / 2101 | lr 9.084e-03 | ms/batch 762.8 | tok/s   64434 | loss  3.71 | ppl     40.66
| epoch   5 step     9070 | batches    666 / 2101 | lr 9.082e-03 | ms/batch 763.0 | tok/s   64417 | loss  3.70 | ppl     40.41
| epoch   5 step     9080 | batches    676 / 2101 | lr 9.080e-03 | ms/batch 762.1 | tok/s   64492 | loss  3.67 | ppl     39.31
| epoch   5 step     9090 | batches    686 / 2101 | lr 9.078e-03 | ms/batch 761.5 | tok/s   64549 | loss  3.67 | ppl     39.44
| epoch   5 step     9100 | batches    696 / 2101 | lr 9.076e-03 | ms/batch 761.7 | tok/s   64528 | loss  3.69 | ppl     40.00
| epoch   5 step     9110 | batches    706 / 2101 | lr 9.073e-03 | ms/batch 759.9 | tok/s   64680 | loss  3.67 | ppl     39.31
| epoch   5 step     9120 | batches    716 / 2101 | lr 9.071e-03 | ms/batch 761.9 | tok/s   64516 | loss  3.70 | ppl     40.41
| epoch   5 step     9130 | batches    726 / 2101 | lr 9.069e-03 | ms/batch 762.6 | tok/s   64455 | loss  3.72 | ppl     41.13
| epoch   5 step     9140 | batches    736 / 2101 | lr 9.067e-03 | ms/batch 762.5 | tok/s   64462 | loss  3.73 | ppl     41.72
| epoch   5 step     9150 | batches    746 / 2101 | lr 9.065e-03 | ms/batch 762.8 | tok/s   64436 | loss  3.71 | ppl     40.71
| epoch   5 step     9160 | batches    756 / 2101 | lr 9.062e-03 | ms/batch 761.7 | tok/s   64531 | loss  3.70 | ppl     40.61
| epoch   5 step     9170 | batches    766 / 2101 | lr 9.060e-03 | ms/batch 761.3 | tok/s   64562 | loss  3.72 | ppl     41.44
| epoch   5 step     9180 | batches    776 / 2101 | lr 9.058e-03 | ms/batch 760.8 | tok/s   64604 | loss  3.71 | ppl     40.76
| epoch   5 step     9190 | batches    786 / 2101 | lr 9.056e-03 | ms/batch 761.4 | tok/s   64552 | loss  3.69 | ppl     40.18
| epoch   5 step     9200 | batches    796 / 2101 | lr 9.053e-03 | ms/batch 761.5 | tok/s   64550 | loss  3.73 | ppl     41.50
| epoch   5 step     9210 | batches    806 / 2101 | lr 9.051e-03 | ms/batch 761.5 | tok/s   64547 | loss  3.73 | ppl     41.82
| epoch   5 step     9220 | batches    816 / 2101 | lr 9.049e-03 | ms/batch 761.4 | tok/s   64558 | loss  3.72 | ppl     41.07
| epoch   5 step     9230 | batches    826 / 2101 | lr 9.047e-03 | ms/batch 761.9 | tok/s   64514 | loss  3.73 | ppl     41.49
| epoch   5 step     9240 | batches    836 / 2101 | lr 9.045e-03 | ms/batch 761.4 | tok/s   64559 | loss  3.75 | ppl     42.34
| epoch   5 step     9250 | batches    846 / 2101 | lr 9.042e-03 | ms/batch 761.1 | tok/s   64581 | loss  3.73 | ppl     41.82
| epoch   5 step     9260 | batches    856 / 2101 | lr 9.040e-03 | ms/batch 760.9 | tok/s   64599 | loss  3.69 | ppl     39.85
| epoch   5 step     9270 | batches    866 / 2101 | lr 9.038e-03 | ms/batch 762.1 | tok/s   64492 | loss  3.73 | ppl     41.79
| epoch   5 step     9280 | batches    876 / 2101 | lr 9.036e-03 | ms/batch 763.6 | tok/s   64366 | loss  3.76 | ppl     43.02
| epoch   5 step     9290 | batches    886 / 2101 | lr 9.033e-03 | ms/batch 763.2 | tok/s   64403 | loss  3.74 | ppl     42.22
| epoch   5 step     9300 | batches    896 / 2101 | lr 9.031e-03 | ms/batch 761.7 | tok/s   64526 | loss  3.71 | ppl     40.83
| epoch   5 step     9310 | batches    906 / 2101 | lr 9.029e-03 | ms/batch 762.1 | tok/s   64496 | loss  3.71 | ppl     40.67
| epoch   5 step     9320 | batches    916 / 2101 | lr 9.027e-03 | ms/batch 762.3 | tok/s   64479 | loss  3.71 | ppl     40.92
| epoch   5 step     9330 | batches    926 / 2101 | lr 9.024e-03 | ms/batch 762.0 | tok/s   64508 | loss  3.69 | ppl     40.04
| epoch   5 step     9340 | batches    936 / 2101 | lr 9.022e-03 | ms/batch 761.5 | tok/s   64545 | loss  3.72 | ppl     41.16
| epoch   5 step     9350 | batches    946 / 2101 | lr 9.020e-03 | ms/batch 761.1 | tok/s   64577 | loss  3.73 | ppl     41.47
| epoch   5 step     9360 | batches    956 / 2101 | lr 9.018e-03 | ms/batch 761.2 | tok/s   64571 | loss  3.73 | ppl     41.52
| epoch   5 step     9370 | batches    966 / 2101 | lr 9.015e-03 | ms/batch 761.1 | tok/s   64584 | loss  3.74 | ppl     42.21
| epoch   5 step     9380 | batches    976 / 2101 | lr 9.013e-03 | ms/batch 762.1 | tok/s   64497 | loss  3.76 | ppl     43.01
| epoch   5 step     9390 | batches    986 / 2101 | lr 9.011e-03 | ms/batch 763.4 | tok/s   64385 | loss  3.74 | ppl     42.26
| epoch   5 step     9400 | batches    996 / 2101 | lr 9.009e-03 | ms/batch 763.4 | tok/s   64384 | loss  3.70 | ppl     40.62
| epoch   5 step     9410 | batches   1006 / 2101 | lr 9.006e-03 | ms/batch 762.6 | tok/s   64455 | loss  3.72 | ppl     41.29
| epoch   5 step     9420 | batches   1016 / 2101 | lr 9.004e-03 | ms/batch 762.6 | tok/s   64456 | loss  3.73 | ppl     41.83
| epoch   5 step     9430 | batches   1026 / 2101 | lr 9.002e-03 | ms/batch 761.6 | tok/s   64540 | loss  3.75 | ppl     42.53
| epoch   5 step     9440 | batches   1036 / 2101 | lr 8.999e-03 | ms/batch 762.7 | tok/s   64447 | loss  3.74 | ppl     42.09
| epoch   5 step     9450 | batches   1046 / 2101 | lr 8.997e-03 | ms/batch 762.9 | tok/s   64430 | loss  3.74 | ppl     42.13
| epoch   5 step     9460 | batches   1056 / 2101 | lr 8.995e-03 | ms/batch 761.8 | tok/s   64522 | loss  3.72 | ppl     41.25
| epoch   5 step     9470 | batches   1066 / 2101 | lr 8.993e-03 | ms/batch 762.2 | tok/s   64491 | loss  3.66 | ppl     39.05
| epoch   5 step     9480 | batches   1076 / 2101 | lr 8.990e-03 | ms/batch 763.3 | tok/s   64392 | loss  3.70 | ppl     40.34
| epoch   5 step     9490 | batches   1086 / 2101 | lr 8.988e-03 | ms/batch 761.8 | tok/s   64523 | loss  3.73 | ppl     41.53
| epoch   5 step     9500 | batches   1096 / 2101 | lr 8.986e-03 | ms/batch 760.6 | tok/s   64622 | loss  3.69 | ppl     40.20
----------------------------------------------------------------------------------------------------
| Eval  19 at step     9500 | time:  1.24s | valid loss  3.53 | valid ppl    34.042
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/DP32_666/checkpoint_last.pt
Saving checkpoint to TF32/DP32_666/checkpoint_best.pt
| epoch   5 step     9510 | batches   1106 / 2101 | lr 8.983e-03 | ms/batch 761.4 | tok/s   64553 | loss  3.72 | ppl     41.28
| epoch   5 step     9520 | batches   1116 / 2101 | lr 8.981e-03 | ms/batch 762.8 | tok/s   64437 | loss  3.71 | ppl     40.99
| epoch   5 step     9530 | batches   1126 / 2101 | lr 8.979e-03 | ms/batch 762.5 | tok/s   64459 | loss  3.75 | ppl     42.41
| epoch   5 step     9540 | batches   1136 / 2101 | lr 8.977e-03 | ms/batch 763.1 | tok/s   64409 | loss  3.72 | ppl     41.19
| epoch   5 step     9550 | batches   1146 / 2101 | lr 8.974e-03 | ms/batch 761.1 | tok/s   64579 | loss  3.69 | ppl     39.98
| epoch   5 step     9560 | batches   1156 / 2101 | lr 8.972e-03 | ms/batch 761.3 | tok/s   64567 | loss  3.68 | ppl     39.56
| epoch   5 step     9570 | batches   1166 / 2101 | lr 8.970e-03 | ms/batch 761.6 | tok/s   64538 | loss  3.68 | ppl     39.63
| epoch   5 step     9580 | batches   1176 / 2101 | lr 8.967e-03 | ms/batch 760.9 | tok/s   64601 | loss  3.70 | ppl     40.44
| epoch   5 step     9590 | batches   1186 / 2101 | lr 8.965e-03 | ms/batch 762.1 | tok/s   64500 | loss  3.74 | ppl     41.90
| epoch   5 step     9600 | batches   1196 / 2101 | lr 8.963e-03 | ms/batch 761.5 | tok/s   64543 | loss  3.73 | ppl     41.69
| epoch   5 step     9610 | batches   1206 / 2101 | lr 8.960e-03 | ms/batch 762.3 | tok/s   64475 | loss  3.70 | ppl     40.55
| epoch   5 step     9620 | batches   1216 / 2101 | lr 8.958e-03 | ms/batch 761.3 | tok/s   64563 | loss  3.71 | ppl     40.90
| epoch   5 step     9630 | batches   1226 / 2101 | lr 8.956e-03 | ms/batch 761.7 | tok/s   64532 | loss  3.74 | ppl     42.21
| epoch   5 step     9640 | batches   1236 / 2101 | lr 8.953e-03 | ms/batch 761.6 | tok/s   64537 | loss  3.71 | ppl     40.82
| epoch   5 step     9650 | batches   1246 / 2101 | lr 8.951e-03 | ms/batch 761.6 | tok/s   64538 | loss  3.70 | ppl     40.25
| epoch   5 step     9660 | batches   1256 / 2101 | lr 8.949e-03 | ms/batch 761.9 | tok/s   64516 | loss  3.70 | ppl     40.58
| epoch   5 step     9670 | batches   1266 / 2101 | lr 8.946e-03 | ms/batch 762.3 | tok/s   64475 | loss  3.71 | ppl     40.78
| epoch   5 step     9680 | batches   1276 / 2101 | lr 8.944e-03 | ms/batch 761.9 | tok/s   64511 | loss  3.69 | ppl     39.97
| epoch   5 step     9690 | batches   1286 / 2101 | lr 8.942e-03 | ms/batch 760.8 | tok/s   64605 | loss  3.67 | ppl     39.38
| epoch   5 step     9700 | batches   1296 / 2101 | lr 8.939e-03 | ms/batch 760.6 | tok/s   64620 | loss  3.70 | ppl     40.48
| epoch   5 step     9710 | batches   1306 / 2101 | lr 8.937e-03 | ms/batch 762.2 | tok/s   64486 | loss  3.72 | ppl     41.08
| epoch   5 step     9720 | batches   1316 / 2101 | lr 8.935e-03 | ms/batch 761.1 | tok/s   64578 | loss  3.70 | ppl     40.56
| epoch   5 step     9730 | batches   1326 / 2101 | lr 8.932e-03 | ms/batch 762.3 | tok/s   64481 | loss  3.66 | ppl     38.88
| epoch   5 step     9740 | batches   1336 / 2101 | lr 8.930e-03 | ms/batch 760.9 | tok/s   64599 | loss  3.68 | ppl     39.55
| epoch   5 step     9750 | batches   1346 / 2101 | lr 8.928e-03 | ms/batch 761.0 | tok/s   64585 | loss  3.70 | ppl     40.26
| epoch   5 step     9760 | batches   1356 / 2101 | lr 8.925e-03 | ms/batch 761.9 | tok/s   64509 | loss  3.70 | ppl     40.56
| epoch   5 step     9770 | batches   1366 / 2101 | lr 8.923e-03 | ms/batch 760.9 | tok/s   64598 | loss  3.68 | ppl     39.76
| epoch   5 step     9780 | batches   1376 / 2101 | lr 8.921e-03 | ms/batch 762.5 | tok/s   64465 | loss  3.73 | ppl     41.50
| epoch   5 step     9790 | batches   1386 / 2101 | lr 8.918e-03 | ms/batch 762.1 | tok/s   64499 | loss  3.72 | ppl     41.33
| epoch   5 step     9800 | batches   1396 / 2101 | lr 8.916e-03 | ms/batch 762.0 | tok/s   64507 | loss  3.71 | ppl     41.00
| epoch   5 step     9810 | batches   1406 / 2101 | lr 8.914e-03 | ms/batch 761.4 | tok/s   64556 | loss  3.68 | ppl     39.72
| epoch   5 step     9820 | batches   1416 / 2101 | lr 8.911e-03 | ms/batch 762.9 | tok/s   64428 | loss  3.67 | ppl     39.15
| epoch   5 step     9830 | batches   1426 / 2101 | lr 8.909e-03 | ms/batch 761.8 | tok/s   64523 | loss  3.67 | ppl     39.26
| epoch   5 step     9840 | batches   1436 / 2101 | lr 8.906e-03 | ms/batch 762.3 | tok/s   64481 | loss  3.70 | ppl     40.40
| epoch   5 step     9850 | batches   1446 / 2101 | lr 8.904e-03 | ms/batch 762.5 | tok/s   64466 | loss  3.69 | ppl     40.12
| epoch   5 step     9860 | batches   1456 / 2101 | lr 8.902e-03 | ms/batch 761.4 | tok/s   64552 | loss  3.72 | ppl     41.19
| epoch   5 step     9870 | batches   1466 / 2101 | lr 8.899e-03 | ms/batch 761.5 | tok/s   64545 | loss  3.68 | ppl     39.70
| epoch   5 step     9880 | batches   1476 / 2101 | lr 8.897e-03 | ms/batch 763.0 | tok/s   64415 | loss  3.69 | ppl     40.01
| epoch   5 step     9890 | batches   1486 / 2101 | lr 8.895e-03 | ms/batch 762.7 | tok/s   64448 | loss  3.69 | ppl     40.15
| epoch   5 step     9900 | batches   1496 / 2101 | lr 8.892e-03 | ms/batch 761.2 | tok/s   64569 | loss  3.72 | ppl     41.39
| epoch   5 step     9910 | batches   1506 / 2101 | lr 8.890e-03 | ms/batch 761.2 | tok/s   64574 | loss  3.69 | ppl     39.86
| epoch   5 step     9920 | batches   1516 / 2101 | lr 8.887e-03 | ms/batch 761.4 | tok/s   64551 | loss  3.70 | ppl     40.34
| epoch   5 step     9930 | batches   1526 / 2101 | lr 8.885e-03 | ms/batch 762.7 | tok/s   64445 | loss  3.70 | ppl     40.54
| epoch   5 step     9940 | batches   1536 / 2101 | lr 8.883e-03 | ms/batch 761.6 | tok/s   64537 | loss  3.71 | ppl     40.66
| epoch   5 step     9950 | batches   1546 / 2101 | lr 8.880e-03 | ms/batch 763.0 | tok/s   64417 | loss  3.72 | ppl     41.45
| epoch   5 step     9960 | batches   1556 / 2101 | lr 8.878e-03 | ms/batch 760.9 | tok/s   64595 | loss  3.69 | ppl     40.19
| epoch   5 step     9970 | batches   1566 / 2101 | lr 8.875e-03 | ms/batch 762.0 | tok/s   64506 | loss  3.66 | ppl     38.91
| epoch   5 step     9980 | batches   1576 / 2101 | lr 8.873e-03 | ms/batch 762.6 | tok/s   64451 | loss  3.71 | ppl     41.01
| epoch   5 step     9990 | batches   1586 / 2101 | lr 8.871e-03 | ms/batch 763.5 | tok/s   64380 | loss  3.72 | ppl     41.07
| epoch   5 step    10000 | batches   1596 / 2101 | lr 8.868e-03 | ms/batch 764.1 | tok/s   64323 | loss  3.72 | ppl     41.16
----------------------------------------------------------------------------------------------------
| Eval  20 at step    10000 | time:  1.24s | valid loss  3.52 | valid ppl    33.627
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/DP32_666/checkpoint_last.pt
Saving checkpoint to TF32/DP32_666/checkpoint_best.pt
optimal compression parameters = [[], [126, 127, 23, 64, 49, 122, 127, 12, 66, 59], [112, 125, 12, 39, 23, 128, 128, 47, 47, 28], [91, 108, 11, 28, 18, 98, 96, 20, 29, 19], [72, 96, 10, 14, 12, 57, 57, 8, 16, 14], [13, 9, 9, 10, 9, 52, 54, 10, 13, 13], [26, 33, 10, 11, 8, 31, 35, 9, 13, 8], [37, 42, 8, 10, 11, 41, 54, 8, 12, 9], [29, 52, 10, 12, 11, 35, 43, 9, 9, 8], [8]]
| epoch   5 step    10010 | batches   1606 / 2101 | lr 8.866e-03 | ms/batch 7513.0 | tok/s    6542 | loss  3.70 | ppl     40.55
| epoch   5 step    10020 | batches   1616 / 2101 | lr 8.863e-03 | ms/batch 762.2 | tok/s   64487 | loss  3.63 | ppl     37.75
| epoch   5 step    10030 | batches   1626 / 2101 | lr 8.861e-03 | ms/batch 762.8 | tok/s   64433 | loss  3.66 | ppl     38.95
| epoch   5 step    10040 | batches   1636 / 2101 | lr 8.859e-03 | ms/batch 761.0 | tok/s   64586 | loss  3.64 | ppl     38.24
| epoch   5 step    10050 | batches   1646 / 2101 | lr 8.856e-03 | ms/batch 761.3 | tok/s   64565 | loss  3.67 | ppl     39.31
| epoch   5 step    10060 | batches   1656 / 2101 | lr 8.854e-03 | ms/batch 762.2 | tok/s   64485 | loss  3.68 | ppl     39.82
| epoch   5 step    10070 | batches   1666 / 2101 | lr 8.851e-03 | ms/batch 761.4 | tok/s   64557 | loss  3.69 | ppl     40.13
| epoch   5 step    10080 | batches   1676 / 2101 | lr 8.849e-03 | ms/batch 762.6 | tok/s   64455 | loss  3.70 | ppl     40.38
| epoch   5 step    10090 | batches   1686 / 2101 | lr 8.847e-03 | ms/batch 761.9 | tok/s   64513 | loss  3.72 | ppl     41.32
| epoch   5 step    10100 | batches   1696 / 2101 | lr 8.844e-03 | ms/batch 761.2 | tok/s   64574 | loss  3.71 | ppl     40.94
| epoch   5 step    10110 | batches   1706 / 2101 | lr 8.842e-03 | ms/batch 761.3 | tok/s   64562 | loss  3.69 | ppl     39.85
| epoch   5 step    10120 | batches   1716 / 2101 | lr 8.839e-03 | ms/batch 762.0 | tok/s   64502 | loss  3.67 | ppl     39.10
| epoch   5 step    10130 | batches   1726 / 2101 | lr 8.837e-03 | ms/batch 761.2 | tok/s   64574 | loss  3.65 | ppl     38.29
| epoch   5 step    10140 | batches   1736 / 2101 | lr 8.834e-03 | ms/batch 761.7 | tok/s   64530 | loss  3.72 | ppl     41.11
| epoch   5 step    10150 | batches   1746 / 2101 | lr 8.832e-03 | ms/batch 763.2 | tok/s   64403 | loss  3.72 | ppl     41.38
| epoch   5 step    10160 | batches   1756 / 2101 | lr 8.830e-03 | ms/batch 763.2 | tok/s   64405 | loss  3.72 | ppl     41.16
| epoch   5 step    10170 | batches   1766 / 2101 | lr 8.827e-03 | ms/batch 762.4 | tok/s   64470 | loss  3.72 | ppl     41.18
| epoch   5 step    10180 | batches   1776 / 2101 | lr 8.825e-03 | ms/batch 761.9 | tok/s   64514 | loss  3.72 | ppl     41.26
| epoch   5 step    10190 | batches   1786 / 2101 | lr 8.822e-03 | ms/batch 762.0 | tok/s   64504 | loss  3.70 | ppl     40.46
| epoch   5 step    10200 | batches   1796 / 2101 | lr 8.820e-03 | ms/batch 761.5 | tok/s   64544 | loss  3.70 | ppl     40.38
| epoch   5 step    10210 | batches   1806 / 2101 | lr 8.817e-03 | ms/batch 761.3 | tok/s   64560 | loss  3.71 | ppl     40.89
| epoch   5 step    10220 | batches   1816 / 2101 | lr 8.815e-03 | ms/batch 762.0 | tok/s   64505 | loss  3.69 | ppl     40.19
| epoch   5 step    10230 | batches   1826 / 2101 | lr 8.812e-03 | ms/batch 762.4 | tok/s   64472 | loss  3.71 | ppl     40.90
| epoch   5 step    10240 | batches   1836 / 2101 | lr 8.810e-03 | ms/batch 761.4 | tok/s   64554 | loss  3.74 | ppl     42.15
| epoch   5 step    10250 | batches   1846 / 2101 | lr 8.808e-03 | ms/batch 760.6 | tok/s   64619 | loss  3.74 | ppl     42.11
| epoch   5 step    10260 | batches   1856 / 2101 | lr 8.805e-03 | ms/batch 761.6 | tok/s   64539 | loss  3.71 | ppl     40.66
| epoch   5 step    10270 | batches   1866 / 2101 | lr 8.803e-03 | ms/batch 762.7 | tok/s   64445 | loss  3.73 | ppl     41.75
| epoch   5 step    10280 | batches   1876 / 2101 | lr 8.800e-03 | ms/batch 763.8 | tok/s   64353 | loss  3.71 | ppl     40.85
| epoch   5 step    10290 | batches   1886 / 2101 | lr 8.798e-03 | ms/batch 763.7 | tok/s   64362 | loss  3.72 | ppl     41.19
| epoch   5 step    10300 | batches   1896 / 2101 | lr 8.795e-03 | ms/batch 762.7 | tok/s   64445 | loss  3.69 | ppl     40.23
| epoch   5 step    10310 | batches   1906 / 2101 | lr 8.793e-03 | ms/batch 762.3 | tok/s   64475 | loss  3.66 | ppl     38.75
| epoch   5 step    10320 | batches   1916 / 2101 | lr 8.790e-03 | ms/batch 762.2 | tok/s   64487 | loss  3.67 | ppl     39.23
| epoch   5 step    10330 | batches   1926 / 2101 | lr 8.788e-03 | ms/batch 760.8 | tok/s   64604 | loss  3.67 | ppl     39.29
| epoch   5 step    10340 | batches   1936 / 2101 | lr 8.785e-03 | ms/batch 760.9 | tok/s   64596 | loss  3.68 | ppl     39.55
| epoch   5 step    10350 | batches   1946 / 2101 | lr 8.783e-03 | ms/batch 760.3 | tok/s   64645 | loss  3.70 | ppl     40.26
| epoch   5 step    10360 | batches   1956 / 2101 | lr 8.780e-03 | ms/batch 761.3 | tok/s   64561 | loss  3.66 | ppl     38.77
| epoch   5 step    10370 | batches   1966 / 2101 | lr 8.778e-03 | ms/batch 762.0 | tok/s   64508 | loss  3.67 | ppl     39.23
| epoch   5 step    10380 | batches   1976 / 2101 | lr 8.775e-03 | ms/batch 762.7 | tok/s   64445 | loss  3.70 | ppl     40.57
| epoch   5 step    10390 | batches   1986 / 2101 | lr 8.773e-03 | ms/batch 763.1 | tok/s   64415 | loss  3.70 | ppl     40.39
| epoch   5 step    10400 | batches   1996 / 2101 | lr 8.770e-03 | ms/batch 761.1 | tok/s   64580 | loss  3.65 | ppl     38.37
| epoch   5 step    10410 | batches   2006 / 2101 | lr 8.768e-03 | ms/batch 761.0 | tok/s   64592 | loss  3.67 | ppl     39.10
| epoch   5 step    10420 | batches   2016 / 2101 | lr 8.765e-03 | ms/batch 760.9 | tok/s   64597 | loss  3.69 | ppl     40.05
| epoch   5 step    10430 | batches   2026 / 2101 | lr 8.763e-03 | ms/batch 761.5 | tok/s   64544 | loss  3.68 | ppl     39.67
| epoch   5 step    10440 | batches   2036 / 2101 | lr 8.760e-03 | ms/batch 762.6 | tok/s   64452 | loss  3.68 | ppl     39.49
| epoch   5 step    10450 | batches   2046 / 2101 | lr 8.758e-03 | ms/batch 763.1 | tok/s   64412 | loss  3.66 | ppl     39.04
| epoch   5 step    10460 | batches   2056 / 2101 | lr 8.755e-03 | ms/batch 761.7 | tok/s   64533 | loss  3.66 | ppl     38.73
| epoch   5 step    10470 | batches   2066 / 2101 | lr 8.753e-03 | ms/batch 761.4 | tok/s   64556 | loss  3.69 | ppl     39.89
| epoch   5 step    10480 | batches   2076 / 2101 | lr 8.750e-03 | ms/batch 761.9 | tok/s   64514 | loss  3.68 | ppl     39.84
| epoch   5 step    10490 | batches   2086 / 2101 | lr 8.748e-03 | ms/batch 761.2 | tok/s   64570 | loss  3.70 | ppl     40.41
| epoch   5 step    10500 | batches   2096 / 2101 | lr 8.745e-03 | ms/batch 761.0 | tok/s   64588 | loss  3.68 | ppl     39.83
----------------------------------------------------------------------------------------------------
| Eval  21 at step    10500 | time:  1.24s | valid loss  3.50 | valid ppl    32.993
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/DP32_666/checkpoint_last.pt
Saving checkpoint to TF32/DP32_666/checkpoint_best.pt
| epoch   6 step    10510 | batches      5 / 2101 | lr 8.743e-03 | ms/batch 762.5 | tok/s   64512 | loss  3.72 | ppl     41.24
| epoch   6 step    10520 | batches     15 / 2101 | lr 8.740e-03 | ms/batch 761.2 | tok/s   64573 | loss  3.58 | ppl     35.98
| epoch   6 step    10530 | batches     25 / 2101 | lr 8.738e-03 | ms/batch 763.0 | tok/s   64424 | loss  3.61 | ppl     37.02
| epoch   6 step    10540 | batches     35 / 2101 | lr 8.735e-03 | ms/batch 761.4 | tok/s   64555 | loss  3.61 | ppl     36.88
| epoch   6 step    10550 | batches     45 / 2101 | lr 8.733e-03 | ms/batch 762.3 | tok/s   64477 | loss  3.61 | ppl     36.80
| epoch   6 step    10560 | batches     55 / 2101 | lr 8.730e-03 | ms/batch 763.0 | tok/s   64415 | loss  3.65 | ppl     38.30
| epoch   6 step    10570 | batches     65 / 2101 | lr 8.728e-03 | ms/batch 763.2 | tok/s   64404 | loss  3.63 | ppl     37.54
| epoch   6 step    10580 | batches     75 / 2101 | lr 8.725e-03 | ms/batch 761.6 | tok/s   64537 | loss  3.65 | ppl     38.34
| epoch   6 step    10590 | batches     85 / 2101 | lr 8.723e-03 | ms/batch 761.7 | tok/s   64529 | loss  3.63 | ppl     37.89
| epoch   6 step    10600 | batches     95 / 2101 | lr 8.720e-03 | ms/batch 761.7 | tok/s   64532 | loss  3.63 | ppl     37.86
| epoch   6 step    10610 | batches    105 / 2101 | lr 8.718e-03 | ms/batch 763.0 | tok/s   64416 | loss  3.63 | ppl     37.53
| epoch   6 step    10620 | batches    115 / 2101 | lr 8.715e-03 | ms/batch 762.8 | tok/s   64439 | loss  3.61 | ppl     37.05
| epoch   6 step    10630 | batches    125 / 2101 | lr 8.713e-03 | ms/batch 763.0 | tok/s   64424 | loss  3.62 | ppl     37.51
| epoch   6 step    10640 | batches    135 / 2101 | lr 8.710e-03 | ms/batch 761.6 | tok/s   64540 | loss  3.61 | ppl     36.82
| epoch   6 step    10650 | batches    145 / 2101 | lr 8.708e-03 | ms/batch 762.1 | tok/s   64498 | loss  3.60 | ppl     36.67
| epoch   6 step    10660 | batches    155 / 2101 | lr 8.705e-03 | ms/batch 760.3 | tok/s   64653 | loss  3.59 | ppl     36.06
| epoch   6 step    10670 | batches    165 / 2101 | lr 8.702e-03 | ms/batch 760.9 | tok/s   64598 | loss  3.58 | ppl     35.89
| epoch   6 step    10680 | batches    175 / 2101 | lr 8.700e-03 | ms/batch 760.3 | tok/s   64646 | loss  3.55 | ppl     34.80
| epoch   6 step    10690 | batches    185 / 2101 | lr 8.697e-03 | ms/batch 761.4 | tok/s   64557 | loss  3.58 | ppl     35.82
| epoch   6 step    10700 | batches    195 / 2101 | lr 8.695e-03 | ms/batch 761.4 | tok/s   64556 | loss  3.62 | ppl     37.44
| epoch   6 step    10710 | batches    205 / 2101 | lr 8.692e-03 | ms/batch 760.7 | tok/s   64617 | loss  3.62 | ppl     37.18
| epoch   6 step    10720 | batches    215 / 2101 | lr 8.690e-03 | ms/batch 760.3 | tok/s   64649 | loss  3.64 | ppl     37.97
| epoch   6 step    10730 | batches    225 / 2101 | lr 8.687e-03 | ms/batch 760.3 | tok/s   64646 | loss  3.64 | ppl     38.13
| epoch   6 step    10740 | batches    235 / 2101 | lr 8.685e-03 | ms/batch 761.1 | tok/s   64580 | loss  3.65 | ppl     38.56
| epoch   6 step    10750 | batches    245 / 2101 | lr 8.682e-03 | ms/batch 761.2 | tok/s   64573 | loss  3.64 | ppl     37.99
| epoch   6 step    10760 | batches    255 / 2101 | lr 8.679e-03 | ms/batch 763.0 | tok/s   64417 | loss  3.62 | ppl     37.18
| epoch   6 step    10770 | batches    265 / 2101 | lr 8.677e-03 | ms/batch 761.5 | tok/s   64544 | loss  3.59 | ppl     36.38
| epoch   6 step    10780 | batches    275 / 2101 | lr 8.674e-03 | ms/batch 759.9 | tok/s   64678 | loss  3.60 | ppl     36.69
| epoch   6 step    10790 | batches    285 / 2101 | lr 8.672e-03 | ms/batch 762.2 | tok/s   64484 | loss  3.59 | ppl     36.37
| epoch   6 step    10800 | batches    295 / 2101 | lr 8.669e-03 | ms/batch 762.4 | tok/s   64467 | loss  3.61 | ppl     37.09
| epoch   6 step    10810 | batches    305 / 2101 | lr 8.667e-03 | ms/batch 760.8 | tok/s   64609 | loss  3.61 | ppl     37.12
| epoch   6 step    10820 | batches    315 / 2101 | lr 8.664e-03 | ms/batch 760.2 | tok/s   64659 | loss  3.60 | ppl     36.77
| epoch   6 step    10830 | batches    325 / 2101 | lr 8.661e-03 | ms/batch 762.0 | tok/s   64508 | loss  3.61 | ppl     36.97
| epoch   6 step    10840 | batches    335 / 2101 | lr 8.659e-03 | ms/batch 762.0 | tok/s   64503 | loss  3.62 | ppl     37.43
| epoch   6 step    10850 | batches    345 / 2101 | lr 8.656e-03 | ms/batch 763.1 | tok/s   64408 | loss  3.68 | ppl     39.69
| epoch   6 step    10860 | batches    355 / 2101 | lr 8.654e-03 | ms/batch 762.1 | tok/s   64496 | loss  3.67 | ppl     39.10
| epoch   6 step    10870 | batches    365 / 2101 | lr 8.651e-03 | ms/batch 762.2 | tok/s   64490 | loss  3.65 | ppl     38.45
| epoch   6 step    10880 | batches    375 / 2101 | lr 8.648e-03 | ms/batch 761.6 | tok/s   64538 | loss  3.64 | ppl     38.06
| epoch   6 step    10890 | batches    385 / 2101 | lr 8.646e-03 | ms/batch 762.7 | tok/s   64442 | loss  3.67 | ppl     39.40
| epoch   6 step    10900 | batches    395 / 2101 | lr 8.643e-03 | ms/batch 761.2 | tok/s   64572 | loss  3.64 | ppl     37.98
| epoch   6 step    10910 | batches    405 / 2101 | lr 8.641e-03 | ms/batch 762.3 | tok/s   64479 | loss  3.57 | ppl     35.45
| epoch   6 step    10920 | batches    415 / 2101 | lr 8.638e-03 | ms/batch 762.6 | tok/s   64452 | loss  3.61 | ppl     37.01
| epoch   6 step    10930 | batches    425 / 2101 | lr 8.636e-03 | ms/batch 761.7 | tok/s   64531 | loss  3.65 | ppl     38.59
| epoch   6 step    10940 | batches    435 / 2101 | lr 8.633e-03 | ms/batch 760.4 | tok/s   64637 | loss  3.62 | ppl     37.40
| epoch   6 step    10950 | batches    445 / 2101 | lr 8.630e-03 | ms/batch 760.3 | tok/s   64648 | loss  3.64 | ppl     38.18
| epoch   6 step    10960 | batches    455 / 2101 | lr 8.628e-03 | ms/batch 761.4 | tok/s   64559 | loss  3.59 | ppl     36.21
| epoch   6 step    10970 | batches    465 / 2101 | lr 8.625e-03 | ms/batch 761.1 | tok/s   64585 | loss  3.62 | ppl     37.34
| epoch   6 step    10980 | batches    475 / 2101 | lr 8.622e-03 | ms/batch 761.6 | tok/s   64540 | loss  3.62 | ppl     37.49
| epoch   6 step    10990 | batches    485 / 2101 | lr 8.620e-03 | ms/batch 761.4 | tok/s   64551 | loss  3.65 | ppl     38.34
| epoch   6 step    11000 | batches    495 / 2101 | lr 8.617e-03 | ms/batch 763.0 | tok/s   64415 | loss  3.62 | ppl     37.39
----------------------------------------------------------------------------------------------------
| Eval  22 at step    11000 | time:  1.24s | valid loss  3.49 | valid ppl    32.627
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/DP32_666/checkpoint_last.pt
Saving checkpoint to TF32/DP32_666/checkpoint_best.pt
optimal compression parameters = [[], [128, 126, 23, 63, 46, 127, 127, 12, 73, 57], [115, 121, 12, 36, 21, 125, 127, 46, 49, 35], [87, 118, 8, 22, 18, 95, 100, 20, 33, 18], [76, 97, 10, 18, 9, 53, 60, 8, 19, 18], [8, 9, 8, 8, 12, 50, 49, 9, 13, 11], [29, 28, 9, 11, 9, 28, 36, 9, 9, 8], [36, 41, 10, 8, 10, 41, 55, 8, 13, 8], [30, 49, 9, 10, 12, 39, 40, 8, 9, 9], [8]]
Compression stats: iter 11000, total before compression 1919694930298, total after compression 136478866522, rate 14.065876858587119
Compression stats: iter 11000, total before compression 1919694930298, total after compression 136478866522, rate 14.065876858587119
Compression stats: iter 11000, total before compression 1919694930298, total after compression 136478866522, rate 14.065876858587119
Compression stats: iter 11000, total before compression 1919694930298, total after compression 136478866522, rate 14.065876858587119
| epoch   6 step    11010 | batches    505 / 2101 | lr 8.615e-03 | ms/batch 7505.2 | tok/s    6549 | loss  3.60 | ppl     36.61
| epoch   6 step    11020 | batches    515 / 2101 | lr 8.612e-03 | ms/batch 763.1 | tok/s   64411 | loss  3.64 | ppl     38.22
| epoch   6 step    11030 | batches    525 / 2101 | lr 8.609e-03 | ms/batch 763.2 | tok/s   64399 | loss  3.65 | ppl     38.28
| epoch   6 step    11040 | batches    535 / 2101 | lr 8.607e-03 | ms/batch 762.1 | tok/s   64496 | loss  3.62 | ppl     37.17
| epoch   6 step    11050 | batches    545 / 2101 | lr 8.604e-03 | ms/batch 762.2 | tok/s   64484 | loss  3.58 | ppl     35.99
| epoch   6 step    11060 | batches    555 / 2101 | lr 8.602e-03 | ms/batch 763.4 | tok/s   64388 | loss  3.62 | ppl     37.20
| epoch   6 step    11070 | batches    565 / 2101 | lr 8.599e-03 | ms/batch 762.0 | tok/s   64502 | loss  3.62 | ppl     37.52
| epoch   6 step    11080 | batches    575 / 2101 | lr 8.596e-03 | ms/batch 761.9 | tok/s   64511 | loss  3.59 | ppl     36.14
| epoch   6 step    11090 | batches    585 / 2101 | lr 8.594e-03 | ms/batch 762.6 | tok/s   64450 | loss  3.60 | ppl     36.63
| epoch   6 step    11100 | batches    595 / 2101 | lr 8.591e-03 | ms/batch 762.3 | tok/s   64475 | loss  3.61 | ppl     37.05
| epoch   6 step    11110 | batches    605 / 2101 | lr 8.588e-03 | ms/batch 762.8 | tok/s   64434 | loss  3.63 | ppl     37.68
| epoch   6 step    11120 | batches    615 / 2101 | lr 8.586e-03 | ms/batch 763.0 | tok/s   64417 | loss  3.64 | ppl     38.01
| epoch   6 step    11130 | batches    625 / 2101 | lr 8.583e-03 | ms/batch 761.2 | tok/s   64569 | loss  3.58 | ppl     35.80
| epoch   6 step    11140 | batches    635 / 2101 | lr 8.580e-03 | ms/batch 760.5 | tok/s   64632 | loss  3.58 | ppl     35.79
| epoch   6 step    11150 | batches    645 / 2101 | lr 8.578e-03 | ms/batch 761.2 | tok/s   64573 | loss  3.56 | ppl     35.24
| epoch   6 step    11160 | batches    655 / 2101 | lr 8.575e-03 | ms/batch 761.4 | tok/s   64558 | loss  3.61 | ppl     37.01
| epoch   6 step    11170 | batches    665 / 2101 | lr 8.573e-03 | ms/batch 760.6 | tok/s   64620 | loss  3.64 | ppl     38.15
| epoch   6 step    11180 | batches    675 / 2101 | lr 8.570e-03 | ms/batch 761.4 | tok/s   64555 | loss  3.69 | ppl     39.94
| epoch   6 step    11190 | batches    685 / 2101 | lr 8.567e-03 | ms/batch 761.0 | tok/s   64586 | loss  3.66 | ppl     38.98
| epoch   6 step    11200 | batches    695 / 2101 | lr 8.565e-03 | ms/batch 761.6 | tok/s   64539 | loss  3.65 | ppl     38.30
| epoch   6 step    11210 | batches    705 / 2101 | lr 8.562e-03 | ms/batch 761.9 | tok/s   64510 | loss  3.65 | ppl     38.46
| epoch   6 step    11220 | batches    715 / 2101 | lr 8.559e-03 | ms/batch 761.3 | tok/s   64564 | loss  3.61 | ppl     36.96
| epoch   6 step    11230 | batches    725 / 2101 | lr 8.557e-03 | ms/batch 761.6 | tok/s   64534 | loss  3.61 | ppl     37.15
| epoch   6 step    11240 | batches    735 / 2101 | lr 8.554e-03 | ms/batch 762.3 | tok/s   64479 | loss  3.61 | ppl     36.95
| epoch   6 step    11250 | batches    745 / 2101 | lr 8.551e-03 | ms/batch 762.5 | tok/s   64461 | loss  3.61 | ppl     36.93
| epoch   6 step    11260 | batches    755 / 2101 | lr 8.549e-03 | ms/batch 761.9 | tok/s   64515 | loss  3.60 | ppl     36.43
| epoch   6 step    11270 | batches    765 / 2101 | lr 8.546e-03 | ms/batch 761.4 | tok/s   64556 | loss  3.60 | ppl     36.64
| epoch   6 step    11280 | batches    775 / 2101 | lr 8.543e-03 | ms/batch 762.0 | tok/s   64503 | loss  3.61 | ppl     36.90
| epoch   6 step    11290 | batches    785 / 2101 | lr 8.541e-03 | ms/batch 762.2 | tok/s   64487 | loss  3.60 | ppl     36.48
| epoch   6 step    11300 | batches    795 / 2101 | lr 8.538e-03 | ms/batch 762.4 | tok/s   64471 | loss  3.59 | ppl     36.38
| epoch   6 step    11310 | batches    805 / 2101 | lr 8.535e-03 | ms/batch 762.1 | tok/s   64494 | loss  3.61 | ppl     36.89
| epoch   6 step    11320 | batches    815 / 2101 | lr 8.533e-03 | ms/batch 763.6 | tok/s   64371 | loss  3.61 | ppl     36.95
| epoch   6 step    11330 | batches    825 / 2101 | lr 8.530e-03 | ms/batch 762.2 | tok/s   64488 | loss  3.66 | ppl     38.69
| epoch   6 step    11340 | batches    835 / 2101 | lr 8.527e-03 | ms/batch 761.1 | tok/s   64576 | loss  3.65 | ppl     38.63
| epoch   6 step    11350 | batches    845 / 2101 | lr 8.525e-03 | ms/batch 761.3 | tok/s   64567 | loss  3.66 | ppl     38.97
| epoch   6 step    11360 | batches    855 / 2101 | lr 8.522e-03 | ms/batch 761.7 | tok/s   64528 | loss  3.66 | ppl     38.69
| epoch   6 step    11370 | batches    865 / 2101 | lr 8.519e-03 | ms/batch 762.4 | tok/s   64468 | loss  3.65 | ppl     38.57
| epoch   6 step    11380 | batches    875 / 2101 | lr 8.516e-03 | ms/batch 761.3 | tok/s   64563 | loss  3.64 | ppl     38.08
| epoch   6 step    11390 | batches    885 / 2101 | lr 8.514e-03 | ms/batch 760.0 | tok/s   64677 | loss  3.59 | ppl     36.34
| epoch   6 step    11400 | batches    895 / 2101 | lr 8.511e-03 | ms/batch 760.6 | tok/s   64621 | loss  3.60 | ppl     36.47
| epoch   6 step    11410 | batches    905 / 2101 | lr 8.508e-03 | ms/batch 760.9 | tok/s   64597 | loss  3.61 | ppl     36.99
| epoch   6 step    11420 | batches    915 / 2101 | lr 8.506e-03 | ms/batch 760.8 | tok/s   64602 | loss  3.63 | ppl     37.57
| epoch   6 step    11430 | batches    925 / 2101 | lr 8.503e-03 | ms/batch 761.5 | tok/s   64548 | loss  3.64 | ppl     38.21
| epoch   6 step    11440 | batches    935 / 2101 | lr 8.500e-03 | ms/batch 762.6 | tok/s   64457 | loss  3.63 | ppl     37.69
| epoch   6 step    11450 | batches    945 / 2101 | lr 8.498e-03 | ms/batch 761.8 | tok/s   64523 | loss  3.62 | ppl     37.32
| epoch   6 step    11460 | batches    955 / 2101 | lr 8.495e-03 | ms/batch 761.3 | tok/s   64567 | loss  3.61 | ppl     37.10
| epoch   6 step    11470 | batches    965 / 2101 | lr 8.492e-03 | ms/batch 762.1 | tok/s   64499 | loss  3.63 | ppl     37.72
| epoch   6 step    11480 | batches    975 / 2101 | lr 8.489e-03 | ms/batch 761.7 | tok/s   64529 | loss  3.63 | ppl     37.75
| epoch   6 step    11490 | batches    985 / 2101 | lr 8.487e-03 | ms/batch 762.7 | tok/s   64444 | loss  3.63 | ppl     37.67
| epoch   6 step    11500 | batches    995 / 2101 | lr 8.484e-03 | ms/batch 761.8 | tok/s   64518 | loss  3.65 | ppl     38.57
----------------------------------------------------------------------------------------------------
| Eval  23 at step    11500 | time:  1.24s | valid loss  3.47 | valid ppl    32.080
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/DP32_666/checkpoint_last.pt
Saving checkpoint to TF32/DP32_666/checkpoint_best.pt
| epoch   6 step    11510 | batches   1005 / 2101 | lr 8.481e-03 | ms/batch 762.2 | tok/s   64486 | loss  3.63 | ppl     37.83
| epoch   6 step    11520 | batches   1015 / 2101 | lr 8.479e-03 | ms/batch 761.6 | tok/s   64538 | loss  3.58 | ppl     35.90
| epoch   6 step    11530 | batches   1025 / 2101 | lr 8.476e-03 | ms/batch 761.5 | tok/s   64547 | loss  3.63 | ppl     37.67
| epoch   6 step    11540 | batches   1035 / 2101 | lr 8.473e-03 | ms/batch 762.0 | tok/s   64501 | loss  3.66 | ppl     38.68
| epoch   6 step    11550 | batches   1045 / 2101 | lr 8.470e-03 | ms/batch 760.5 | tok/s   64632 | loss  3.62 | ppl     37.25
| epoch   6 step    11560 | batches   1055 / 2101 | lr 8.468e-03 | ms/batch 761.2 | tok/s   64576 | loss  3.64 | ppl     37.99
| epoch   6 step    11570 | batches   1065 / 2101 | lr 8.465e-03 | ms/batch 761.6 | tok/s   64539 | loss  3.65 | ppl     38.40
| epoch   6 step    11580 | batches   1075 / 2101 | lr 8.462e-03 | ms/batch 761.5 | tok/s   64547 | loss  3.65 | ppl     38.58
| epoch   6 step    11590 | batches   1085 / 2101 | lr 8.460e-03 | ms/batch 761.7 | tok/s   64530 | loss  3.61 | ppl     37.05
| epoch   6 step    11600 | batches   1095 / 2101 | lr 8.457e-03 | ms/batch 761.6 | tok/s   64539 | loss  3.66 | ppl     38.69
| epoch   6 step    11610 | batches   1105 / 2101 | lr 8.454e-03 | ms/batch 763.0 | tok/s   64423 | loss  3.62 | ppl     37.17
| epoch   6 step    11620 | batches   1115 / 2101 | lr 8.451e-03 | ms/batch 761.4 | tok/s   64555 | loss  3.60 | ppl     36.48
| epoch   6 step    11630 | batches   1125 / 2101 | lr 8.449e-03 | ms/batch 761.0 | tok/s   64592 | loss  3.63 | ppl     37.59
| epoch   6 step    11640 | batches   1135 / 2101 | lr 8.446e-03 | ms/batch 760.1 | tok/s   64662 | loss  3.61 | ppl     37.09
| epoch   6 step    11650 | batches   1145 / 2101 | lr 8.443e-03 | ms/batch 760.6 | tok/s   64627 | loss  3.62 | ppl     37.22
| epoch   6 step    11660 | batches   1155 / 2101 | lr 8.440e-03 | ms/batch 760.1 | tok/s   64668 | loss  3.58 | ppl     35.88
| epoch   6 step    11670 | batches   1165 / 2101 | lr 8.438e-03 | ms/batch 761.2 | tok/s   64574 | loss  3.61 | ppl     36.82
| epoch   6 step    11680 | batches   1175 / 2101 | lr 8.435e-03 | ms/batch 761.3 | tok/s   64564 | loss  3.62 | ppl     37.16
| epoch   6 step    11690 | batches   1185 / 2101 | lr 8.432e-03 | ms/batch 760.7 | tok/s   64614 | loss  3.60 | ppl     36.66
| epoch   6 step    11700 | batches   1195 / 2101 | lr 8.429e-03 | ms/batch 759.9 | tok/s   64682 | loss  3.62 | ppl     37.26
| epoch   6 step    11710 | batches   1205 / 2101 | lr 8.427e-03 | ms/batch 761.4 | tok/s   64555 | loss  3.59 | ppl     36.38
| epoch   6 step    11720 | batches   1215 / 2101 | lr 8.424e-03 | ms/batch 762.2 | tok/s   64488 | loss  3.63 | ppl     37.83
| epoch   6 step    11730 | batches   1225 / 2101 | lr 8.421e-03 | ms/batch 762.2 | tok/s   64490 | loss  3.65 | ppl     38.36
| epoch   6 step    11740 | batches   1235 / 2101 | lr 8.418e-03 | ms/batch 762.9 | tok/s   64430 | loss  3.63 | ppl     37.87
| epoch   6 step    11750 | batches   1245 / 2101 | lr 8.416e-03 | ms/batch 761.3 | tok/s   64562 | loss  3.61 | ppl     36.98
| epoch   6 step    11760 | batches   1255 / 2101 | lr 8.413e-03 | ms/batch 761.7 | tok/s   64529 | loss  3.58 | ppl     36.03
| epoch   6 step    11770 | batches   1265 / 2101 | lr 8.410e-03 | ms/batch 760.8 | tok/s   64604 | loss  3.60 | ppl     36.73
| epoch   6 step    11780 | batches   1275 / 2101 | lr 8.407e-03 | ms/batch 761.6 | tok/s   64539 | loss  3.60 | ppl     36.73
| epoch   6 step    11790 | batches   1285 / 2101 | lr 8.405e-03 | ms/batch 761.1 | tok/s   64581 | loss  3.62 | ppl     37.21
| epoch   6 step    11800 | batches   1295 / 2101 | lr 8.402e-03 | ms/batch 762.4 | tok/s   64473 | loss  3.59 | ppl     36.35
| epoch   6 step    11810 | batches   1305 / 2101 | lr 8.399e-03 | ms/batch 761.5 | tok/s   64550 | loss  3.58 | ppl     35.97
| epoch   6 step    11820 | batches   1315 / 2101 | lr 8.396e-03 | ms/batch 762.4 | tok/s   64466 | loss  3.58 | ppl     36.00
| epoch   6 step    11830 | batches   1325 / 2101 | lr 8.393e-03 | ms/batch 762.0 | tok/s   64505 | loss  3.57 | ppl     35.69
| epoch   6 step    11840 | batches   1335 / 2101 | lr 8.391e-03 | ms/batch 762.0 | tok/s   64502 | loss  3.56 | ppl     35.31
| epoch   6 step    11850 | batches   1345 / 2101 | lr 8.388e-03 | ms/batch 761.4 | tok/s   64552 | loss  3.62 | ppl     37.30
| epoch   6 step    11860 | batches   1355 / 2101 | lr 8.385e-03 | ms/batch 760.3 | tok/s   64645 | loss  3.60 | ppl     36.76
| epoch   6 step    11870 | batches   1365 / 2101 | lr 8.382e-03 | ms/batch 760.1 | tok/s   64669 | loss  3.58 | ppl     35.94
| epoch   6 step    11880 | batches   1375 / 2101 | lr 8.380e-03 | ms/batch 761.1 | tok/s   64582 | loss  3.60 | ppl     36.43
| epoch   6 step    11890 | batches   1385 / 2101 | lr 8.377e-03 | ms/batch 762.7 | tok/s   64447 | loss  3.65 | ppl     38.55
| epoch   6 step    11900 | batches   1395 / 2101 | lr 8.374e-03 | ms/batch 760.8 | tok/s   64602 | loss  3.63 | ppl     37.78
| epoch   6 step    11910 | batches   1405 / 2101 | lr 8.371e-03 | ms/batch 761.2 | tok/s   64570 | loss  3.61 | ppl     37.00
| epoch   6 step    11920 | batches   1415 / 2101 | lr 8.368e-03 | ms/batch 760.5 | tok/s   64634 | loss  3.56 | ppl     35.32
| epoch   6 step    11930 | batches   1425 / 2101 | lr 8.366e-03 | ms/batch 760.8 | tok/s   64608 | loss  3.60 | ppl     36.42
| epoch   6 step    11940 | batches   1435 / 2101 | lr 8.363e-03 | ms/batch 761.0 | tok/s   64589 | loss  3.62 | ppl     37.23
| epoch   6 step    11950 | batches   1445 / 2101 | lr 8.360e-03 | ms/batch 761.1 | tok/s   64584 | loss  3.59 | ppl     36.13
| epoch   6 step    11960 | batches   1455 / 2101 | lr 8.357e-03 | ms/batch 760.6 | tok/s   64627 | loss  3.60 | ppl     36.78
| epoch   6 step    11970 | batches   1465 / 2101 | lr 8.354e-03 | ms/batch 762.0 | tok/s   64505 | loss  3.62 | ppl     37.16
| epoch   6 step    11980 | batches   1475 / 2101 | lr 8.352e-03 | ms/batch 760.8 | tok/s   64606 | loss  3.59 | ppl     36.19
| epoch   6 step    11990 | batches   1485 / 2101 | lr 8.349e-03 | ms/batch 760.4 | tok/s   64637 | loss  3.59 | ppl     36.10
| epoch   6 step    12000 | batches   1495 / 2101 | lr 8.346e-03 | ms/batch 763.4 | tok/s   64385 | loss  3.61 | ppl     36.94
----------------------------------------------------------------------------------------------------
| Eval  24 at step    12000 | time:  1.24s | valid loss  3.45 | valid ppl    31.612
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/DP32_666/checkpoint_last.pt
Saving checkpoint to TF32/DP32_666/checkpoint_best.pt
optimal compression parameters = [[], [126, 128, 26, 55, 42, 123, 128, 9, 68, 55], [125, 125, 12, 39, 20, 128, 124, 45, 49, 31], [98, 119, 10, 27, 18, 92, 90, 15, 32, 16], [80, 103, 9, 15, 10, 54, 61, 10, 14, 12], [9, 9, 8, 9, 11, 57, 49, 14, 14, 13], [25, 34, 8, 11, 9, 27, 29, 8, 11, 9], [39, 38, 9, 10, 8, 39, 56, 10, 12, 8], [30, 54, 9, 10, 12, 35, 43, 8, 13, 11], [8]]
| epoch   6 step    12010 | batches   1505 / 2101 | lr 8.343e-03 | ms/batch 7510.7 | tok/s    6544 | loss  3.59 | ppl     36.37
| epoch   6 step    12020 | batches   1515 / 2101 | lr 8.340e-03 | ms/batch 763.1 | tok/s   64409 | loss  3.60 | ppl     36.43
| epoch   6 step    12030 | batches   1525 / 2101 | lr 8.338e-03 | ms/batch 760.9 | tok/s   64594 | loss  3.59 | ppl     36.10
| epoch   6 step    12040 | batches   1535 / 2101 | lr 8.335e-03 | ms/batch 762.5 | tok/s   64466 | loss  3.59 | ppl     36.09
| epoch   6 step    12050 | batches   1545 / 2101 | lr 8.332e-03 | ms/batch 761.0 | tok/s   64585 | loss  3.59 | ppl     36.18
| epoch   6 step    12060 | batches   1555 / 2101 | lr 8.329e-03 | ms/batch 761.8 | tok/s   64519 | loss  3.61 | ppl     37.15
| epoch   6 step    12070 | batches   1565 / 2101 | lr 8.326e-03 | ms/batch 761.8 | tok/s   64519 | loss  3.62 | ppl     37.45
| epoch   6 step    12080 | batches   1575 / 2101 | lr 8.323e-03 | ms/batch 762.0 | tok/s   64507 | loss  3.66 | ppl     39.03
| epoch   6 step    12090 | batches   1585 / 2101 | lr 8.321e-03 | ms/batch 762.2 | tok/s   64488 | loss  3.61 | ppl     37.02
| epoch   6 step    12100 | batches   1595 / 2101 | lr 8.318e-03 | ms/batch 762.8 | tok/s   64436 | loss  3.63 | ppl     37.73
| epoch   6 step    12110 | batches   1605 / 2101 | lr 8.315e-03 | ms/batch 762.4 | tok/s   64470 | loss  3.61 | ppl     36.96
| epoch   6 step    12120 | batches   1615 / 2101 | lr 8.312e-03 | ms/batch 763.5 | tok/s   64378 | loss  3.61 | ppl     36.93
| epoch   6 step    12130 | batches   1625 / 2101 | lr 8.309e-03 | ms/batch 761.7 | tok/s   64530 | loss  3.61 | ppl     36.83
| epoch   6 step    12140 | batches   1635 / 2101 | lr 8.307e-03 | ms/batch 762.3 | tok/s   64479 | loss  3.64 | ppl     37.94
| epoch   6 step    12150 | batches   1645 / 2101 | lr 8.304e-03 | ms/batch 761.7 | tok/s   64533 | loss  3.59 | ppl     36.23
| epoch   6 step    12160 | batches   1655 / 2101 | lr 8.301e-03 | ms/batch 761.5 | tok/s   64542 | loss  3.58 | ppl     35.91
| epoch   6 step    12170 | batches   1665 / 2101 | lr 8.298e-03 | ms/batch 762.3 | tok/s   64481 | loss  3.59 | ppl     36.32
| epoch   6 step    12180 | batches   1675 / 2101 | lr 8.295e-03 | ms/batch 763.2 | tok/s   64402 | loss  3.63 | ppl     37.74
| epoch   6 step    12190 | batches   1685 / 2101 | lr 8.292e-03 | ms/batch 765.2 | tok/s   64235 | loss  3.66 | ppl     38.75
| epoch   6 step    12200 | batches   1695 / 2101 | lr 8.289e-03 | ms/batch 762.9 | tok/s   64426 | loss  3.67 | ppl     39.21
| epoch   6 step    12210 | batches   1705 / 2101 | lr 8.287e-03 | ms/batch 763.7 | tok/s   64360 | loss  3.68 | ppl     39.80
| epoch   6 step    12220 | batches   1715 / 2101 | lr 8.284e-03 | ms/batch 762.9 | tok/s   64426 | loss  3.64 | ppl     38.13
| epoch   6 step    12230 | batches   1725 / 2101 | lr 8.281e-03 | ms/batch 763.1 | tok/s   64409 | loss  3.64 | ppl     38.17
| epoch   6 step    12240 | batches   1735 / 2101 | lr 8.278e-03 | ms/batch 762.7 | tok/s   64446 | loss  3.62 | ppl     37.17
| epoch   6 step    12250 | batches   1745 / 2101 | lr 8.275e-03 | ms/batch 763.4 | tok/s   64390 | loss  3.59 | ppl     36.30
| epoch   6 step    12260 | batches   1755 / 2101 | lr 8.272e-03 | ms/batch 762.8 | tok/s   64438 | loss  3.62 | ppl     37.15
| epoch   6 step    12270 | batches   1765 / 2101 | lr 8.270e-03 | ms/batch 762.6 | tok/s   64449 | loss  3.65 | ppl     38.46
| epoch   6 step    12280 | batches   1775 / 2101 | lr 8.267e-03 | ms/batch 761.9 | tok/s   64511 | loss  3.60 | ppl     36.61
| epoch   6 step    12290 | batches   1785 / 2101 | lr 8.264e-03 | ms/batch 761.8 | tok/s   64523 | loss  3.60 | ppl     36.72
| epoch   6 step    12300 | batches   1795 / 2101 | lr 8.261e-03 | ms/batch 762.1 | tok/s   64494 | loss  3.63 | ppl     37.58
| epoch   6 step    12310 | batches   1805 / 2101 | lr 8.258e-03 | ms/batch 761.8 | tok/s   64517 | loss  3.64 | ppl     38.03
| epoch   6 step    12320 | batches   1815 / 2101 | lr 8.255e-03 | ms/batch 762.3 | tok/s   64475 | loss  3.61 | ppl     36.89
| epoch   6 step    12330 | batches   1825 / 2101 | lr 8.252e-03 | ms/batch 762.9 | tok/s   64425 | loss  3.60 | ppl     36.73
| epoch   6 step    12340 | batches   1835 / 2101 | lr 8.249e-03 | ms/batch 762.7 | tok/s   64449 | loss  3.63 | ppl     37.89
| epoch   6 step    12350 | batches   1845 / 2101 | lr 8.247e-03 | ms/batch 762.7 | tok/s   64445 | loss  3.64 | ppl     38.06
| epoch   6 step    12360 | batches   1855 / 2101 | lr 8.244e-03 | ms/batch 763.9 | tok/s   64347 | loss  3.63 | ppl     37.78
| epoch   6 step    12370 | batches   1865 / 2101 | lr 8.241e-03 | ms/batch 762.7 | tok/s   64442 | loss  3.64 | ppl     37.93
| epoch   6 step    12380 | batches   1875 / 2101 | lr 8.238e-03 | ms/batch 762.7 | tok/s   64449 | loss  3.64 | ppl     38.07
| epoch   6 step    12390 | batches   1885 / 2101 | lr 8.235e-03 | ms/batch 763.0 | tok/s   64424 | loss  3.65 | ppl     38.29
| epoch   6 step    12400 | batches   1895 / 2101 | lr 8.232e-03 | ms/batch 762.6 | tok/s   64454 | loss  3.61 | ppl     36.87
| epoch   6 step    12410 | batches   1905 / 2101 | lr 8.229e-03 | ms/batch 762.7 | tok/s   64443 | loss  3.60 | ppl     36.54
| epoch   6 step    12420 | batches   1915 / 2101 | lr 8.226e-03 | ms/batch 761.6 | tok/s   64541 | loss  3.57 | ppl     35.49
| epoch   6 step    12430 | batches   1925 / 2101 | lr 8.224e-03 | ms/batch 762.6 | tok/s   64454 | loss  3.65 | ppl     38.30
| epoch   6 step    12440 | batches   1935 / 2101 | lr 8.221e-03 | ms/batch 762.8 | tok/s   64441 | loss  3.63 | ppl     37.68
| epoch   6 step    12450 | batches   1945 / 2101 | lr 8.218e-03 | ms/batch 762.9 | tok/s   64425 | loss  3.58 | ppl     35.86
| epoch   6 step    12460 | batches   1955 / 2101 | lr 8.215e-03 | ms/batch 763.1 | tok/s   64408 | loss  3.60 | ppl     36.58
| epoch   6 step    12470 | batches   1965 / 2101 | lr 8.212e-03 | ms/batch 763.1 | tok/s   64412 | loss  3.59 | ppl     36.19
| epoch   6 step    12480 | batches   1975 / 2101 | lr 8.209e-03 | ms/batch 762.7 | tok/s   64445 | loss  3.60 | ppl     36.43
| epoch   6 step    12490 | batches   1985 / 2101 | lr 8.206e-03 | ms/batch 761.5 | tok/s   64545 | loss  3.62 | ppl     37.37
| epoch   6 step    12500 | batches   1995 / 2101 | lr 8.203e-03 | ms/batch 763.3 | tok/s   64399 | loss  3.64 | ppl     38.06
----------------------------------------------------------------------------------------------------
| Eval  25 at step    12500 | time:  1.24s | valid loss  3.43 | valid ppl    30.984
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/DP32_666/checkpoint_last.pt
Saving checkpoint to TF32/DP32_666/checkpoint_best.pt
| epoch   6 step    12510 | batches   2005 / 2101 | lr 8.200e-03 | ms/batch 762.7 | tok/s   64450 | loss  3.62 | ppl     37.47
| epoch   6 step    12520 | batches   2015 / 2101 | lr 8.198e-03 | ms/batch 762.2 | tok/s   64483 | loss  3.59 | ppl     36.20
| epoch   6 step    12530 | batches   2025 / 2101 | lr 8.195e-03 | ms/batch 762.5 | tok/s   64465 | loss  3.58 | ppl     35.99
| epoch   6 step    12540 | batches   2035 / 2101 | lr 8.192e-03 | ms/batch 762.9 | tok/s   64426 | loss  3.61 | ppl     36.79
| epoch   6 step    12550 | batches   2045 / 2101 | lr 8.189e-03 | ms/batch 762.9 | tok/s   64432 | loss  3.63 | ppl     37.72
| epoch   6 step    12560 | batches   2055 / 2101 | lr 8.186e-03 | ms/batch 762.2 | tok/s   64483 | loss  3.61 | ppl     37.04
| epoch   6 step    12570 | batches   2065 / 2101 | lr 8.183e-03 | ms/batch 762.7 | tok/s   64443 | loss  3.63 | ppl     37.84
| epoch   6 step    12580 | batches   2075 / 2101 | lr 8.180e-03 | ms/batch 763.7 | tok/s   64363 | loss  3.60 | ppl     36.70
| epoch   6 step    12590 | batches   2085 / 2101 | lr 8.177e-03 | ms/batch 762.1 | tok/s   64496 | loss  3.59 | ppl     36.41
| epoch   6 step    12600 | batches   2095 / 2101 | lr 8.174e-03 | ms/batch 762.1 | tok/s   64499 | loss  3.63 | ppl     37.70
| epoch   7 step    12610 | batches      4 / 2101 | lr 8.171e-03 | ms/batch 766.3 | tok/s   64210 | loss  3.73 | ppl     41.50
| epoch   7 step    12620 | batches     14 / 2101 | lr 8.168e-03 | ms/batch 764.5 | tok/s   64297 | loss  3.57 | ppl     35.48
| epoch   7 step    12630 | batches     24 / 2101 | lr 8.166e-03 | ms/batch 763.2 | tok/s   64401 | loss  3.53 | ppl     34.04
| epoch   7 step    12640 | batches     34 / 2101 | lr 8.163e-03 | ms/batch 762.3 | tok/s   64482 | loss  3.55 | ppl     34.83
| epoch   7 step    12650 | batches     44 / 2101 | lr 8.160e-03 | ms/batch 763.2 | tok/s   64400 | loss  3.56 | ppl     35.04
| epoch   7 step    12660 | batches     54 / 2101 | lr 8.157e-03 | ms/batch 763.3 | tok/s   64391 | loss  3.50 | ppl     33.03
| epoch   7 step    12670 | batches     64 / 2101 | lr 8.154e-03 | ms/batch 762.1 | tok/s   64497 | loss  3.52 | ppl     33.86
| epoch   7 step    12680 | batches     74 / 2101 | lr 8.151e-03 | ms/batch 762.4 | tok/s   64474 | loss  3.61 | ppl     37.08
| epoch   7 step    12690 | batches     84 / 2101 | lr 8.148e-03 | ms/batch 762.9 | tok/s   64428 | loss  3.58 | ppl     35.75
| epoch   7 step    12700 | batches     94 / 2101 | lr 8.145e-03 | ms/batch 761.8 | tok/s   64522 | loss  3.50 | ppl     33.21
| epoch   7 step    12710 | batches    104 / 2101 | lr 8.142e-03 | ms/batch 763.3 | tok/s   64396 | loss  3.53 | ppl     34.06
| epoch   7 step    12720 | batches    114 / 2101 | lr 8.139e-03 | ms/batch 762.7 | tok/s   64444 | loss  3.53 | ppl     34.23
| epoch   7 step    12730 | batches    124 / 2101 | lr 8.136e-03 | ms/batch 762.5 | tok/s   64461 | loss  3.47 | ppl     32.29
| epoch   7 step    12740 | batches    134 / 2101 | lr 8.133e-03 | ms/batch 763.3 | tok/s   64395 | loss  3.50 | ppl     33.05
| epoch   7 step    12750 | batches    144 / 2101 | lr 8.130e-03 | ms/batch 763.5 | tok/s   64381 | loss  3.52 | ppl     33.81
| epoch   7 step    12760 | batches    154 / 2101 | lr 8.127e-03 | ms/batch 762.9 | tok/s   64427 | loss  3.55 | ppl     34.84
| epoch   7 step    12770 | batches    164 / 2101 | lr 8.124e-03 | ms/batch 763.1 | tok/s   64414 | loss  3.58 | ppl     35.70
| epoch   7 step    12780 | batches    174 / 2101 | lr 8.122e-03 | ms/batch 762.7 | tok/s   64445 | loss  3.57 | ppl     35.47
| epoch   7 step    12790 | batches    184 / 2101 | lr 8.119e-03 | ms/batch 762.8 | tok/s   64440 | loss  3.56 | ppl     35.28
| epoch   7 step    12800 | batches    194 / 2101 | lr 8.116e-03 | ms/batch 762.2 | tok/s   64486 | loss  3.53 | ppl     34.27
| epoch   7 step    12810 | batches    204 / 2101 | lr 8.113e-03 | ms/batch 764.7 | tok/s   64277 | loss  3.53 | ppl     34.07
| epoch   7 step    12820 | batches    214 / 2101 | lr 8.110e-03 | ms/batch 763.3 | tok/s   64397 | loss  3.58 | ppl     35.75
| epoch   7 step    12830 | batches    224 / 2101 | lr 8.107e-03 | ms/batch 762.6 | tok/s   64451 | loss  3.55 | ppl     34.73
| epoch   7 step    12840 | batches    234 / 2101 | lr 8.104e-03 | ms/batch 763.6 | tok/s   64372 | loss  3.57 | ppl     35.61
| epoch   7 step    12850 | batches    244 / 2101 | lr 8.101e-03 | ms/batch 763.3 | tok/s   64390 | loss  3.58 | ppl     35.77
| epoch   7 step    12860 | batches    254 / 2101 | lr 8.098e-03 | ms/batch 761.5 | tok/s   64549 | loss  3.58 | ppl     35.95
| epoch   7 step    12870 | batches    264 / 2101 | lr 8.095e-03 | ms/batch 762.4 | tok/s   64474 | loss  3.57 | ppl     35.47
| epoch   7 step    12880 | batches    274 / 2101 | lr 8.092e-03 | ms/batch 761.6 | tok/s   64536 | loss  3.58 | ppl     35.90
| epoch   7 step    12890 | batches    284 / 2101 | lr 8.089e-03 | ms/batch 761.8 | tok/s   64524 | loss  3.54 | ppl     34.57
| epoch   7 step    12900 | batches    294 / 2101 | lr 8.086e-03 | ms/batch 761.8 | tok/s   64517 | loss  3.53 | ppl     34.09
| epoch   7 step    12910 | batches    304 / 2101 | lr 8.083e-03 | ms/batch 762.9 | tok/s   64425 | loss  3.57 | ppl     35.58
| epoch   7 step    12920 | batches    314 / 2101 | lr 8.080e-03 | ms/batch 762.7 | tok/s   64448 | loss  3.59 | ppl     36.09
| epoch   7 step    12930 | batches    324 / 2101 | lr 8.077e-03 | ms/batch 762.8 | tok/s   64437 | loss  3.57 | ppl     35.53
| epoch   7 step    12940 | batches    334 / 2101 | lr 8.074e-03 | ms/batch 763.6 | tok/s   64368 | loss  3.53 | ppl     34.15
| epoch   7 step    12950 | batches    344 / 2101 | lr 8.071e-03 | ms/batch 762.3 | tok/s   64482 | loss  3.54 | ppl     34.45
| epoch   7 step    12960 | batches    354 / 2101 | lr 8.068e-03 | ms/batch 762.7 | tok/s   64441 | loss  3.57 | ppl     35.35
| epoch   7 step    12970 | batches    364 / 2101 | lr 8.065e-03 | ms/batch 762.1 | tok/s   64494 | loss  3.53 | ppl     34.17
| epoch   7 step    12980 | batches    374 / 2101 | lr 8.062e-03 | ms/batch 762.7 | tok/s   64444 | loss  3.55 | ppl     34.73
| epoch   7 step    12990 | batches    384 / 2101 | lr 8.059e-03 | ms/batch 761.4 | tok/s   64552 | loss  3.54 | ppl     34.58
| epoch   7 step    13000 | batches    394 / 2101 | lr 8.056e-03 | ms/batch 764.6 | tok/s   64284 | loss  3.55 | ppl     34.95
----------------------------------------------------------------------------------------------------
| Eval  26 at step    13000 | time:  1.24s | valid loss  3.43 | valid ppl    30.934
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/DP32_666/checkpoint_last.pt
Saving checkpoint to TF32/DP32_666/checkpoint_best.pt
optimal compression parameters = [[], [126, 127, 29, 60, 46, 127, 127, 9, 66, 54], [117, 128, 14, 39, 24, 128, 128, 44, 46, 34], [92, 120, 10, 22, 13, 96, 97, 15, 30, 21], [72, 95, 9, 17, 12, 52, 67, 10, 15, 14], [9, 9, 8, 10, 10, 49, 52, 8, 13, 11], [21, 26, 8, 8, 10, 33, 30, 8, 10, 9], [33, 46, 8, 10, 9, 38, 49, 9, 10, 10], [34, 56, 9, 13, 10, 30, 40, 8, 8, 9], [8]]
| epoch   7 step    13010 | batches    404 / 2101 | lr 8.053e-03 | ms/batch 7506.8 | tok/s    6548 | loss  3.57 | ppl     35.49
| epoch   7 step    13020 | batches    414 / 2101 | lr 8.050e-03 | ms/batch 763.3 | tok/s   64396 | loss  3.54 | ppl     34.58
| epoch   7 step    13030 | batches    424 / 2101 | lr 8.047e-03 | ms/batch 763.0 | tok/s   64421 | loss  3.52 | ppl     33.62
| epoch   7 step    13040 | batches    434 / 2101 | lr 8.044e-03 | ms/batch 761.8 | tok/s   64519 | loss  3.50 | ppl     33.08
| epoch   7 step    13050 | batches    444 / 2101 | lr 8.041e-03 | ms/batch 763.7 | tok/s   64363 | loss  3.53 | ppl     34.19
| epoch   7 step    13060 | batches    454 / 2101 | lr 8.038e-03 | ms/batch 763.4 | tok/s   64385 | loss  3.51 | ppl     33.59
| epoch   7 step    13070 | batches    464 / 2101 | lr 8.035e-03 | ms/batch 764.0 | tok/s   64335 | loss  3.53 | ppl     34.09
| epoch   7 step    13080 | batches    474 / 2101 | lr 8.032e-03 | ms/batch 763.7 | tok/s   64365 | loss  3.53 | ppl     34.14
| epoch   7 step    13090 | batches    484 / 2101 | lr 8.029e-03 | ms/batch 763.6 | tok/s   64367 | loss  3.55 | ppl     34.89
| epoch   7 step    13100 | batches    494 / 2101 | lr 8.026e-03 | ms/batch 761.8 | tok/s   64517 | loss  3.54 | ppl     34.41
| epoch   7 step    13110 | batches    504 / 2101 | lr 8.023e-03 | ms/batch 762.6 | tok/s   64457 | loss  3.57 | ppl     35.42
| epoch   7 step    13120 | batches    514 / 2101 | lr 8.020e-03 | ms/batch 761.0 | tok/s   64588 | loss  3.55 | ppl     34.67
| epoch   7 step    13130 | batches    524 / 2101 | lr 8.017e-03 | ms/batch 761.6 | tok/s   64541 | loss  3.55 | ppl     34.81
| epoch   7 step    13140 | batches    534 / 2101 | lr 8.014e-03 | ms/batch 761.6 | tok/s   64541 | loss  3.57 | ppl     35.45
| epoch   7 step    13150 | batches    544 / 2101 | lr 8.011e-03 | ms/batch 762.9 | tok/s   64430 | loss  3.60 | ppl     36.49
| epoch   7 step    13160 | batches    554 / 2101 | lr 8.008e-03 | ms/batch 761.2 | tok/s   64573 | loss  3.55 | ppl     34.85
| epoch   7 step    13170 | batches    564 / 2101 | lr 8.005e-03 | ms/batch 762.3 | tok/s   64478 | loss  3.53 | ppl     34.27
| epoch   7 step    13180 | batches    574 / 2101 | lr 8.002e-03 | ms/batch 761.5 | tok/s   64550 | loss  3.50 | ppl     33.03
| epoch   7 step    13190 | batches    584 / 2101 | lr 7.999e-03 | ms/batch 763.1 | tok/s   64413 | loss  3.53 | ppl     34.03
| epoch   7 step    13200 | batches    594 / 2101 | lr 7.996e-03 | ms/batch 762.3 | tok/s   64475 | loss  3.52 | ppl     33.88
| epoch   7 step    13210 | batches    604 / 2101 | lr 7.993e-03 | ms/batch 763.4 | tok/s   64385 | loss  3.51 | ppl     33.50
| epoch   7 step    13220 | batches    614 / 2101 | lr 7.990e-03 | ms/batch 763.5 | tok/s   64379 | loss  3.55 | ppl     34.67
| epoch   7 step    13230 | batches    624 / 2101 | lr 7.987e-03 | ms/batch 763.4 | tok/s   64382 | loss  3.56 | ppl     35.18
| epoch   7 step    13240 | batches    634 / 2101 | lr 7.984e-03 | ms/batch 762.5 | tok/s   64462 | loss  3.56 | ppl     35.14
| epoch   7 step    13250 | batches    644 / 2101 | lr 7.981e-03 | ms/batch 762.5 | tok/s   64465 | loss  3.56 | ppl     35.09
| epoch   7 step    13260 | batches    654 / 2101 | lr 7.978e-03 | ms/batch 762.0 | tok/s   64504 | loss  3.55 | ppl     34.75
| epoch   7 step    13270 | batches    664 / 2101 | lr 7.975e-03 | ms/batch 762.4 | tok/s   64468 | loss  3.52 | ppl     33.91
| epoch   7 step    13280 | batches    674 / 2101 | lr 7.972e-03 | ms/batch 762.2 | tok/s   64489 | loss  3.51 | ppl     33.42
| epoch   7 step    13290 | batches    684 / 2101 | lr 7.969e-03 | ms/batch 762.5 | tok/s   64462 | loss  3.52 | ppl     33.69
| epoch   7 step    13300 | batches    694 / 2101 | lr 7.966e-03 | ms/batch 763.3 | tok/s   64397 | loss  3.51 | ppl     33.56
| epoch   7 step    13310 | batches    704 / 2101 | lr 7.963e-03 | ms/batch 763.6 | tok/s   64373 | loss  3.54 | ppl     34.57
| epoch   7 step    13320 | batches    714 / 2101 | lr 7.960e-03 | ms/batch 763.1 | tok/s   64414 | loss  3.55 | ppl     34.89
| epoch   7 step    13330 | batches    724 / 2101 | lr 7.957e-03 | ms/batch 762.4 | tok/s   64470 | loss  3.56 | ppl     35.23
| epoch   7 step    13340 | batches    734 / 2101 | lr 7.954e-03 | ms/batch 762.1 | tok/s   64499 | loss  3.58 | ppl     35.92
| epoch   7 step    13350 | batches    744 / 2101 | lr 7.951e-03 | ms/batch 762.0 | tok/s   64506 | loss  3.56 | ppl     35.34
| epoch   7 step    13360 | batches    754 / 2101 | lr 7.948e-03 | ms/batch 761.9 | tok/s   64516 | loss  3.53 | ppl     34.25
| epoch   7 step    13370 | batches    764 / 2101 | lr 7.945e-03 | ms/batch 761.5 | tok/s   64550 | loss  3.53 | ppl     34.19
| epoch   7 step    13380 | batches    774 / 2101 | lr 7.942e-03 | ms/batch 761.7 | tok/s   64527 | loss  3.57 | ppl     35.60
| epoch   7 step    13390 | batches    784 / 2101 | lr 7.939e-03 | ms/batch 761.4 | tok/s   64557 | loss  3.56 | ppl     35.31
| epoch   7 step    13400 | batches    794 / 2101 | lr 7.936e-03 | ms/batch 761.5 | tok/s   64547 | loss  3.57 | ppl     35.44
| epoch   7 step    13410 | batches    804 / 2101 | lr 7.933e-03 | ms/batch 762.3 | tok/s   64483 | loss  3.60 | ppl     36.44
| epoch   7 step    13420 | batches    814 / 2101 | lr 7.930e-03 | ms/batch 761.0 | tok/s   64589 | loss  3.59 | ppl     36.25
| epoch   7 step    13430 | batches    824 / 2101 | lr 7.927e-03 | ms/batch 760.7 | tok/s   64615 | loss  3.56 | ppl     35.32
| epoch   7 step    13440 | batches    834 / 2101 | lr 7.923e-03 | ms/batch 760.8 | tok/s   64604 | loss  3.55 | ppl     34.95
| epoch   7 step    13450 | batches    844 / 2101 | lr 7.920e-03 | ms/batch 760.9 | tok/s   64594 | loss  3.52 | ppl     33.89
| epoch   7 step    13460 | batches    854 / 2101 | lr 7.917e-03 | ms/batch 761.5 | tok/s   64548 | loss  3.53 | ppl     34.08
| epoch   7 step    13470 | batches    864 / 2101 | lr 7.914e-03 | ms/batch 759.7 | tok/s   64699 | loss  3.48 | ppl     32.53
| epoch   7 step    13480 | batches    874 / 2101 | lr 7.911e-03 | ms/batch 760.3 | tok/s   64650 | loss  3.51 | ppl     33.36
| epoch   7 step    13490 | batches    884 / 2101 | lr 7.908e-03 | ms/batch 760.3 | tok/s   64646 | loss  3.54 | ppl     34.50
| epoch   7 step    13500 | batches    894 / 2101 | lr 7.905e-03 | ms/batch 761.3 | tok/s   64561 | loss  3.50 | ppl     33.21
----------------------------------------------------------------------------------------------------
| Eval  27 at step    13500 | time:  1.24s | valid loss  3.42 | valid ppl    30.451
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/DP32_666/checkpoint_last.pt
Saving checkpoint to TF32/DP32_666/checkpoint_best.pt
| epoch   7 step    13510 | batches    904 / 2101 | lr 7.902e-03 | ms/batch 761.2 | tok/s   64576 | loss  3.49 | ppl     32.79
| epoch   7 step    13520 | batches    914 / 2101 | lr 7.899e-03 | ms/batch 761.2 | tok/s   64568 | loss  3.53 | ppl     34.28
| epoch   7 step    13530 | batches    924 / 2101 | lr 7.896e-03 | ms/batch 762.1 | tok/s   64493 | loss  3.55 | ppl     34.66
| epoch   7 step    13540 | batches    934 / 2101 | lr 7.893e-03 | ms/batch 761.1 | tok/s   64584 | loss  3.56 | ppl     35.33
| epoch   7 step    13550 | batches    944 / 2101 | lr 7.890e-03 | ms/batch 760.8 | tok/s   64604 | loss  3.52 | ppl     33.91
| epoch   7 step    13560 | batches    954 / 2101 | lr 7.887e-03 | ms/batch 761.4 | tok/s   64555 | loss  3.51 | ppl     33.35
| epoch   7 step    13570 | batches    964 / 2101 | lr 7.884e-03 | ms/batch 761.5 | tok/s   64547 | loss  3.58 | ppl     35.80
| epoch   7 step    13580 | batches    974 / 2101 | lr 7.881e-03 | ms/batch 762.1 | tok/s   64496 | loss  3.60 | ppl     36.72
| epoch   7 step    13590 | batches    984 / 2101 | lr 7.877e-03 | ms/batch 762.8 | tok/s   64437 | loss  3.57 | ppl     35.52
| epoch   7 step    13600 | batches    994 / 2101 | lr 7.874e-03 | ms/batch 763.1 | tok/s   64414 | loss  3.54 | ppl     34.46
| epoch   7 step    13610 | batches   1004 / 2101 | lr 7.871e-03 | ms/batch 762.3 | tok/s   64482 | loss  3.56 | ppl     35.07
| epoch   7 step    13620 | batches   1014 / 2101 | lr 7.868e-03 | ms/batch 762.8 | tok/s   64438 | loss  3.58 | ppl     35.76
| epoch   7 step    13630 | batches   1024 / 2101 | lr 7.865e-03 | ms/batch 762.4 | tok/s   64472 | loss  3.56 | ppl     35.18
| epoch   7 step    13640 | batches   1034 / 2101 | lr 7.862e-03 | ms/batch 763.3 | tok/s   64391 | loss  3.60 | ppl     36.46
| epoch   7 step    13650 | batches   1044 / 2101 | lr 7.859e-03 | ms/batch 763.0 | tok/s   64419 | loss  3.59 | ppl     36.31
| epoch   7 step    13660 | batches   1054 / 2101 | lr 7.856e-03 | ms/batch 762.9 | tok/s   64431 | loss  3.57 | ppl     35.57
| epoch   7 step    13670 | batches   1064 / 2101 | lr 7.853e-03 | ms/batch 762.7 | tok/s   64448 | loss  3.60 | ppl     36.74
| epoch   7 step    13680 | batches   1074 / 2101 | lr 7.850e-03 | ms/batch 763.1 | tok/s   64415 | loss  3.59 | ppl     36.14
| epoch   7 step    13690 | batches   1084 / 2101 | lr 7.847e-03 | ms/batch 762.8 | tok/s   64433 | loss  3.57 | ppl     35.40
| epoch   7 step    13700 | batches   1094 / 2101 | lr 7.844e-03 | ms/batch 763.2 | tok/s   64406 | loss  3.55 | ppl     34.86
| epoch   7 step    13710 | batches   1104 / 2101 | lr 7.840e-03 | ms/batch 761.9 | tok/s   64513 | loss  3.55 | ppl     34.79
| epoch   7 step    13720 | batches   1114 / 2101 | lr 7.837e-03 | ms/batch 762.1 | tok/s   64500 | loss  3.51 | ppl     33.34
| epoch   7 step    13730 | batches   1124 / 2101 | lr 7.834e-03 | ms/batch 761.7 | tok/s   64529 | loss  3.50 | ppl     33.08
| epoch   7 step    13740 | batches   1134 / 2101 | lr 7.831e-03 | ms/batch 762.1 | tok/s   64492 | loss  3.49 | ppl     32.83
| epoch   7 step    13750 | batches   1144 / 2101 | lr 7.828e-03 | ms/batch 762.3 | tok/s   64477 | loss  3.53 | ppl     34.10
| epoch   7 step    13760 | batches   1154 / 2101 | lr 7.825e-03 | ms/batch 763.5 | tok/s   64378 | loss  3.57 | ppl     35.58
| epoch   7 step    13770 | batches   1164 / 2101 | lr 7.822e-03 | ms/batch 761.8 | tok/s   64519 | loss  3.57 | ppl     35.69
| epoch   7 step    13780 | batches   1174 / 2101 | lr 7.819e-03 | ms/batch 762.4 | tok/s   64473 | loss  3.52 | ppl     33.89
| epoch   7 step    13790 | batches   1184 / 2101 | lr 7.816e-03 | ms/batch 763.1 | tok/s   64407 | loss  3.57 | ppl     35.60
| epoch   7 step    13800 | batches   1194 / 2101 | lr 7.812e-03 | ms/batch 762.4 | tok/s   64471 | loss  3.55 | ppl     34.91
| epoch   7 step    13810 | batches   1204 / 2101 | lr 7.809e-03 | ms/batch 762.5 | tok/s   64461 | loss  3.57 | ppl     35.42
| epoch   7 step    13820 | batches   1214 / 2101 | lr 7.806e-03 | ms/batch 762.4 | tok/s   64469 | loss  3.58 | ppl     35.70
| epoch   7 step    13830 | batches   1224 / 2101 | lr 7.803e-03 | ms/batch 761.7 | tok/s   64529 | loss  3.54 | ppl     34.45
| epoch   7 step    13840 | batches   1234 / 2101 | lr 7.800e-03 | ms/batch 761.5 | tok/s   64547 | loss  3.55 | ppl     34.97
| epoch   7 step    13850 | batches   1244 / 2101 | lr 7.797e-03 | ms/batch 760.1 | tok/s   64663 | loss  3.51 | ppl     33.58
| epoch   7 step    13860 | batches   1254 / 2101 | lr 7.794e-03 | ms/batch 763.0 | tok/s   64418 | loss  3.56 | ppl     35.09
| epoch   7 step    13870 | batches   1264 / 2101 | lr 7.791e-03 | ms/batch 762.3 | tok/s   64476 | loss  3.54 | ppl     34.45
| epoch   7 step    13880 | batches   1274 / 2101 | lr 7.788e-03 | ms/batch 761.9 | tok/s   64513 | loss  3.54 | ppl     34.62
| epoch   7 step    13890 | batches   1284 / 2101 | lr 7.784e-03 | ms/batch 762.3 | tok/s   64475 | loss  3.54 | ppl     34.37
| epoch   7 step    13900 | batches   1294 / 2101 | lr 7.781e-03 | ms/batch 761.9 | tok/s   64513 | loss  3.53 | ppl     34.22
| epoch   7 step    13910 | batches   1304 / 2101 | lr 7.778e-03 | ms/batch 762.0 | tok/s   64508 | loss  3.51 | ppl     33.52
| epoch   7 step    13920 | batches   1314 / 2101 | lr 7.775e-03 | ms/batch 761.1 | tok/s   64581 | loss  3.55 | ppl     34.85
| epoch   7 step    13930 | batches   1324 / 2101 | lr 7.772e-03 | ms/batch 762.1 | tok/s   64496 | loss  3.54 | ppl     34.31
| epoch   7 step    13940 | batches   1334 / 2101 | lr 7.769e-03 | ms/batch 761.6 | tok/s   64539 | loss  3.50 | ppl     33.28
| epoch   7 step    13950 | batches   1344 / 2101 | lr 7.766e-03 | ms/batch 761.7 | tok/s   64530 | loss  3.51 | ppl     33.53
| epoch   7 step    13960 | batches   1354 / 2101 | lr 7.763e-03 | ms/batch 761.7 | tok/s   64527 | loss  3.54 | ppl     34.54
| epoch   7 step    13970 | batches   1364 / 2101 | lr 7.759e-03 | ms/batch 761.7 | tok/s   64529 | loss  3.53 | ppl     34.17
| epoch   7 step    13980 | batches   1374 / 2101 | lr 7.756e-03 | ms/batch 761.5 | tok/s   64549 | loss  3.56 | ppl     35.17
| epoch   7 step    13990 | batches   1384 / 2101 | lr 7.753e-03 | ms/batch 762.1 | tok/s   64496 | loss  3.56 | ppl     35.08
| epoch   7 step    14000 | batches   1394 / 2101 | lr 7.750e-03 | ms/batch 763.0 | tok/s   64417 | loss  3.58 | ppl     35.79
----------------------------------------------------------------------------------------------------
| Eval  28 at step    14000 | time:  1.24s | valid loss  3.40 | valid ppl    30.024
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/DP32_666/checkpoint_last.pt
Saving checkpoint to TF32/DP32_666/checkpoint_best.pt
optimal compression parameters = [[], [127, 127, 20, 59, 44, 128, 127, 11, 67, 53], [118, 124, 14, 37, 23, 128, 124, 43, 45, 31], [88, 124, 9, 22, 14, 94, 101, 15, 27, 14], [77, 107, 9, 13, 8, 53, 62, 10, 10, 15], [8, 8, 9, 10, 8, 50, 55, 10, 12, 13], [30, 24, 10, 8, 10, 32, 29, 8, 11, 8], [29, 46, 8, 8, 10, 42, 53, 8, 11, 9], [32, 50, 9, 12, 9, 32, 40, 10, 9, 10], [8]]
| epoch   7 step    14010 | batches   1404 / 2101 | lr 7.747e-03 | ms/batch 7521.8 | tok/s    6535 | loss  3.53 | ppl     34.19
| epoch   7 step    14020 | batches   1414 / 2101 | lr 7.744e-03 | ms/batch 762.2 | tok/s   64484 | loss  3.55 | ppl     34.93
| epoch   7 step    14030 | batches   1424 / 2101 | lr 7.741e-03 | ms/batch 762.9 | tok/s   64430 | loss  3.55 | ppl     34.90
| epoch   7 step    14040 | batches   1434 / 2101 | lr 7.737e-03 | ms/batch 761.5 | tok/s   64548 | loss  3.54 | ppl     34.63
| epoch   7 step    14050 | batches   1444 / 2101 | lr 7.734e-03 | ms/batch 761.9 | tok/s   64511 | loss  3.50 | ppl     33.26
| epoch   7 step    14060 | batches   1454 / 2101 | lr 7.731e-03 | ms/batch 762.5 | tok/s   64464 | loss  3.53 | ppl     34.28
| epoch   7 step    14070 | batches   1464 / 2101 | lr 7.728e-03 | ms/batch 761.5 | tok/s   64542 | loss  3.56 | ppl     35.11
| epoch   7 step    14080 | batches   1474 / 2101 | lr 7.725e-03 | ms/batch 761.6 | tok/s   64542 | loss  3.54 | ppl     34.41
| epoch   7 step    14090 | batches   1484 / 2101 | lr 7.722e-03 | ms/batch 762.4 | tok/s   64470 | loss  3.51 | ppl     33.52
| epoch   7 step    14100 | batches   1494 / 2101 | lr 7.719e-03 | ms/batch 763.1 | tok/s   64413 | loss  3.56 | ppl     35.06
| epoch   7 step    14110 | batches   1504 / 2101 | lr 7.715e-03 | ms/batch 762.6 | tok/s   64456 | loss  3.57 | ppl     35.40
| epoch   7 step    14120 | batches   1514 / 2101 | lr 7.712e-03 | ms/batch 762.3 | tok/s   64476 | loss  3.53 | ppl     34.27
| epoch   7 step    14130 | batches   1524 / 2101 | lr 7.709e-03 | ms/batch 763.2 | tok/s   64406 | loss  3.52 | ppl     33.93
| epoch   7 step    14140 | batches   1534 / 2101 | lr 7.706e-03 | ms/batch 761.6 | tok/s   64539 | loss  3.56 | ppl     35.14
| epoch   7 step    14150 | batches   1544 / 2101 | lr 7.703e-03 | ms/batch 761.6 | tok/s   64538 | loss  3.57 | ppl     35.56
| epoch   7 step    14160 | batches   1554 / 2101 | lr 7.700e-03 | ms/batch 761.6 | tok/s   64539 | loss  3.53 | ppl     34.08
| epoch   7 step    14170 | batches   1564 / 2101 | lr 7.696e-03 | ms/batch 761.1 | tok/s   64581 | loss  3.57 | ppl     35.62
| epoch   7 step    14180 | batches   1574 / 2101 | lr 7.693e-03 | ms/batch 761.7 | tok/s   64534 | loss  3.53 | ppl     33.99
| epoch   7 step    14190 | batches   1584 / 2101 | lr 7.690e-03 | ms/batch 762.2 | tok/s   64490 | loss  3.53 | ppl     34.11
| epoch   7 step    14200 | batches   1594 / 2101 | lr 7.687e-03 | ms/batch 760.9 | tok/s   64598 | loss  3.52 | ppl     33.74
| epoch   7 step    14210 | batches   1604 / 2101 | lr 7.684e-03 | ms/batch 761.1 | tok/s   64577 | loss  3.56 | ppl     35.33
| epoch   7 step    14220 | batches   1614 / 2101 | lr 7.681e-03 | ms/batch 761.2 | tok/s   64573 | loss  3.57 | ppl     35.41
| epoch   7 step    14230 | batches   1624 / 2101 | lr 7.677e-03 | ms/batch 762.0 | tok/s   64507 | loss  3.54 | ppl     34.57
| epoch   7 step    14240 | batches   1634 / 2101 | lr 7.674e-03 | ms/batch 762.6 | tok/s   64451 | loss  3.53 | ppl     34.09
| epoch   7 step    14250 | batches   1644 / 2101 | lr 7.671e-03 | ms/batch 762.8 | tok/s   64436 | loss  3.53 | ppl     34.04
| epoch   7 step    14260 | batches   1654 / 2101 | lr 7.668e-03 | ms/batch 761.4 | tok/s   64555 | loss  3.53 | ppl     34.04
| epoch   7 step    14270 | batches   1664 / 2101 | lr 7.665e-03 | ms/batch 760.8 | tok/s   64605 | loss  3.51 | ppl     33.59
| epoch   7 step    14280 | batches   1674 / 2101 | lr 7.662e-03 | ms/batch 761.4 | tok/s   64558 | loss  3.54 | ppl     34.35
| epoch   7 step    14290 | batches   1684 / 2101 | lr 7.658e-03 | ms/batch 761.4 | tok/s   64556 | loss  3.57 | ppl     35.54
| epoch   7 step    14300 | batches   1694 / 2101 | lr 7.655e-03 | ms/batch 761.5 | tok/s   64550 | loss  3.56 | ppl     35.15
| epoch   7 step    14310 | batches   1704 / 2101 | lr 7.652e-03 | ms/batch 762.3 | tok/s   64478 | loss  3.56 | ppl     35.32
| epoch   7 step    14320 | batches   1714 / 2101 | lr 7.649e-03 | ms/batch 762.8 | tok/s   64433 | loss  3.54 | ppl     34.40
| epoch   7 step    14330 | batches   1724 / 2101 | lr 7.646e-03 | ms/batch 762.3 | tok/s   64482 | loss  3.53 | ppl     34.20
| epoch   7 step    14340 | batches   1734 / 2101 | lr 7.642e-03 | ms/batch 761.6 | tok/s   64539 | loss  3.55 | ppl     34.88
| epoch   7 step    14350 | batches   1744 / 2101 | lr 7.639e-03 | ms/batch 762.0 | tok/s   64502 | loss  3.54 | ppl     34.30
| epoch   7 step    14360 | batches   1754 / 2101 | lr 7.636e-03 | ms/batch 762.0 | tok/s   64508 | loss  3.56 | ppl     35.02
| epoch   7 step    14370 | batches   1764 / 2101 | lr 7.633e-03 | ms/batch 762.1 | tok/s   64494 | loss  3.56 | ppl     35.19
| epoch   7 step    14380 | batches   1774 / 2101 | lr 7.630e-03 | ms/batch 760.1 | tok/s   64667 | loss  3.53 | ppl     34.27
| epoch   7 step    14390 | batches   1784 / 2101 | lr 7.626e-03 | ms/batch 761.2 | tok/s   64569 | loss  3.54 | ppl     34.50
| epoch   7 step    14400 | batches   1794 / 2101 | lr 7.623e-03 | ms/batch 763.0 | tok/s   64420 | loss  3.59 | ppl     36.24
| epoch   7 step    14410 | batches   1804 / 2101 | lr 7.620e-03 | ms/batch 761.7 | tok/s   64526 | loss  3.57 | ppl     35.42
| epoch   7 step    14420 | batches   1814 / 2101 | lr 7.617e-03 | ms/batch 761.5 | tok/s   64547 | loss  3.57 | ppl     35.44
| epoch   7 step    14430 | batches   1824 / 2101 | lr 7.614e-03 | ms/batch 760.3 | tok/s   64645 | loss  3.53 | ppl     34.18
| epoch   7 step    14440 | batches   1834 / 2101 | lr 7.610e-03 | ms/batch 761.4 | tok/s   64558 | loss  3.53 | ppl     34.09
| epoch   7 step    14450 | batches   1844 / 2101 | lr 7.607e-03 | ms/batch 762.7 | tok/s   64445 | loss  3.57 | ppl     35.36
| epoch   7 step    14460 | batches   1854 / 2101 | lr 7.604e-03 | ms/batch 763.7 | tok/s   64360 | loss  3.59 | ppl     36.17
| epoch   7 step    14470 | batches   1864 / 2101 | lr 7.601e-03 | ms/batch 763.4 | tok/s   64384 | loss  3.54 | ppl     34.52
| epoch   7 step    14480 | batches   1874 / 2101 | lr 7.598e-03 | ms/batch 761.5 | tok/s   64543 | loss  3.56 | ppl     35.03
| epoch   7 step    14490 | batches   1884 / 2101 | lr 7.594e-03 | ms/batch 760.5 | tok/s   64633 | loss  3.52 | ppl     33.78
| epoch   7 step    14500 | batches   1894 / 2101 | lr 7.591e-03 | ms/batch 761.3 | tok/s   64560 | loss  3.52 | ppl     33.85
----------------------------------------------------------------------------------------------------
| Eval  29 at step    14500 | time:  1.24s | valid loss  3.39 | valid ppl    29.591
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/DP32_666/checkpoint_last.pt
Saving checkpoint to TF32/DP32_666/checkpoint_best.pt
| epoch   7 step    14510 | batches   1904 / 2101 | lr 7.588e-03 | ms/batch 762.2 | tok/s   64484 | loss  3.54 | ppl     34.32
| epoch   7 step    14520 | batches   1914 / 2101 | lr 7.585e-03 | ms/batch 761.0 | tok/s   64586 | loss  3.53 | ppl     34.03
| epoch   7 step    14530 | batches   1924 / 2101 | lr 7.582e-03 | ms/batch 761.1 | tok/s   64578 | loss  3.55 | ppl     34.98
| epoch   7 step    14540 | batches   1934 / 2101 | lr 7.578e-03 | ms/batch 760.9 | tok/s   64600 | loss  3.50 | ppl     33.24
| epoch   7 step    14550 | batches   1944 / 2101 | lr 7.575e-03 | ms/batch 761.7 | tok/s   64531 | loss  3.53 | ppl     34.26
| epoch   7 step    14560 | batches   1954 / 2101 | lr 7.572e-03 | ms/batch 760.8 | tok/s   64607 | loss  3.54 | ppl     34.46
| epoch   7 step    14570 | batches   1964 / 2101 | lr 7.569e-03 | ms/batch 761.4 | tok/s   64557 | loss  3.49 | ppl     32.79
| epoch   7 step    14580 | batches   1974 / 2101 | lr 7.566e-03 | ms/batch 761.9 | tok/s   64515 | loss  3.53 | ppl     34.02
| epoch   7 step    14590 | batches   1984 / 2101 | lr 7.562e-03 | ms/batch 761.9 | tok/s   64515 | loss  3.49 | ppl     32.92
| epoch   7 step    14600 | batches   1994 / 2101 | lr 7.559e-03 | ms/batch 762.1 | tok/s   64497 | loss  3.53 | ppl     34.04
| epoch   7 step    14610 | batches   2004 / 2101 | lr 7.556e-03 | ms/batch 762.1 | tok/s   64498 | loss  3.56 | ppl     35.22
| epoch   7 step    14620 | batches   2014 / 2101 | lr 7.553e-03 | ms/batch 762.9 | tok/s   64430 | loss  3.54 | ppl     34.46
| epoch   7 step    14630 | batches   2024 / 2101 | lr 7.549e-03 | ms/batch 762.4 | tok/s   64467 | loss  3.53 | ppl     34.11
| epoch   7 step    14640 | batches   2034 / 2101 | lr 7.546e-03 | ms/batch 761.8 | tok/s   64520 | loss  3.55 | ppl     34.81
| epoch   7 step    14650 | batches   2044 / 2101 | lr 7.543e-03 | ms/batch 761.7 | tok/s   64529 | loss  3.53 | ppl     33.99
| epoch   7 step    14660 | batches   2054 / 2101 | lr 7.540e-03 | ms/batch 761.9 | tok/s   64511 | loss  3.51 | ppl     33.42
| epoch   7 step    14670 | batches   2064 / 2101 | lr 7.536e-03 | ms/batch 762.0 | tok/s   64503 | loss  3.51 | ppl     33.39
| epoch   7 step    14680 | batches   2074 / 2101 | lr 7.533e-03 | ms/batch 762.1 | tok/s   64496 | loss  3.52 | ppl     33.90
| epoch   7 step    14690 | batches   2084 / 2101 | lr 7.530e-03 | ms/batch 761.9 | tok/s   64511 | loss  3.53 | ppl     33.97
| epoch   7 step    14700 | batches   2094 / 2101 | lr 7.527e-03 | ms/batch 762.5 | tok/s   64464 | loss  3.55 | ppl     34.89
| epoch   8 step    14710 | batches      3 / 2101 | lr 7.524e-03 | ms/batch 761.7 | tok/s   64613 | loss  3.70 | ppl     40.54
| epoch   8 step    14720 | batches     13 / 2101 | lr 7.520e-03 | ms/batch 760.4 | tok/s   64637 | loss  3.47 | ppl     32.10
| epoch   8 step    14730 | batches     23 / 2101 | lr 7.517e-03 | ms/batch 761.5 | tok/s   64543 | loss  3.49 | ppl     32.91
| epoch   8 step    14740 | batches     33 / 2101 | lr 7.514e-03 | ms/batch 761.0 | tok/s   64588 | loss  3.49 | ppl     32.82
| epoch   8 step    14750 | batches     43 / 2101 | lr 7.511e-03 | ms/batch 761.1 | tok/s   64580 | loss  3.47 | ppl     32.24
| epoch   8 step    14760 | batches     53 / 2101 | lr 7.507e-03 | ms/batch 761.9 | tok/s   64511 | loss  3.52 | ppl     33.83
| epoch   8 step    14770 | batches     63 / 2101 | lr 7.504e-03 | ms/batch 761.0 | tok/s   64589 | loss  3.49 | ppl     32.75
| epoch   8 step    14780 | batches     73 / 2101 | lr 7.501e-03 | ms/batch 761.4 | tok/s   64558 | loss  3.48 | ppl     32.50
| epoch   8 step    14790 | batches     83 / 2101 | lr 7.498e-03 | ms/batch 762.0 | tok/s   64502 | loss  3.47 | ppl     32.19
| epoch   8 step    14800 | batches     93 / 2101 | lr 7.494e-03 | ms/batch 762.0 | tok/s   64504 | loss  3.48 | ppl     32.47
| epoch   8 step    14810 | batches    103 / 2101 | lr 7.491e-03 | ms/batch 761.6 | tok/s   64535 | loss  3.50 | ppl     33.10
| epoch   8 step    14820 | batches    113 / 2101 | lr 7.488e-03 | ms/batch 761.9 | tok/s   64513 | loss  3.49 | ppl     32.75
| epoch   8 step    14830 | batches    123 / 2101 | lr 7.485e-03 | ms/batch 761.7 | tok/s   64532 | loss  3.49 | ppl     32.79
| epoch   8 step    14840 | batches    133 / 2101 | lr 7.481e-03 | ms/batch 761.3 | tok/s   64565 | loss  3.49 | ppl     32.92
| epoch   8 step    14850 | batches    143 / 2101 | lr 7.478e-03 | ms/batch 762.2 | tok/s   64489 | loss  3.52 | ppl     33.63
| epoch   8 step    14860 | batches    153 / 2101 | lr 7.475e-03 | ms/batch 762.3 | tok/s   64475 | loss  3.47 | ppl     32.29
| epoch   8 step    14870 | batches    163 / 2101 | lr 7.472e-03 | ms/batch 762.9 | tok/s   64425 | loss  3.50 | ppl     33.05
| epoch   8 step    14880 | batches    173 / 2101 | lr 7.468e-03 | ms/batch 761.9 | tok/s   64510 | loss  3.46 | ppl     31.97
| epoch   8 step    14890 | batches    183 / 2101 | lr 7.465e-03 | ms/batch 760.1 | tok/s   64665 | loss  3.45 | ppl     31.36
| epoch   8 step    14900 | batches    193 / 2101 | lr 7.462e-03 | ms/batch 760.9 | tok/s   64594 | loss  3.48 | ppl     32.47
| epoch   8 step    14910 | batches    203 / 2101 | lr 7.459e-03 | ms/batch 761.4 | tok/s   64553 | loss  3.47 | ppl     32.24
| epoch   8 step    14920 | batches    213 / 2101 | lr 7.455e-03 | ms/batch 760.2 | tok/s   64658 | loss  3.48 | ppl     32.35
| epoch   8 step    14930 | batches    223 / 2101 | lr 7.452e-03 | ms/batch 760.6 | tok/s   64620 | loss  3.45 | ppl     31.62
| epoch   8 step    14940 | batches    233 / 2101 | lr 7.449e-03 | ms/batch 761.0 | tok/s   64587 | loss  3.43 | ppl     30.92
| epoch   8 step    14950 | batches    243 / 2101 | lr 7.445e-03 | ms/batch 761.0 | tok/s   64590 | loss  3.39 | ppl     29.73
| epoch   8 step    14960 | batches    253 / 2101 | lr 7.442e-03 | ms/batch 760.6 | tok/s   64624 | loss  3.41 | ppl     30.29
| epoch   8 step    14970 | batches    263 / 2101 | lr 7.439e-03 | ms/batch 761.3 | tok/s   64564 | loss  3.44 | ppl     31.32
| epoch   8 step    14980 | batches    273 / 2101 | lr 7.436e-03 | ms/batch 761.2 | tok/s   64569 | loss  3.47 | ppl     32.29
| epoch   8 step    14990 | batches    283 / 2101 | lr 7.432e-03 | ms/batch 761.1 | tok/s   64577 | loss  3.48 | ppl     32.50
| epoch   8 step    15000 | batches    293 / 2101 | lr 7.429e-03 | ms/batch 762.8 | tok/s   64440 | loss  3.45 | ppl     31.63
----------------------------------------------------------------------------------------------------
| Eval  30 at step    15000 | time:  1.24s | valid loss  3.38 | valid ppl    29.251
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/DP32_666/checkpoint_last.pt
Saving checkpoint to TF32/DP32_666/checkpoint_best.pt
optimal compression parameters = [[], [127, 128, 25, 57, 40, 122, 128, 11, 69, 49], [117, 125, 14, 32, 17, 128, 128, 45, 46, 28], [95, 125, 11, 20, 12, 96, 99, 15, 24, 18], [75, 105, 8, 14, 10, 54, 57, 10, 17, 14], [8, 9, 8, 9, 10, 47, 58, 12, 10, 10], [22, 28, 9, 10, 9, 27, 28, 8, 8, 10], [32, 35, 10, 9, 10, 38, 52, 8, 10, 9], [33, 55, 9, 12, 10, 33, 38, 9, 11, 8], [8]]
| epoch   8 step    15010 | batches    303 / 2101 | lr 7.426e-03 | ms/batch 7502.3 | tok/s    6552 | loss  3.45 | ppl     31.65
| epoch   8 step    15020 | batches    313 / 2101 | lr 7.423e-03 | ms/batch 762.5 | tok/s   64461 | loss  3.46 | ppl     31.67
| epoch   8 step    15030 | batches    323 / 2101 | lr 7.419e-03 | ms/batch 761.6 | tok/s   64538 | loss  3.45 | ppl     31.57
| epoch   8 step    15040 | batches    333 / 2101 | lr 7.416e-03 | ms/batch 763.2 | tok/s   64400 | loss  3.46 | ppl     31.76
| epoch   8 step    15050 | batches    343 / 2101 | lr 7.413e-03 | ms/batch 763.3 | tok/s   64391 | loss  3.50 | ppl     33.06
| epoch   8 step    15060 | batches    353 / 2101 | lr 7.409e-03 | ms/batch 761.8 | tok/s   64517 | loss  3.45 | ppl     31.40
| epoch   8 step    15070 | batches    363 / 2101 | lr 7.406e-03 | ms/batch 762.0 | tok/s   64503 | loss  3.42 | ppl     30.69
| epoch   8 step    15080 | batches    373 / 2101 | lr 7.403e-03 | ms/batch 762.4 | tok/s   64474 | loss  3.45 | ppl     31.37
| epoch   8 step    15090 | batches    383 / 2101 | lr 7.400e-03 | ms/batch 762.4 | tok/s   64472 | loss  3.44 | ppl     31.19
| epoch   8 step    15100 | batches    393 / 2101 | lr 7.396e-03 | ms/batch 762.5 | tok/s   64458 | loss  3.44 | ppl     31.31
| epoch   8 step    15110 | batches    403 / 2101 | lr 7.393e-03 | ms/batch 761.5 | tok/s   64543 | loss  3.46 | ppl     31.96
| epoch   8 step    15120 | batches    413 / 2101 | lr 7.390e-03 | ms/batch 761.5 | tok/s   64544 | loss  3.47 | ppl     32.23
| epoch   8 step    15130 | batches    423 / 2101 | lr 7.386e-03 | ms/batch 763.1 | tok/s   64414 | loss  3.50 | ppl     32.95
| epoch   8 step    15140 | batches    433 / 2101 | lr 7.383e-03 | ms/batch 762.4 | tok/s   64469 | loss  3.50 | ppl     33.03
| epoch   8 step    15150 | batches    443 / 2101 | lr 7.380e-03 | ms/batch 761.3 | tok/s   64565 | loss  3.47 | ppl     32.24
| epoch   8 step    15160 | batches    453 / 2101 | lr 7.377e-03 | ms/batch 761.1 | tok/s   64577 | loss  3.46 | ppl     31.73
| epoch   8 step    15170 | batches    463 / 2101 | lr 7.373e-03 | ms/batch 761.6 | tok/s   64542 | loss  3.47 | ppl     32.03
| epoch   8 step    15180 | batches    473 / 2101 | lr 7.370e-03 | ms/batch 761.0 | tok/s   64591 | loss  3.44 | ppl     31.20
| epoch   8 step    15190 | batches    483 / 2101 | lr 7.367e-03 | ms/batch 762.3 | tok/s   64483 | loss  3.46 | ppl     31.93
| epoch   8 step    15200 | batches    493 / 2101 | lr 7.363e-03 | ms/batch 760.5 | tok/s   64636 | loss  3.48 | ppl     32.57
| epoch   8 step    15210 | batches    503 / 2101 | lr 7.360e-03 | ms/batch 760.2 | tok/s   64658 | loss  3.47 | ppl     32.06
| epoch   8 step    15220 | batches    513 / 2101 | lr 7.357e-03 | ms/batch 761.0 | tok/s   64587 | loss  3.44 | ppl     31.06
| epoch   8 step    15230 | batches    523 / 2101 | lr 7.353e-03 | ms/batch 760.3 | tok/s   64646 | loss  3.48 | ppl     32.40
| epoch   8 step    15240 | batches    533 / 2101 | lr 7.350e-03 | ms/batch 761.8 | tok/s   64521 | loss  3.51 | ppl     33.37
| epoch   8 step    15250 | batches    543 / 2101 | lr 7.347e-03 | ms/batch 761.8 | tok/s   64518 | loss  3.47 | ppl     32.15
| epoch   8 step    15260 | batches    553 / 2101 | lr 7.344e-03 | ms/batch 761.9 | tok/s   64509 | loss  3.50 | ppl     33.25
| epoch   8 step    15270 | batches    563 / 2101 | lr 7.340e-03 | ms/batch 761.9 | tok/s   64515 | loss  3.50 | ppl     33.16
| epoch   8 step    15280 | batches    573 / 2101 | lr 7.337e-03 | ms/batch 762.2 | tok/s   64485 | loss  3.50 | ppl     32.99
| epoch   8 step    15290 | batches    583 / 2101 | lr 7.334e-03 | ms/batch 762.0 | tok/s   64502 | loss  3.48 | ppl     32.51
| epoch   8 step    15300 | batches    593 / 2101 | lr 7.330e-03 | ms/batch 762.3 | tok/s   64476 | loss  3.50 | ppl     32.97
| epoch   8 step    15310 | batches    603 / 2101 | lr 7.327e-03 | ms/batch 761.5 | tok/s   64543 | loss  3.52 | ppl     33.68
| epoch   8 step    15320 | batches    613 / 2101 | lr 7.324e-03 | ms/batch 761.5 | tok/s   64547 | loss  3.51 | ppl     33.41
| epoch   8 step    15330 | batches    623 / 2101 | lr 7.320e-03 | ms/batch 760.1 | tok/s   64664 | loss  3.48 | ppl     32.57
| epoch   8 step    15340 | batches    633 / 2101 | lr 7.317e-03 | ms/batch 760.8 | tok/s   64608 | loss  3.51 | ppl     33.41
| epoch   8 step    15350 | batches    643 / 2101 | lr 7.314e-03 | ms/batch 761.1 | tok/s   64582 | loss  3.48 | ppl     32.34
| epoch   8 step    15360 | batches    653 / 2101 | lr 7.310e-03 | ms/batch 761.0 | tok/s   64591 | loss  3.47 | ppl     32.12
| epoch   8 step    15370 | batches    663 / 2101 | lr 7.307e-03 | ms/batch 761.1 | tok/s   64581 | loss  3.45 | ppl     31.63
| epoch   8 step    15380 | batches    673 / 2101 | lr 7.304e-03 | ms/batch 761.0 | tok/s   64593 | loss  3.47 | ppl     32.04
| epoch   8 step    15390 | batches    683 / 2101 | lr 7.300e-03 | ms/batch 761.3 | tok/s   64563 | loss  3.52 | ppl     33.76
| epoch   8 step    15400 | batches    693 / 2101 | lr 7.297e-03 | ms/batch 761.4 | tok/s   64554 | loss  3.50 | ppl     33.26
| epoch   8 step    15410 | batches    703 / 2101 | lr 7.294e-03 | ms/batch 760.6 | tok/s   64620 | loss  3.47 | ppl     32.28
| epoch   8 step    15420 | batches    713 / 2101 | lr 7.290e-03 | ms/batch 760.6 | tok/s   64622 | loss  3.49 | ppl     32.88
| epoch   8 step    15430 | batches    723 / 2101 | lr 7.287e-03 | ms/batch 761.9 | tok/s   64514 | loss  3.49 | ppl     32.65
| epoch   8 step    15440 | batches    733 / 2101 | lr 7.284e-03 | ms/batch 760.6 | tok/s   64619 | loss  3.47 | ppl     32.19
| epoch   8 step    15450 | batches    743 / 2101 | lr 7.281e-03 | ms/batch 761.7 | tok/s   64528 | loss  3.51 | ppl     33.46
| epoch   8 step    15460 | batches    753 / 2101 | lr 7.277e-03 | ms/batch 760.8 | tok/s   64606 | loss  3.50 | ppl     33.15
| epoch   8 step    15470 | batches    763 / 2101 | lr 7.274e-03 | ms/batch 761.4 | tok/s   64554 | loss  3.53 | ppl     34.02
| epoch   8 step    15480 | batches    773 / 2101 | lr 7.271e-03 | ms/batch 761.6 | tok/s   64538 | loss  3.46 | ppl     31.85
| epoch   8 step    15490 | batches    783 / 2101 | lr 7.267e-03 | ms/batch 760.4 | tok/s   64639 | loss  3.41 | ppl     30.14
| epoch   8 step    15500 | batches    793 / 2101 | lr 7.264e-03 | ms/batch 760.4 | tok/s   64642 | loss  3.46 | ppl     31.92
----------------------------------------------------------------------------------------------------
| Eval  31 at step    15500 | time:  1.24s | valid loss  3.37 | valid ppl    28.934
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/DP32_666/checkpoint_last.pt
Saving checkpoint to TF32/DP32_666/checkpoint_best.pt
| epoch   8 step    15510 | batches    803 / 2101 | lr 7.261e-03 | ms/batch 761.8 | tok/s   64524 | loss  3.45 | ppl     31.40
| epoch   8 step    15520 | batches    813 / 2101 | lr 7.257e-03 | ms/batch 761.4 | tok/s   64556 | loss  3.45 | ppl     31.60
| epoch   8 step    15530 | batches    823 / 2101 | lr 7.254e-03 | ms/batch 760.8 | tok/s   64608 | loss  3.48 | ppl     32.36
| epoch   8 step    15540 | batches    833 / 2101 | lr 7.251e-03 | ms/batch 762.6 | tok/s   64458 | loss  3.48 | ppl     32.60
| epoch   8 step    15550 | batches    843 / 2101 | lr 7.247e-03 | ms/batch 761.7 | tok/s   64532 | loss  3.49 | ppl     32.70
| epoch   8 step    15560 | batches    853 / 2101 | lr 7.244e-03 | ms/batch 760.2 | tok/s   64660 | loss  3.47 | ppl     32.23
| epoch   8 step    15570 | batches    863 / 2101 | lr 7.240e-03 | ms/batch 761.9 | tok/s   64510 | loss  3.49 | ppl     32.65
| epoch   8 step    15580 | batches    873 / 2101 | lr 7.237e-03 | ms/batch 761.5 | tok/s   64544 | loss  3.51 | ppl     33.43
| epoch   8 step    15590 | batches    883 / 2101 | lr 7.234e-03 | ms/batch 761.6 | tok/s   64536 | loss  3.53 | ppl     34.08
| epoch   8 step    15600 | batches    893 / 2101 | lr 7.230e-03 | ms/batch 761.4 | tok/s   64554 | loss  3.45 | ppl     31.64
| epoch   8 step    15610 | batches    903 / 2101 | lr 7.227e-03 | ms/batch 761.4 | tok/s   64554 | loss  3.45 | ppl     31.48
| epoch   8 step    15620 | batches    913 / 2101 | lr 7.224e-03 | ms/batch 761.4 | tok/s   64558 | loss  3.46 | ppl     31.92
| epoch   8 step    15630 | batches    923 / 2101 | lr 7.220e-03 | ms/batch 761.3 | tok/s   64563 | loss  3.48 | ppl     32.61
| epoch   8 step    15640 | batches    933 / 2101 | lr 7.217e-03 | ms/batch 761.7 | tok/s   64528 | loss  3.51 | ppl     33.46
| epoch   8 step    15650 | batches    943 / 2101 | lr 7.214e-03 | ms/batch 761.5 | tok/s   64546 | loss  3.48 | ppl     32.39
| epoch   8 step    15660 | batches    953 / 2101 | lr 7.210e-03 | ms/batch 761.5 | tok/s   64550 | loss  3.49 | ppl     32.63
| epoch   8 step    15670 | batches    963 / 2101 | lr 7.207e-03 | ms/batch 760.8 | tok/s   64605 | loss  3.47 | ppl     32.09
| epoch   8 step    15680 | batches    973 / 2101 | lr 7.204e-03 | ms/batch 761.7 | tok/s   64532 | loss  3.48 | ppl     32.51
| epoch   8 step    15690 | batches    983 / 2101 | lr 7.200e-03 | ms/batch 762.4 | tok/s   64474 | loss  3.50 | ppl     33.26
| epoch   8 step    15700 | batches    993 / 2101 | lr 7.197e-03 | ms/batch 762.0 | tok/s   64505 | loss  3.53 | ppl     34.16
| epoch   8 step    15710 | batches   1003 / 2101 | lr 7.194e-03 | ms/batch 760.7 | tok/s   64616 | loss  3.52 | ppl     33.79
| epoch   8 step    15720 | batches   1013 / 2101 | lr 7.190e-03 | ms/batch 760.4 | tok/s   64641 | loss  3.49 | ppl     32.70
| epoch   8 step    15730 | batches   1023 / 2101 | lr 7.187e-03 | ms/batch 761.1 | tok/s   64577 | loss  3.49 | ppl     32.67
| epoch   8 step    15740 | batches   1033 / 2101 | lr 7.183e-03 | ms/batch 761.6 | tok/s   64534 | loss  3.49 | ppl     32.65
| epoch   8 step    15750 | batches   1043 / 2101 | lr 7.180e-03 | ms/batch 760.8 | tok/s   64606 | loss  3.46 | ppl     31.82
| epoch   8 step    15760 | batches   1053 / 2101 | lr 7.177e-03 | ms/batch 761.2 | tok/s   64572 | loss  3.47 | ppl     32.24
| epoch   8 step    15770 | batches   1063 / 2101 | lr 7.173e-03 | ms/batch 761.5 | tok/s   64550 | loss  3.50 | ppl     33.02
| epoch   8 step    15780 | batches   1073 / 2101 | lr 7.170e-03 | ms/batch 761.8 | tok/s   64519 | loss  3.48 | ppl     32.43
| epoch   8 step    15790 | batches   1083 / 2101 | lr 7.167e-03 | ms/batch 761.5 | tok/s   64548 | loss  3.49 | ppl     32.67
| epoch   8 step    15800 | batches   1093 / 2101 | lr 7.163e-03 | ms/batch 761.2 | tok/s   64574 | loss  3.48 | ppl     32.54
| epoch   8 step    15810 | batches   1103 / 2101 | lr 7.160e-03 | ms/batch 761.6 | tok/s   64540 | loss  3.47 | ppl     32.23
| epoch   8 step    15820 | batches   1113 / 2101 | lr 7.157e-03 | ms/batch 761.2 | tok/s   64571 | loss  3.47 | ppl     32.04
| epoch   8 step    15830 | batches   1123 / 2101 | lr 7.153e-03 | ms/batch 762.0 | tok/s   64503 | loss  3.50 | ppl     33.07
| epoch   8 step    15840 | batches   1133 / 2101 | lr 7.150e-03 | ms/batch 761.2 | tok/s   64568 | loss  3.51 | ppl     33.46
| epoch   8 step    15850 | batches   1143 / 2101 | lr 7.146e-03 | ms/batch 761.2 | tok/s   64575 | loss  3.50 | ppl     33.24
| epoch   8 step    15860 | batches   1153 / 2101 | lr 7.143e-03 | ms/batch 760.2 | tok/s   64654 | loss  3.45 | ppl     31.62
| epoch   8 step    15870 | batches   1163 / 2101 | lr 7.140e-03 | ms/batch 762.4 | tok/s   64467 | loss  3.49 | ppl     32.85
| epoch   8 step    15880 | batches   1173 / 2101 | lr 7.136e-03 | ms/batch 761.3 | tok/s   64560 | loss  3.46 | ppl     31.94
| epoch   8 step    15890 | batches   1183 / 2101 | lr 7.133e-03 | ms/batch 761.4 | tok/s   64551 | loss  3.45 | ppl     31.52
| epoch   8 step    15900 | batches   1193 / 2101 | lr 7.130e-03 | ms/batch 760.9 | tok/s   64596 | loss  3.48 | ppl     32.58
| epoch   8 step    15910 | batches   1203 / 2101 | lr 7.126e-03 | ms/batch 760.6 | tok/s   64619 | loss  3.50 | ppl     32.99
| epoch   8 step    15920 | batches   1213 / 2101 | lr 7.123e-03 | ms/batch 760.1 | tok/s   64662 | loss  3.47 | ppl     32.16
| epoch   8 step    15930 | batches   1223 / 2101 | lr 7.119e-03 | ms/batch 759.8 | tok/s   64687 | loss  3.47 | ppl     32.14
| epoch   8 step    15940 | batches   1233 / 2101 | lr 7.116e-03 | ms/batch 760.5 | tok/s   64634 | loss  3.45 | ppl     31.52
| epoch   8 step    15950 | batches   1243 / 2101 | lr 7.113e-03 | ms/batch 760.2 | tok/s   64655 | loss  3.46 | ppl     31.85
| epoch   8 step    15960 | batches   1253 / 2101 | lr 7.109e-03 | ms/batch 761.3 | tok/s   64567 | loss  3.46 | ppl     31.68
| epoch   8 step    15970 | batches   1263 / 2101 | lr 7.106e-03 | ms/batch 762.4 | tok/s   64468 | loss  3.51 | ppl     33.59
| epoch   8 step    15980 | batches   1273 / 2101 | lr 7.102e-03 | ms/batch 762.3 | tok/s   64482 | loss  3.53 | ppl     34.06
| epoch   8 step    15990 | batches   1283 / 2101 | lr 7.099e-03 | ms/batch 761.1 | tok/s   64581 | loss  3.51 | ppl     33.53
| epoch   8 step    16000 | batches   1293 / 2101 | lr 7.096e-03 | ms/batch 763.1 | tok/s   64409 | loss  3.50 | ppl     33.04
----------------------------------------------------------------------------------------------------
| Eval  32 at step    16000 | time:  1.24s | valid loss  3.36 | valid ppl    28.808
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/DP32_666/checkpoint_last.pt
Saving checkpoint to TF32/DP32_666/checkpoint_best.pt
